<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/siPKHLclqJZRVNkFYhP6Gg)

描述
--

        此脚本提供了 CVE-2024-21413 的概念验证 (PoC)，CVE-2024-21413 是 Microsoft Outlook 中发现的一个重大安全漏洞，CVSS 为 9.8。该漏洞被称为 #MonikerLink 错误，具有深远的影响，包括本地 NTLM 信息的潜在泄漏和远程代码执行的可能性。此外，它还强调了可以绕过 Office Protected View 的攻击媒介，从而将其威胁扩展到其他 Office 应用程序。

负责任地使用此工具并确保您获得目标系统所有者的授权。该脚本需要 SMTP 身份验证才能发送电子邮件，绕过 SPF、DKIM 和 DMARC 检查，这有助于更有效地模拟真实的攻击场景。

```
python CVE-2024-21413.py --server "<SMTP server>" --port <SMTP port> --username "<SMTP username>" --password "<SMTP password>" --sender "<sender email>" --recipient "<recipient email>" --url "<link URL>" --subject "<email subject>"

```

参数：

*   `--server`：SMTP 服务器主机名或 IP。
    
*   `--port`：SMTP 服务器端口。
    
*   `--username`：用于验证的 SMTP 服务器用户名。
    
*   `--password`：用于验证的 SMTP 服务器密码。
    
*   `--sender`：发件人电子邮件地址。
    
*   `--recipient`：收件人电子邮件地址。
    
*   `--url`：包含在电子邮件中的恶意路径。
    
*   `--subject`：电子邮件主题。
    

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0reXZJJ2COGibQHws6JyqEolppwPCTvNEC3plzJnVP5QMxJqpm3tqxlJWICAbibuw71qGAWCiach8kA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0reXZJJ2COGibQHws6JyqEoqGmEGsjvFsjVo3VCLUoSAqEDKiaFg1F3iaiayyXUNjpjIetL86wiaXXqkA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0reXZJJ2COGibQHws6JyqEoZdVOvtSIwnmCS0RKsib8ibbQDOKArIAODY1q3pTHFeFWSwvt4bpmqt7w/640?wx_fmt=png&from=appmsg)

        SMTP 身份验证对于本演示至关重要，可确保发送的电子邮件绕过常见的电子邮件验证检查，例如 SPF（发件人策略框架）、DKIM（域名密钥识别邮件）和 DMARC（基于域的消息身份验证、报告和一致性）。这些安全措施旨在检测和防止电子邮件欺骗，即攻击者从伪造的地址发送电子邮件。通过使用经过身份验证的 SMTP，该演示密切模仿了老练的攻击者如何规避这些保护，使测试环境更加真实，并强调了全面电子邮件安全实践的重要性。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0reXZJJ2COGibQHws6JyqEo5RVEPGarCias4mSFribHuzIIGpjQHfYCIE7tKibibw5gU7w66gSKdmduxQ/640?wx_fmt=png&from=appmsg)

项目地址：

https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability?tab=readme-ov-file