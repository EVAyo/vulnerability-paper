<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/95tv3gmbY93xpJecBQIUpg)

免责声明：
-----

由于传播、利用本公众号所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号及作者不为此承担任何责任，一旦造成后果请自行承担！如有侵权烦请告知，我们会立即删除并致歉。谢谢！

CVE-2024-26229
--------------

> Windows CSC 服务特权提升漏洞

![](https://mmbiz.qpic.cn/mmbiz_png/1mtwZURvGTmibTLjF744TjXWOX7MxRSc42ywjQDcBTaclYe4VWzxWNhkbCUYs5JDmsytichXOKw4CqQsxc6V1tibQ/640?wx_fmt=png&from=appmsg)

当程序向缓冲区写入的数据超出其处理能力时，就会发生基于堆的缓冲区溢出，从而导致多余的数据溢出到相邻的内存区域。这种溢出会损坏内存，并可能使攻击者能够执行任意代码或未经授权访问系统。本质上，攻击者可以编写触发溢出的恶意代码或输入，从而控制受影响的系统、执行任意命令、安装恶意软件或访问敏感数据。

![](https://mmbiz.qpic.cn/mmbiz_png/1mtwZURvGTmibTLjF744TjXWOX7MxRSc4LG2tT6B8gQJXyEiaTo9jI5wAScvGZWIaJxsa7iauJicPrlzHybBqNeuyA/640?wx_fmt=png&from=appmsg)![](https://mmbiz.qpic.cn/mmbiz_png/1mtwZURvGTmibTLjF744TjXWOX7MxRSc4TEovMTBgNO6CHrxvL2yYxyhxCODSDPQmSJsRxibrf34MIanwuib6v6MA/640?wx_fmt=png&from=appmsg)

### 漏洞成因

（CVE-2024-26229）Windows CSC 服务特权提升漏洞，csc.sys 驱动程序中带有 METHOD_NEITHER I/O 控制代码的 IOCTL 地址验证不正确。当 IOCTL 使用 METHOD_NEITHER 选项进行 I/O 控制时，IOCTL 有责任验证提供给它的地址，如果验证缺失或不正确，攻击者可以提供任意内存地址，从而导致代码执行或拒绝服务。

#### 成功利用此漏洞的攻击者可以获得哪些权限？

成功利用此漏洞的攻击者可以获得 SYSTEM 权限。

### 漏洞复现

利用条件：这个提权漏洞需要目标主机启用 csc 服务，可以使用 sc qc csc 命令查询，START_TYPE 为 DISABLED 禁用、SYSTEM_START 启用。

Tips：2008/2012 没有这服务（无法利用），2016/2019/2022 有该服务，但是默认都禁用了，而且没法启动。实战项目测试中如果遇到 Win 10/11 时可以试试用这个 exp 来提权，而且大概率能绕过一些防护的拦截。

```
复现原文链接：
https://blog.csdn.net/weixin_46944519/article/details/139745124



```

### BOF 实现

针对 Cobalt Strike 和 BruteRatel 的 CVE-2024-26229 的信标对象文件 （BOF） 实现。

BOF 工具利用起来更简单更好（内存执行，无需落地），使用 inline-execute 执行 BOF 文件即可将当前 Beacon 提升为 SYSTEM。

**备注：**Beacon Object File (BOF) 即 BOF 是一种用于传递恶意软件行为的可执行代码的文件格式。它通常包含有特定功能的代码，比如用于绕过某些安全措施、植入后门或者执行其他恶意操作。BOF 可以被集成到像 Cobalt Strike 这样的渗透测试工具中，帮助安全专家模拟真实攻击，以评估和测试系统的安全性。

#### 编译方式：

```
gcc -c CVE-2024-26229-bof.c -o CVE-2024-26229-bof.o


```

![](https://mmbiz.qpic.cn/mmbiz_png/1mtwZURvGTmibTLjF744TjXWOX7MxRSc4ewyxNm4kAiba8iaO5Zib852aicCPnbYP9xYTJU4xABB8R863UO4xnRxrDQ/640?wx_fmt=png&from=appmsg)![](https://mmbiz.qpic.cn/mmbiz_png/1mtwZURvGTmibTLjF744TjXWOX7MxRSc4s4ibpdxibYpDusRZIjlMNyZzmbaaoks1rJLJMDLJqKLACT3ocZaeGzww/640?wx_fmt=png&from=appmsg)

### 受影响系统

```
Windows Server 2022, 23H2 Edition (Server Core installation)
Windows Server 2012 R2
Windows Server 2012 (Server Core installation)
Windows Server 2012
Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2016 (Server Core installation)
Windows Server 2016
Windows 10 Version 1607 for x64-based Systems
Windows 10 Version 1607 for 32-bit Systems
Windows 10 for x64-based Systems
Windows 10 for 32-bit Systems
Windows 11 Version 23H2 for x64-based Systems
Windows 11 Version 23H2 for ARM64-based Systems
Windows 10 Version 22H2 for 32-bit Systems
Windows 10 Version 22H2 for ARM64-based Systems
Windows 10 Version 22H2 for x64-based Systems
Windows 11 Version 22H2 for x64-based Systems
Windows 11 Version 22H2 for ARM64-based Systems
Windows 10 Version 21H2 for x64-based Systems
Windows 10 Version 21H2 for ARM64-based Systems
Windows 10 Version 21H2 for 32-bit Systems
Windows 11 version 21H2 for ARM64-based Systems
Windows 11 version 21H2 for x64-based Systems
Windows Server 2012 R2 (Server Core installation)
Windows Server 2022 (Server Core installation)
Windows Server 2022
Windows Server 2019 (Server Core installation)
Windows Server 2019
Windows 10 Version 1809 for ARM64-based Systems
Windows 10 Version 1809 for x64-based Systems
Windows 10 Version 1809 for 32-bit Systems


```

### 漏洞修复

该漏洞于 2024 年 4 月 9 日修复，详情请参阅

```
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-26229


```

  

---

Tips: 

  

项目地址：

```
https://github.com/NVISOsecurity/CVE-2024-26229-BOF

```

HVV 招聘：投递到 -->

```
https://send2me.cn/s4blZRtp/RSm7tIGEY-eiTg

```

考证咨询：全网最低最优惠报考`NISP/CISP/CISSP/PTE/PTS/IRE/IRS`等证书，后台回复 “好友” 加 V 私聊。

往期推荐

[

记渗透某 cms 到代码审计拿权限



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247500369&idx=1&sn=3e2d9fba710d06e1550755a4e8cbea18&chksm=c0c863a5f7bfeab3fb0f7dabcfbe5be6c76fe16ee76f485628b2701ea8f6e149a59f1e5016a5&scene=21#wechat_redirect)

[

实战｜对一个随身 WIFI 设备的漏洞挖掘



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247500351&idx=1&sn=595b68a89697cc5f32af381a57aefc49&chksm=c0c863cbf7bfeadd7537f52fd90d1685533a5503fbb276fd5eb412bd20744fe172c4d9c4c1bb&scene=21#wechat_redirect)

[

速看、紧急、震惊…… 谁在制造网安圈 “标题党” 文章？——网安从业者和 "紧急, 震惊" 的关系



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247500361&idx=1&sn=06ad9d55637c2bf187a62a4ba6413e99&chksm=c0c863bdf7bfeaabff0412662cdada65227b908e54f6fa504f93aa2df1dff7df122199034c32&scene=21#wechat_redirect)

[

一个安服仔的自白——我还会留下来吗？



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247500340&idx=1&sn=82a2640f2372699a469ed12e17bd8c5a&chksm=c0c863c0f7bfead6f6ae1081637b7ce097c0f0e61b76e5f201f83a8fedd2af1264a18f38b1d9&scene=21#wechat_redirect)

[

【2024HW 招聘】最快当天面试，冲啊



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247500340&idx=2&sn=5062138a0f4c098ca6d3fe105b419700&chksm=c0c863c0f7bfead680dd577c45830e22161a742d50f1fc1855dc314660ced4788008ba5ff4ff&scene=21#wechat_redirect)

[

记一次梦游渗透从 jmx 到 rce



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499984&idx=1&sn=00c302e1dccd5ce488d02d5c543dc6b1&chksm=c0c86124f7bfe8323351025e4e53410b411633b9d9abce30a1b8b4c54277eb86a017ca9010a5&scene=21#wechat_redirect)

[

记某高校渗透测试 24-0506



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499949&idx=1&sn=0594a76a0d617ba4d759d00745fa9e82&chksm=c0c86159f7bfe84f26321989ebb8df832038a71acb0c296dbad4deb477d0a210953ee7e84e26&scene=21#wechat_redirect)

[

一键解密，网络安全神器现已问世！



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499937&idx=1&sn=0d3e8470745296f9662b20db1ae34ff5&chksm=c0c86155f7bfe843570e757b5e9e155af24cffc9e4b4200f1133990a82c1379ae3ecf4b031a1&scene=21#wechat_redirect)

[

一个 IP Getshell 续篇



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499918&idx=1&sn=5de7c447aaf6dc1a77988c2998e01de5&chksm=c0c8617af7bfe86c11ce2549f7b1bf851a09d61399d95392ea29d185154d86907b2b47bbc84d&scene=21#wechat_redirect)

[

实战 | 记一次女朋友学校漏洞挖掘



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499797&idx=1&sn=1d29cb3af3354861ebca4938c4655d46&chksm=c0c861e1f7bfe8f7a9dd4d13554174b2cf683d4cf8238a3d144695425ce5f223e822e070bab2&scene=21#wechat_redirect)

[

记一次对某学校 APP 渗透



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499788&idx=1&sn=32e40ad903289e36a826f43bbcbf0f44&chksm=c0c861f8f7bfe8eef5cc64f1072affe50f144f9fc199a1bcc604fd5570d89af03005f08c8631&scene=21#wechat_redirect)

[

红蓝对抗快速搭建基础设施平台



](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499479&idx=1&sn=49ec494a4d031faab8bab164412c2cab&chksm=c0c85f23f7bfd6350db52c2128231a46ebaf65db80749d38f3749d3afc31d6d4287f7bb2feb5&scene=21#wechat_redirect)

[【工具更新】最强渗透集成环境 V 5.0](https://mp.weixin.qq.com/s?__biz=MzkwODM3NjIxOQ==&mid=2247499447&idx=1&sn=f21e9aeea886f9cb4d7310f878ecb5c6&chksm=c0c85f43f7bfd65543de11232050790765df79a6c980ca786ba8adbdc64a1b66a9fe2bacb1cb&scene=21#wechat_redirect)