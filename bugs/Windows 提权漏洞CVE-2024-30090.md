<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/qbqlOeruKJLcYByP49SSCw)

随便搜下我的历史文章记录，大量 windows 提权漏洞。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/KgxDGkACWnT3kXa7VX7IXC84JIV2tTOciaPNFytsl11icmgAP29PQdmYVw9PfhNSNzUyIoAXDgibUlxaBKNXksZXQ/640?wx_fmt=png&from=appmsg)

DEVCORE 的安全研究员 Angelboy ( @scwuaptx ) 发现了 Microsoft 内核流服务中的一个权限提升漏洞。该漏洞的编号为 CVE-2024-30090，CVSS 评分为 7.0，可让攻击者在易受攻击的 Windows 系统上获得 SYSTEM 权限。

Kernel Streaming 是 Windows 用来高效处理来自各种设备（如网络摄像头、麦克风和其他音频设备）的数据流的框架。“在 Windows 系统上，当我们打开网络摄像头、启用声音并激活麦克风等音频设备时，系统需要将相关数据（如您的声音和从您的设备捕获的图像）写入或读取到 RAM 中，”Angelboy 解释道。“在此过程中，更高效地将数据读入计算机至关重要。微软提供了一个名为 Kernel Streaming 的框架来处理这些数据，它主要在内核模式下运行。”

该漏洞源于竞争条件，可利用该条件操纵 Kernel Streaming 服务中的特权检查。“成功利用此漏洞的攻击者可获得 SYSTEM 特权，” 微软在其安全公告中证实。“成功利用此漏洞需要攻击者赢得竞争条件。”

具体来说，当 nt!SeDebugPrivilege 发生更改时，漏洞就会出现，非管理员用户因此能够获得高权限进程的 PROCESS_ALL_ACCESS 权限。此攻击媒介本质上绕过了 SeDebugPrivilege 的需要，而 SeDebugPrivilege 通常需要管理员控制。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/KgxDGkACWnT3kXa7VX7IXC84JIV2tTOcibr19Ou8Y07ciciaLDGJxE5kdV7LCXKlW9rfyclPfghhK5tjJwGPhjhbw/640?wx_fmt=other&from=appmsg)

该漏洞利用了 Windows 检查进程权限的方式。通常，拥有 SeChangeNotifyPrivilege（一种常见权限）的用户只能获得有限的系统资源访问权限。然而，通过利用此漏洞，攻击者可以欺骗系统，使其相信自己拥有 SeDebugPrivilege，从而获得更高级别的访问权限。

Angelboy 的分析深入探讨了该漏洞的技术细节，解释了攻击者如何利用竞争条件来修改特定的权限值并最终获得未经授权的访问。

继 Angelboy 的分析之后，安全研究员 Dor00tkit 在 GitHub 上发布了针对 CVE-2024-30090 的概念验证 (PoC) 漏洞利用代码。该 PoC 演示了攻击者如何在 Windows 11 23H2 系统上可靠地利用此漏洞，利用代理到内核的技术来实现权限提升。

**幸运的是，微软在 2024 年 6 月补丁星期二更新中修补了此漏洞。强烈建议用户立即应用此更新，因为未修补的系统可能会受到利用此漏洞的潜在攻击。**

> https://github.com/Dor00tkit/CVE-2024-30090

https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/

https://devco.re/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2-en/

https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30090