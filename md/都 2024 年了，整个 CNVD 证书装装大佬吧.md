<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/sJTUGMe7xucpUW2EM9jfQQ)

_**免责声明：**_

_本公众号致力于安全研究和红队攻防技术分享等内容，本文中所有涉及的内容均不针对任何厂商或个人，同时由于传播、利用本公众号所发布的技术或工具造成的任何直接或者间接的后果及损失，均由使用者本人承担。请遵守中华人民共和国相关法律法规，切勿利用本公众号发布的技术或工具从事违法犯罪活动。最后，文中提及的图文若无意间导致了侵权问题，请在公众号后台私信联系作者，进行删除操作。_

**0x01 CNVD 证书获取条件**

经常有刚入圈子的小白问 CNVD 证书怎么拿，那么就随意开个扫盲帖好了。

首先 CNVD 证书的发放条件，这个在官网都有可以自己去看。我下面截取部分主要的。

_（1）对于中危及中危以上通用型漏洞（CVSS2.0 基准评分超过 4.0 分）（除小厂商的产品、非重要 APP、黑盒测试案例不满 10 起等不颁发证书）（注：大厂商的判断标准为（注册资金 5000 万以上，或者案例涉及省部级以上单位的））_

_（2）涉及电信行业单位（中国移动、中国联通、中国电信及中国铁塔公司）和中央部委级别 (不含直属事业单位) 的高危事件型漏洞，CNVD 将给予原创漏洞证明（即 CNVD 漏洞证书，电子版），该证明可通过编号在 CNVD 官方网站进行查询跟踪。时限要求：按周对上一周归档漏洞且满足证书颁发条件的进行批量制作。（每周三或周四颁发证书）_

**0x02 寻找目标**

那么问题来了，常年 SRC 低危及忽略选手，让我去挖高大上的 gov、org？还是算了吧，看看能不能捡什么漏，经常看到其他师傅们能捡到弱口令之类的，我真怀疑他们就是这个厂商的开发，要不然这种弱口令哪轮得到他们来找。老实点，先从安全之友爱企查开始好了。  

1、首先，根据 CNVD 证书的颁发要求，我们最基本的肯定要找 5000w 注册资金的企业。

2、资本类型最好选 rmb，外国企业做的软件国内用的肯定比较少

3、关键词可以搜索，“计算机”、“软件” 等跟开发有关的关键词这样更容易命中

4、参保人数个人觉得想要卖的多的软件，低于 100 人的企业基本没这个水平，所以选人多点的吧。

5、有的时候搜出来的企业过多，导致达到爱企查导出上限，那么就细分一些行业和地区，减少搜索结果，分批导出。

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybH2bUyz1556SmTmfDIlhx4QiaItjQDZ9BneAbIqYYFj0QwdJxeiajh0lMQxCsYP4pGrLSbOicwFQMwAQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybH2bUyz1556SmTmfDIlhx4QCicEpwBWPxmdCctjVQUwxaM1IuDyd0b49H2TejbBMG6XazNxUO1Rbaw/640?wx_fmt=png&from=appmsg)

有了企业接下来要去找互联网上部署的系统，自然要用到 FOFA 来查询，本着能白嫖就不自己动手的原则，github 上随便搜了一下有很多项目，代码也都大差不差，拿来下改一改。把公司放到文件列表中。

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybH2bUyz1556SmTmfDIlhx4QL01ib4dqAIbuWVzAE0smzU1wOlOCiay3qdcBXApHeibSUERJic90jShJqA/640?wx_fmt=png&from=appmsg)

修改的代码主要是两个地方

1、在通过 fofa 爬取公司软件的时候，需要注意爬出的系统至少要满足 10 个系统以上，因为即使有漏洞，如果不达到 10 个案例，按照 CNVD 的规则也是没有证书的。  

2、fofa 爬取的很多系统存在脏数据，例如菠菜之类的站点，需要将这部分脏数据去除。  

最终爬出来的结果如下  

格式以网站 title + 公司名 + 例子站点 URL 组成

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybH2bUyz1556SmTmfDIlhx4QKzRdol1jrHicSjFByXWqsicCponwibrY7kibswArmlib1GgOzQhokCygC7Q/640?wx_fmt=png&from=appmsg)

接下里就看个人的测试能力了，能不能找到一些中危或以上级别的漏洞了，不过我比较懒，先找找有没有通用 RCE 漏洞，例如 Log4j、Fastjson 等。直接搬出我的 Axe 破轮子被动代理扫一遍，运气比较好，扫到过几次。

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybH2bUyz1556SmTmfDIlhx4Q4Rs8yWj3nIiaXOiaHGnhP4mAcdTZe3aY8xr5iaJ2xRoBswJe4dicEKfvtg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybH2bUyz1556SmTmfDIlhx4Qc5520bCj6cZD9u5A1zqR1eVpapPAtpic23urib6LH7od3VuByCp99w9w/640?wx_fmt=png&from=appmsg)

还有一种就是通过 fofa、hunter 之类的测绘平台纯碰运气了

因为很多通用软件 title 都喜欢使用 “管理平台”、“管理系统” 等作为 title，而且有些系统因为要声明软件著作权，大多会在主页出现 “版权所有” 的字样，基于上述的总结，下面是我之前比较喜欢用的查询组合，给师傅们参考。

```
(title="管理系统" || title="管理平台") && body="版权所有" && title!="路由" && title!="YApi" && title!="防火墙" && title!="安装包" && country="CN" && server!="Microsoft" &&  host!="com" &&  host!="net" &&  host!="cn" && after="2020"

```

**0x03 报告提交**

关于发现漏洞的报告提交，因为我提交的只有通用漏洞，所以只分享一些通用漏洞的提交经验。

1、证明资产是 5000w 以上的资产，最好的方法就是爱企查、天眼查之类的平台截图证明。

2、如果涉及代码审计的最好给个代码链接，或者详细的代码审计过程

3、资产的查找指纹，最好给出来，这样审核也方便确认是不是 10 个以上的系统，例如 title="xxxx"

4、至少有三个互联网复现的案例，这个千万不要偷懒，而且如果复习过程毕竟复杂，建议写详细点，毕竟如果驳回让你重写，那么你要等到重新审核，不知道是猴年马月了。  

5、最后证书真的很慢，1-6 个月都是正常的。  

**0x04 后续**

大佬们都喜欢在最后晒自己的证书，我就不晒了，还要费劲打码，我就晒个消息好了。总的来说只要用心找还是能找到很多漏洞的，我基本只找 RCE，所以每次一个通用系统都至少 2 个证书  

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybH2bUyz1556SmTmfDIlhx4QHsxlFbb0Okcn57dv6AlFoSM3ZAxA0bru5LsL0H2Ksicjvh24A5hwndg/640?wx_fmt=png&from=appmsg)

然后就是挖漏洞注意风险，违法违规的事情不要做，点到为止，毕竟是为国家安全做贡献，不要好事变坏事。

最后文中提到的我改过的 fofa 爬虫脚本，放在圈子了，感兴趣的师傅可以加圈子交流。

**0x05 加入我们**

后台回复 “加群” 或“小助手”，或扫描下方二维码加入我们的付费圈子，一起进步吧

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybHZicZnvXwW5LnL1bzhuJAoQ7MpUsy3BY3Cibl6curYWucSMSpxJicscm7zwWDWQaaiapo57oc6L5YH2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/rz9smmdjybFMdnMAXpcyiaNPdyoLppiaPO7glCdCXn1WctQuslCotWHfH709HdYlkyYRK3BcTTzIE5UCw1vS1LJQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)