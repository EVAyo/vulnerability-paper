<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/NS9c_oPtxFAozsf_byxjHA)

一、新建一个 MFC 应用，填写响应的程序信息，点击创建，选择基于对话框，点击完成  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTMfVCDiak4cq7TghcrCCyicoNNa4IKia8Zs4v4yRtbeMcMXhV6sgnhX3vaQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTM3VZ58Fx3icCgiazpm0JVP0jDbj4L2muWg6CNxP0fA9E2T483ZicoVMgUg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTMKbncj6wzus6T8Cwbea4WicoC9QQBRbkicrN8JoC7nqUOcr9vU5zjIVhg/640?wx_fmt=png&from=appmsg)

二、拖拽几个 button 按钮，修改按钮属性  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTMq3repnqOHYJpE1EBtROabjcuAprxsVqR5c8tOv8I9NbAteWuF0nQ6A/640?wx_fmt=png&from=appmsg)

三、双击窗口控制台按钮，编写代码

```
void CMFC数据测试Dlg::OnBnClickedButton1()
{
  // TODO: 在此添加控件通知处理程序代码
  AllocConsole();
  FILE* file = 0;
  freopen_s(&file, "CONOUT$", "w+t", stdout);
}

```

四、双击数据显示按钮，编写代码  

```
void CMFC数据测试Dlg::OnBnClickedButton2()
{
  printf("欢迎关注公众号：逆向有你\n");
}

```

五、运行结果  

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTMudMcIUa6uRIwj2us8IyO1Yf98pc4VWHibbsibY9Lxxg13ZpmXcYCNy8A/640?wx_fmt=png&from=appmsg)

六、右击源文件添加新建项，读写数据. cpp

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTM5MVZhDnribETfN677bGmv6ibLczUkiclNVLGUnyaHfvqwVsHXhDeSmTEQ/640?wx_fmt=png&from=appmsg)

七、将前面课程的代码复制过来，并修改成要测试游戏的相关数据

```
#include "pch.h"
#include <iostream>
#include <Windows.h>
HANDLE 获取权限句柄()
{
    HWND 窗口句柄 = FindWindowA("QElementClient Window", "Element Client");
    std::cout << "窗口句柄:" << 窗口句柄;
    std::cout << "\n";
    DWORD PID = 0;
    GetWindowThreadProcessId(窗口句柄, &PID);
    std::cout << "PID:" << PID;
    HANDLE 进程权限句柄 = OpenProcess(PROCESS_ALL_ACCESS, FALSE, PID);
    return 进程权限句柄;
}
DWORD 读四字节(DWORD 地址)
{
    HANDLE h = 获取权限句柄();
    DWORD 读取值 = 0;
    ReadProcessMemory(h, (LPCVOID)地址, &读取值, 4, 0);
    if (h) {
        CloseHandle(h);//释放句柄资源
    }
    return 读取值;
}
void 写四字节(DWORD 地址, DWORD 写入值)
{
    HANDLE h = 获取权限句柄();
    WriteProcessMemory(h, (LPVOID)地址, &写入值, 4, 0);
    if (h) {
        CloseHandle(h);//释放句柄资源
    }
}

```

八、添加一下头信息  

```
DWORD 读四字节(DWORD 地址);
void 写四字节(DWORD 地址, DWORD 写入值);

```

九、运行程序，成功读取血量

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTMbOhw8WYjosmOEXhwRBTqpwG2fkEpsaKXZuesolusnTZ7ZAKPfgoBGg/640?wx_fmt=png&from=appmsg)

**欢 迎 关 注**

  

  

欢迎关注公众号：逆向有你

个人微信：ivu123ivu

![](https://mmbiz.qpic.cn/mmbiz_png/WJRHqUiaud0rZsVmVbHLRXx6YzfNlYPTMZ687z4roSTtZia4glzib5lfkm700KUfRiaMoWSFQ40dyFD0RwMHrJhm6Q/640?wx_fmt=png&from=appmsg)