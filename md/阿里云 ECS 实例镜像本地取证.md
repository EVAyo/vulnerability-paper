<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/RRj45QA0QVSVB2j2xNUXwQ)

✎ 阅读须知

  

乌鸦安全的技术文章仅供参考，此文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。

乌鸦安全拥有对此文章的修改、删除和解释权限，如转载或传播此文章，需保证文章的完整性，未经允许，禁止转载！

本文所提供的工具仅用于学习，禁止用于其他，请在 24 小时内删除工具文件！！！

更新时间：2024 年 03 月 21 日 10:09:37

1. 说明
=====

很多情况下，我们需要对服务器进行应急取证，但是很多服务器是直接搭建在云上的，比如我们在拿到`OSSKey`之后（技术方法、其它方法等），可以将待取证服务器镜像导出，在本地进行取证分析。

本次是将阿里云的 ECS 进行快照打包之后，导出到本地，使用`Vmware`打开，进行镜像还原取证分析。

2. 环境准备
=======

### 2.1 阿里云环境准备

需要阿里云账号，能够导出镜像，并且能够通过`OSS`下载。

### 2.2 本地环境准备

`mac`：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUIyr9q8TC1uibTN6V74IyBXUb8SWeJHcnM0w75e90FKcyt6WwLwxG5eA/640?wx_fmt=png&from=appmsg)image.png

`VMware Fusion 13.0.2`：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUAOf3tLgrPD5awPnwWzWW9FC9m6ovbJTJtEZkxNR6oHZBKu33m3s7eQ/640?wx_fmt=png&from=appmsg)image.png

`Windows：``VMware：`

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUhVDoK68Sjuvic0ibCiciaebY8ic50FdBJQXrqHeicLyUGq53lujaqGMfNV4g/640?wx_fmt=png&from=appmsg)

`Windows 11`：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUwibfwO36LticJBicoyVCNw7ibcYzZ3mDp7VwEm5X3L8WrHIib9zZNGKZYpg/640?wx_fmt=png&from=appmsg)image.png

3. 阿里云 ECS 镜像导出
===============

前提条件：首先是获取账号等成功登录了阿里云，并且能够访问控制台，在控制台里面可以找到对应的实例。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUlu718Ahosc2tUk7A1iapCN8ftCp8j55KN0cVe44EaeuXHibhVPYVvELQ/640?wx_fmt=png&from=appmsg)image.png

当然，在这里我是使用自己的账号进行取证测试的，实际上可能要选择不同的区，多找找有无`ecs`。

### 3.1 创建自定义镜像

在这里点击更多，搜索创建自定义镜像：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUByICDPMoFBWRG4PPqib3Oc8XIY0iaUpvXYM4ibH4DKXxCicwhD1FhibqlwA/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUm0lt0WhzlACHOibXNzSEkT80cleI8gP7RPQTq3md5mZ1EV2W0cYFgAw/640?wx_fmt=png&from=appmsg)image.png

点击确认之后，在镜像栏等待创建成功：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUic63v22VPAHv7K7Q6QibwVKkficSxobfdYQwJmptiaiaic478pQ8Th6Jrbjg/640?wx_fmt=png&from=appmsg)image.png

过一段时间之后，刷新一下界面，如果显示可用，即代表创建成功：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUPxRoJ86ibUkVf6JyUMCYL15ftGy5yGZt767mCzrfmCzjLP2Lc0wObzQ/640?wx_fmt=png&from=appmsg)image.png

### 3.2 镜像导出  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUV7zmCFyQSZIVnhDE3Smib6eRDpnhYO9iaUvNDE7g8xu6AichqnPpjgUWA/640?wx_fmt=png&from=appmsg)image.png

在选择导出镜像的时候，会使用`oss`，`oss`是一项收费的服务（创建自定义镜像也是收费的）：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUbBPocxicXkuNvtQNuc5GnrhhhZVKnxKZoKciaFyIG6dbZrBtXTTGvhog/640?wx_fmt=png&from=appmsg)在这里选择下一步的时候，会提示是否完成以下操作：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUjcBUgCFsdEAWMmkA15CNp7dOsltNicHLPSo7xE8hT9smN9ZPevreichA/640?wx_fmt=png&from=appmsg)image.png

此时看到暂时未授权`ECS`对`OSS`资源的访问权限，直接根据这个提示来打开以下链接：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUKBf8fHw18MKcheFJRycqcFxibeghDFuia3UbbRtrvL91vQNCp31tjAiaA/640?wx_fmt=png&from=appmsg)image.png

点击同意授权即可：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU22OQPPxQtiaPfI5iaTYFffdThc8w7vjYPgjWAWAeAiaDLOKy0tPOPQVaQ/640?wx_fmt=png&from=appmsg)image.png

授权之后，可以看到概览：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUTHMhrwVkkvBFa7jjhrYDFUYA2343Wso67RodpqgoVBkicZ1ibda6Paog/640?wx_fmt=png&from=appmsg)image.png

此时回到刚刚的导出镜像页面，继续下一步：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUxUToQQ9WHicMKZgYyoJ8d7U5II4sXZOrFTjIhYM4SwYA7drfOVh1UZA/640?wx_fmt=png&from=appmsg)image.png

此时导出的时候，会让你选择`OSS Bucket`，但是在这里我们目前暂无`OSS Bucket`地址，所以我们要先行创建一个：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU90yRrf9rrjhdIMRG8DmzEpZCMjMC2YE13PdLkSYDq795pbqetlNlfg/640?wx_fmt=png&from=appmsg)image.png

直接点击如何创建，然后找到登录`OSS`管理控制台：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUctoWOiabw2icYVuGib794KHiaWH6IFWRvux6Npg80GsQic0g21L5FQU9wkA/640?wx_fmt=png&from=appmsg)image.png

点击立即创建：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUobqzzXIiclKPratvkkLgtec6PGSdXU3WjTUQNMaV9hHJRjc9xhkNWkA/640?wx_fmt=png&from=appmsg)image.png

在这里填写`Bucket`的名称，选择地域，其他的随便选择选择吧，请注意在这里我选择的是私有权限，后期下载的话，需要使用公共读的权限，等我后续弄完之后，再修改对应的权限。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUCVFvCRVBdGIPrbHzIKVHniaLf6fiaMgD3H0ks7MmcfLic40xqH0NzMRsg/640?wx_fmt=png&from=appmsg)image.png

最后就是创建成功：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUCKvBVPGCAuKLmplch7nXhPAghRq7djzdPxR0TVialKT6cm0FWY7G7Lw/640?wx_fmt=png&from=appmsg)image.png

回到刚刚的导出镜像界面，刷新页面之后，选择导出镜像：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUF6G887yvL6p4q9GFEoWRdAZ9bP3ypIDYAyH1HEG22WDiaGLQBq76PicQ/640?wx_fmt=png&from=appmsg)image.png

确定导出：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUdTrx7USXu3TYCibicFxKwqlZiapx3XrHGSySB2JD5SOTicGVrIqOiawD8DA/640?wx_fmt=png&from=appmsg)image.png

回到对象存储的界面，找到你的`Bucket`列表，然后找到碎片管理，再点击统计：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU0C6EnlAWdS4mWDK2Nccv4MXlicP22N5es03GGMHLW5pl3PfRcTqpb4g/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUPUZgnTjySyICtCuzyBEZCZNAb8gibGH79EiaJk1cJmxTL8Xqe2viatlDg/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUd9sIcfbex1wbLiaM3WEx7icGJlibc3ZLpEGZIic84lBUBF4Fe2P9QBff1A/640?wx_fmt=png&from=appmsg)image.png

等待一会，这个`40G`的镜像，压缩完之后，大概是`4G`左右，所以多等会。

在这里我也买了一个对象存储的资源包，也不贵，但是不知道能不能用上：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUEnZicDZg6vTNz1lH3w4GZgDBiab9moia8UicWoyV8YiaQKzXMd5DSKkr05w/640?wx_fmt=png&from=appmsg)image.png

此时显示没有碎片的时候，就已经完成了：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUicOicDg6AIicOR4C8gY6jauHFCKN2aP4Lj3RBSKB6UiaOXZmpKhbfM3zWA/640?wx_fmt=png&from=appmsg)image.png

从这里可以看到当前显示的文件名和大小：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU3xicamaOgibEyJV5iaS5q2WXusAickSJC7RmCs3uvTcjFc3WIrGfzD9PkQ/640?wx_fmt=png&from=appmsg)image.png

此时点击一下详情，修改下读写权限：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUc9oyEWeLB5fZPJMS3TLlLQN0Mckia6CWLic1BbcxOiceGFeARzZ6WU7Vw/640?wx_fmt=png&from=appmsg)image.png

修改权限为公共读：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUp8CRtRicDj0x96CLApPwpKWengvLGxWofJm2RexcAJtdicBBeGmThDVA/640?wx_fmt=png&from=appmsg)image.png

此时直接使用 URL 进行下载，在这里可以直接复制链接在浏览器里面下载，也可以使用迅雷下载，看了很多文章，都推荐使用迅雷下载（断点续传）：

用迅雷：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUzia9ddgDmH36VkQwYHw959FNdicvCickOr8dtcquw3qCrLfm743yEaH2A/640?wx_fmt=png&from=appmsg)image.png

插上网线之后：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUqn5HvbX4iazlboECIQpF1eFlyeAGT0ic8sp9ZowtCGqicv99mYUkB5hUg/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUm3M74qBUvaN2GSSicNaHh1JAHjgrzEnEYvbI1naWnqKUSnzPgCgjDibg/640?wx_fmt=png&from=appmsg)image.png

4. 本地环境打开镜像
===========

将镜像导出到本地之后，需要对镜像转换，将`raw`的格式转换为`wmdk`的文件，使用`VMware`打开。

### 4.1 qemu 格式转换

这个步骤你可以在`mac`上的`vm`虚拟机里面用`Windows`的机器来操作，也可以选择使用实体`Windows`系统的机器来操作，效果是一样的。

下载下来的文件是压缩过的，在这里将其解压：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUNhia84eVPAExKLdfvVNJq2ibYgVQV0tcUUp0CeicO0HLpIic7YW2Z2u1QA/640?wx_fmt=png&from=appmsg)image.png

文件解压之后，有`40`多个`G`，目前是`raw`格式，需要将其转化为`vmdk`的格式，使用`VMware`打开，在这里下载`qemu-img`软件：下载地址：https://qemu.weilnetz.de / 在这里看到只有`win`版本的，所以在这直接选择`64`位的下载下来：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUbX5YURRctXy9em4lJMCwUWvb1ibt7UbHd5KbiasLFkT5icQXLFQ0AiceAw/640?wx_fmt=png&from=appmsg)image.png

直接双击安装：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUHbWlqR81icMGK2Z8ias9vIwVv8XicRibj6fL9icRm4oDgkZiaiaKd7IPiaDGSg/640?wx_fmt=png&from=appmsg)image.png

安装完成之后，需要配置相应的环境变量，如果不配置其实也可以：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUMZHOf0X8fr41M6GTUL5L1DkWfTzrpZj1GSBs9ib95cehkdibdl1IIZibA/640?wx_fmt=png&from=appmsg)image.png

新建`cmd`打开，看下`qemu-img`命令是否生效：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUT8bfMPvh4eWJjBGf0d4lfibm1q4h8JRcVbaqTSxibftgSibgEcYV6bHHg/640?wx_fmt=png&from=appmsg)image.png

此时在解压之后的那个文件夹中使用该命令将`raw`格式转换为`vmdk`：

```
qemu-img convert -f raw raw文件名 -O vmdk 保存的vmdk文件名

qemu-img convert -f raw demo.raw -O vmdk 123.vmdk


```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUcSItOAJqB4iaiarH2S8kBy3ibBsP7pGVeLPAZXd8HHgYyQhbaDNz94Lug/640?wx_fmt=png&from=appmsg)image.png

转换需要时间，等待转换完成：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU0Xz7gbN5iauBPsy9VV6TLduf8S8bseX0LChmX9PiaibQNYnHSbw0HfT8w/640?wx_fmt=png&from=appmsg)转换完成的文件大概是`10g`，这时候准备使用`VMware`打开看下。

### 4.2 VMware Fusion-mac 下打开

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU7Y3MtzyJ0klyHMT8lEHicHfB4cxkJu8l7o2UPw0ib7JudSrpsm3yVQTw/640?wx_fmt=png&from=appmsg)image.png

创建自定义虚拟机：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUk4ekODq5xuqxvjB2kFv8tIxONVIhHFd5Ruu1tDoExiafTOgZxNhiaCzw/640?wx_fmt=png&from=appmsg)image.png

选择操作系统：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU2xe5lwAQoCbkEJveshUASObhibYYf8DOYEGotoZKEtXIlvBL2sYJtng/640?wx_fmt=png&from=appmsg)image.png

默认：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUU86KsKkxX8dlS147Et8iaB10Kp9hGQOdyuu6hMfibFdSOxf6Ref161UQ/640?wx_fmt=png&from=appmsg)image.png

选择现有虚拟磁盘：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU1icj89KUvRfs17TmL6e5XZGyEyGAj1RVDEtUGDXY2EaUFJokBtvTOyQ/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU0eiba7P5jpqGuwzfcHWq6djnlex2U11hxdwoibS9ibNs8olPYsm8EWfqA/640?wx_fmt=png&from=appmsg)image.png

然后存储选择和命令：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUv1jV3aolh3YDyy1xPV1zKmHtjZ8pI2uCbdfI5iaBtmibe6keicd6Avcow/640?wx_fmt=png&from=appmsg)image.png

设置好之后，跑一下看看：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUw7icSicTxPkCMkp21QQNB0fa3Lm3RBLh41V9tRb91GLTTyjrfdVVxx6g/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUN7CBiaqv4d11ubYROYYqvLjgYhjbZOib1jhxqN9s1OvhCDZvWlEYiczlA/640?wx_fmt=png&from=appmsg)image.png

网络问题，不用管，和本地设置有关

直接启动报错：

```
smbus host controller not enabled


```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU4F4mia9GmIwqhgwoPMtHnkKgbnrJNiaSdrFXIbmwCibPQp0f2ZQWgkerQ/640?wx_fmt=png&from=appmsg)image.png

主要的解决方法：https://blog.csdn.net/birencs/article/details/124405931

```
原因可能是：
刚扩展了磁盘容量，系统自动安装或启用了i2c_piix4模块。
解决：把它加入黑名单禁用即可。


```

其实在这里可以不解决，等着就行了，因为上面的解决方法我看了评论，好多人做了还是没用。一直等，大概`10`分钟左右（这个`bug`有人知道如何解决吗）（2024 年 06 月 06 日 17:54:52，新的取证测试秒打开）

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUv2Zd6icibZUbU2ceowxOaKpw7aYKPaKEHbvPBwRbSyxF5icLXHsFia23Mw/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUjSMS10XicpzqWN4Mws5lJQS9g6AtxZmc138Xib9TrbINsdhJPhZBvpZA/640?wx_fmt=png&from=appmsg)image.png

此时就可以了。  
使用`history`等就可以查看命令了。

### 4.3 VMware-Windows 下打开

问题比较多，直接尝试使用`Windows`的环境来做试试，首先在`Windows`上需要安装`VMware`，然后继续：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUOSt9Una3gc3BYmm4RyMjoFxqa65YKK7vusVQJ9uvib4Te66q5gDtTTQ/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUIcnv6dHV84eB348SEh36SP5W6ibDKibwHwpHjMLnFIJNRuDhKZnkwFiaw/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU93LETYsvEhu6TdU8R1icRt8wer6rSYA9pSbFqcke3pw48ve2StXyYFA/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUbLeBO0C8d41KPjCCiculEt4BkrvHSNNuoBxPD6jqTJib8qnZ1YWyPnNQ/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU6iboxUTGzbXoiasZyibJ9GprQ8LfvSFXAww4eYJWp3pKNbja3LFclLpsg/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUv8E6hhIeKRPGHb53gibSqiaNiaUUCEeRVffZtNuYydQYr8gsVT13V7hWQ/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUOS4aKpezvM6mDSlSqL0Xib9fMMpD1Ow6X3u0KtblWMksbyzb1M6LTKw/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUGsbA3QwkHicr9ExVRnB8zBg7J49icW9Wib20oAz7l8tS5epGMRCeCqT9w/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUbcaKVp3ZCaZV0adXFBOxCnc4EKQXhH1AOAlPqLXAiblLJqIZicbA6A7A/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUFic1ibLPhSRP8D3cX5682HRVgQVKArCNEUXljNP2gFpevOOGqLxzyPyA/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUtSjQUGZBdvD0NJWe2EhPQZqK0Zuhibw5Uu95U0tOpbj8EaY1Iaq4VpQ/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUDrUR2YITZicLLuPOboJXgMheVzfHAUFU8htsVZtkliba28bjlAZmtYFg/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzU9ptWwRZxV9N9fmicv16slib6wLFECYKKNusYRGllIEicyPJ894mAT7Wxg/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUaYyJFWGFwbgEmiczQ6ZDGQALaUfKZvRdz3F5yGIrXgqbA513C4icpXAQ/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUAibEJK2ecFjS69hibfbzv6opcrumT8KyZO0IrXk6hCohXvRYWGvmcZSQ/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUvWE6PrYUO0gBLVhArdYJPAwAYeOibq6MuZJEQ9oj884eggFkGDJe8jA/640?wx_fmt=png&from=appmsg)image.png

下面这个暂时不用管就行：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUBFqJV3lZ8mnjZ0oxt8zd4AqCAwLO7ROVVic9Ztx3Q9icOJzdFjAsHqCA/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUdicCj9GIGgibiaslXz8UsGqdm7ibDCCc1DdvlrJ7XAKB7TvEyBzaPuexeA/640?wx_fmt=png&from=appmsg)image.png

同样会遇到 mac 上遇到的问题，在这里等会就可以了：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUdznsefTO7TuhVb9RibCgG1ibq3IESibwicAn43oicAxEIIzABRLQeibTEm0g/640?wx_fmt=png&from=appmsg)image.png![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUFd4s02qORiaZwfg1kqg7EiaotKHb6F2bMpOabQW0eNdPHlmMnXluribIw/640?wx_fmt=png&from=appmsg)image.png

登录之后（已知密码的情况下），就可以直接进去了：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUwZH4M5icA70y9JaORfz6Um24DM1s4kiaVeuWQVZZuGNBkibzaB6EMe5uw/640?wx_fmt=png&from=appmsg)image.png

5. 重置 root 密码
=============

在这里用`Windows`的机器来进行演示：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUK4YvwR5WxgnicLrUpkoNQtYNZHRNzdxXcT7Vhd5Uy0BPl3l7cojXQxg/640?wx_fmt=png&from=appmsg)image.png

选择重启客户机，然后在下面的界面到来的时候，在当前界面输入`e`键，进入单用户模式：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUKNDkbBDYU2yqw0T2C7NSWnibCQliaEP2xx0qvrabRicMt4Ve9ibSpjzBbg/640?wx_fmt=png&from=appmsg)image.png

在这里找到

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUNuy4zTEW2E6L8WSPR60TdLDLiaU9D2tqDfMX7FPhB2dYn9nKSOknTpw/640?wx_fmt=png&from=appmsg)image.png

将`ro`之后的全部删掉，修改为`rw init=/bin/bash`

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUIAHcjPmJXt7BSZGq5M80PpnABasQ0cKb0CDibYJcpxLZw5eXWu8Fb3Q/640?wx_fmt=png&from=appmsg)image.png

然后`ctrl + x`保存后跳转，输入`passwd`，重置密码：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUYQuJia2NwKsxQmQXaPb3CfLYC9Fpw23QUU8FDjzgHJ5w9s8TQXjdkfQ/640?wx_fmt=png&from=appmsg)image.png

输入你的新密码即可：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUwI6Kl5xXRE10jtyZuTmPIGtSjpzaxicial0ju1baqNTsAYicpE06psibfg/640?wx_fmt=png&from=appmsg)image.png

此时重启客户机：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUlKCkqkojBYUXib7IfSiaibC8ev3SeFaTGqcibXCyY0BTdlvrEjXSxUbj9g/640?wx_fmt=png&from=appmsg)image.png

然后等着：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/HficxWTTwt1BssomibPbWeepJRbfVdEtzUO7ehXj7G927PBgvV7f2obE71T5XU5Gwer3ia04A7BCYO2PhckaHwhTA/640?wx_fmt=png&from=appmsg)image.png

此时就成功了，接下来就可以愉快的进行取证了。

6. 总结
=====

本文仅仅是对`ecs`导出之后，本地将其启动起来而已，其实你可以简单理解下，就是`VMware`里面运行的某个虚拟机，打了一个快照，然后拷贝到你的电脑上，然后在你的电脑上运行而已，没有太大的难度。

tips：加我 wx，拉你入群，一起学习

![](https://mmbiz.qpic.cn/mmbiz_jpg/HficxWTTwt1ACBHDE9o8KA6icOCZVKdLBJOca699BJK50FDxBNnhRZrS1hyXb2K4AkLTYfJwticmyHQxv3X6vZHfQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_png/CibE0jlnugbX5SLGI9312kOrkH7gXIN5NPic75bQ8WbAFMEqvZiaQ0WSk4W9eYUfJJRzlMgibjic8mIGicMvjialoDgmQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/HficxWTTwt1ACBHDE9o8KA6icOCZVKdLBJkslQQ2B5nDuKBlpbKHHtME5RBrJsYucDbPWpyglY02yicRq93PTWn7w/640?wx_fmt=jpeg)

扫取二维码获取

更多精彩

乌鸦安全

![](https://mmbiz.qpic.cn/mmbiz_gif/HficxWTTwt1Bt3mgRlo88wGCQuAJ2kv0pzM18jFmpv4CJEBMNAicGSSvDlWSN6DG5JJ0Q8EI6oEuaZS0QNyAojYw/640?wx_fmt=gif)