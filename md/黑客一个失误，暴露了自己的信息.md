<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/-7GZt-HFWL_blYsoWb3RNg)

点击蓝字

关注我们

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgfeQXzhSalyJbiaF04aTlfMtXib1rSTlf7FgVFTrjqXgJ6SAqYuibvBM9Q/640?wx_fmt=png&from=appmsg)

**前言**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgcpNRqmTTHiasA4xFu8cg5fzZiaNYeF6I20WSbDzicichOX2Zia98N2RYhiaA/640?wx_fmt=png&from=appmsg)

恶意软件开发人员的操作失误，使得 Check Point Research 的研究人员能够获取到恶意软件的开发人员的信息，包括位置信息、账号信息、电话号码信息、电脑截图等个人信息，发现了两个团伙成员，一个在土耳其、一个在尼日利亚。

我们来看一看研究人员是怎么发现的。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgMZd5FicCnfszKIpKBSduenz9cEBqpO2hPicjviab0paPyeEueiasjghCFw/640?wx_fmt=png&from=appmsg)

**S**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgcpNRqmTTHiasA4xFu8cg5fzZiaNYeF6I20WSbDzicichOX2Zia98N2RYhiaA/640?wx_fmt=png&from=appmsg)

Styx Stealer 恶意软件的开发人员，下文简称 S。

Styx Stealer

Styx Stealer 恶意软件，中招后，会盗取受害者电脑上的敏感信息，包括浏览器保存的各种密码，一些特定后缀的文件等。会盗取 T 平台的登录信息。

这个软件的开发人员就是在土耳其的成员。

**C**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgcpNRqmTTHiasA4xFu8cg5fzZiaNYeF6I20WSbDzicichOX2Zia98N2RYhiaA/640?wx_fmt=png&from=appmsg)

安全公司 Check Point Research 的安全研究人员，下文简称 C。

**F**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgcpNRqmTTHiasA4xFu8cg5fzZiaNYeF6I20WSbDzicichOX2Zia98N2RYhiaA/640?wx_fmt=png&from=appmsg)

Agent Tesla 恶意软件的利用者之一，下文简称 F。这个就是在尼日利亚的成员。使用到的是另一款恶意软件。

**T**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgcpNRqmTTHiasA4xFu8cg5fzZiaNYeF6I20WSbDzicichOX2Zia98N2RYhiaA/640?wx_fmt=png&from=appmsg)

两款恶意软件使用到的 Bot 软件。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgMZd5FicCnfszKIpKBSduenz9cEBqpO2hPicjviab0paPyeEueiasjghCFw/640?wx_fmt=png&from=appmsg)

**01**

**起因**

C 的公司客户收到一些钓鱼邮件，里面包含了恶意软件附件。  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgtAGvEKhspXKRDvZBLAian0ZLgXcjQ8RNyWYaMnVzKYHzHAdVS1FVFmA/640?wx_fmt=png&from=appmsg)

**钓鱼邮件**

**02**

**Token**

C 通过对恶意文件的分析，发现是一款偷取信息的恶意软件。

点评

邮件中的未知附件不要随便点击，有可能就是钓鱼邮件、恶意软件。

C 发现这款恶意软件使用的是 T 平台来接收文件，同时 C 在恶意软件的配置中找到了 T 平台的 Bot Token。

**通过这个 Bot Token，C 可以获取到 Bot 收到的信息和发送的信息。**  

就是说，一旦有新的消息发送给这个 Bot，C 是可以接收到对应消息的。C 就可以获取到文件进行分析，这也是后面分析的基础。

**03**

**监控**

C 开始监控并分析 Bot 收到的文件信息。  

C 分析发现，有一个文件跟常规的文件格式不一样，分析发现是 Styx Stealer，就是恶意软件作者开发的恶意软件。

同时发现，里面包含一张桌面截图，分析发现是恶意软件的作者在调试恶意软件，截图中包含了另一个 T 平台的 Bot Token。

点评

由于是在恶意软件的作者电脑上运行的，因此保护了恶意软件作者的电脑上的各种信息，也为后面的分析提供了基础。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgCtWRjWK7jjcIAn2zhBJVj3cZcRoqFOLibCeU0s7wnMfj9YtkmcotJRg/640?wx_fmt=png&from=appmsg)

**截图**

**04**

**分析**

截图中的语言（截图右下角，同时里面的 comment 也不是英文）是显示的土耳其语言。

C 从文件中提取出加密的 T 平台账号信息，这个文件是从 S 的电脑上上传的，其中一个账号的电话号码是 + 90 开头的，是土耳其的号码。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsg4Bic4Lurqiczu7ibmD5VDYD5deSTW3c9QtZPR2xAhp9Dk398LUZWqsyQA/640?wx_fmt=png&from=appmsg)

**手机**

同时这两个账号的状态地址也是土耳其的城市。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgr37eosqfGsJfbwAicGTdmibBRVN3mfl7QdxY6VDpW1NicVghzESegZvhw/640?wx_fmt=png&from=appmsg)

**地址**

同时还发现 S 和 F 两人之间使用 T 平台聊天的信息，S 将软件卖给 F 使用。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgj2rtq5ZO1ufZdf85KexKGw9Mndrgib2Otnr5JhgUA7ECFRcZzgdWuXg/640?wx_fmt=png&from=appmsg)

由于软件检测到虚拟机，F 在虚拟机上没有运行成功，F 在自己的电脑上运行了。这样就暴露了 F 的位置信息。

S 收到 F 电脑上传到文件信息，在 T 平台，同样 C 也可以获取到。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgOLrQ3eicMLzwWTnWJVU475Ddl3hqhZkvlDTveV2WWtJmTYS0b745HDQ/640?wx_fmt=png&from=appmsg)

  

  

下图是 F 的 ip 地址信息，和 Mac 地址，ip 信息是尼日利亚。  

  

  

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgZwe179icfgOSydeRia7aoG5rotjtcUJd9eW7pCm2pibic6E1kPRhoHs7Rw/640?wx_fmt=png&from=appmsg)

下图是 S 的 ip 地址信息，和 Mac 地址，ip 信息显示是土耳其

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgg0u2CQVOicLoOWFJNg9Bx4zMJRCWtA8NzsVxdQfR8V2TMiaSaUMwZzqw/640?wx_fmt=png&from=appmsg)

综合各个信息，以及获取到的其他账号信息，进一步调查，交叉验证，可以判断出，S 是在土耳其，F 是在尼日利亚。  

**05**

**总结**

S 开发了恶意软件，在自己的电脑上进行调试，所以自己电脑上的信息被窃取上传到 T 平台。

同时 S 将恶意软件卖给 F，让 F 也运行，由于 F 在虚拟机运行失败，在自己的电脑上运行了，导致 F 的信息也上传到 T 平台。

同时，S 让 F 把 T 平台的 Bot Token 发给他，他更新恶意软件之后，再次在自己的电脑上运行，导致自己的电脑信息再次被获取。

研究人员拿到这些信息，完成了对他们身份的分析。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/aZOIQG72FjSZgdJF7BrOINepBaeIBxsgrnViaDEia3LSPMr4S00XicWmCFRpJcUiaWx1eSlZFGULkjvfN9Rx3oUjbA/640?wx_fmt=png&from=appmsg)

**关系图**

一次 “失误”，导致两个恶意软件背后的人员信息被分析。

传播恶意软件是违法行为，未知附件不要点击，日常提高安全意识。

文章详细信息可以进一步查看 https://tcp.im/YbPubJ。

点击名片进行关注，获取更多黑客故事