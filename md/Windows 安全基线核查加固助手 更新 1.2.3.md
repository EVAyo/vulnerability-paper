<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/fQgnD1lDfUEOM4Vgbo0hFA)

**01**

**工具介绍**

WindowsBaselineAssistant(WBA) 是一个用于检测和加固 Windows 安全基线的辅助工具, 借助此工具你可以免去繁琐的手工检测和加固操作, 实现一键检测和加固你的 Windows 安全基线, 并可以导出检测或加固结果, 解放你的双手~

**02**

**工具要求**

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOaL4Ujtm9iagfY0cNRZLTCRVv07x5DAgjc2DuhAqmt9qSJJbHAMzwoIQ/640?wx_fmt=png&from=appmsg&wxfrom=13&tp=wxpic)

**03**

**运行要求**

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOf4u2niaqX7WyQEibA0qkT5jW1A43LDGMUtyNvgYHXj4m4gq9eXfiacflw/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOuHibgw2A0fk3wBBsgMkV8ycbSRm5sjq5KjiaZ0uoLGh52hwIib0mMs2rQ/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**04**

**自定义规则**

WBA 支持自定义规则以适应不同环境下的检测需求

WBA 的所有规则位于 item.xml 文件中, 其中检测规则分为 registry 和 secedit 两种, 判定规则分为 fixed,enum,greaternumber,lessnumber,array,equals 六种.

**规则格式**

registry(读取注册表)

```
<item>
  <name>检查源路由配置</name>
  <description>源路由攻击有源地址欺骗、IP欺骗等,为了提高系统的可靠性,需要检查是否启用正确配置源路由攻击保护.</description>
  <type>registry</type>
  <registry>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</registry>
  <regitem>DisableIPSourceRouting</regitem>
  <standard>2</standard>
  <assessment>enum</assessment>
  <valuetype>dword</valuetype>
</item>

```

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOsQVFytGlj5H5D7TfcHxAFatn3Z7AmQWdqYicRTQUDYy3icleEZY9mQPg/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**secedit(读取 config.cfg 信息)**  

```
<item>
  <name>检查密码最长使用期限</name>
  <description>长期修改密码会提高密码暴露风险,所以为了提高系统的保密性.需要检查密码最长使用期限.</description>
  <type>secedit</type>
  <mark>MaximumPasswordAge</mark>
  <standard>90</standard>
  <assessment>greaternumber</assessment>
</item>

```

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOj1SqtPM8sCXCxicXGsGMGWLWLOB1VTO2XZn6axibiaMKwtZbFiaZ7EwxuA/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**附加标识**

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOBRctZibX7Za0KFfEPDJY0Wed7aF7Z54DJLPKiaSoia34qMoJA0wdKCnrw/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**判定规则**

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOPSsCDPGkXfKZYBHhLlic2wkEErPmHujeRdtxjj5vOQnvickgTcTOolfw/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**数据类型**

![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUAdmYwqDIPYFhxzdiczRLpxOLo6bDX4ia9CylwBbhmLFKHeicL0Hu3KGz9pYHvAJibGcZiaTOgvX5u2kng/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

**例**

如现在要检测重新传输的 TCP 连接阈值  

```
检测类型为检索注册表   检索的注册表路径为HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\Tcpip\\Parameters
检测项为TcpMaxHalfOpenRetried
标准值为400
数据类型为DWord
检测值要小于此值时判定符合

```

```
<item>
  <name>检查处于SYN_RCVD 状态下,且至少已经进行了一次重新传输的TCP连接阈值</name>
  <description>xxxxxx</description>
  <type>registry</type>
  <registry>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Tcpip\Parameters</registry>
  <regitem>TcpMaxHalfOpenRetried</regitem>
  <standard>400</standard>
  <assessment>lessnumber</assessment>
    <valuetype>dword</valuetype>
</item>

```

**05**

**工具获取**

https://github.com/DeEpinGh0st/WindowsBaselineAssistant

扫描二维码关注我们

![](https://mmbiz.qpic.cn/mmbiz_jpg/ia3Is12pQKnI7tvUGQNe0VzBwCib8pgQacsLhjbkwZmrQNNuovCccwtJSqN8mKGKMG8Zo4icryKv25eOOg41tEB6g/640?wx_fmt=jpeg)

**_文章来源：李白你好，如有侵权请联系我们，我们会及时处理。_**