<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/rekFlCih9lOfgQw0a3W8RA)

"永远会有更好，眼下便是最好"

**0X01 准备工作**  

需要用到的工具：  

```
微信 3.9.7.29（PC端）
ProxyPin(本机安装SSL证书)
BurpSuite(本机安装SSL证书)
项目地址：https://github.com/wanghongenpin/network_proxy_flutter/

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlianHJuP0lDRr5FcYUCsljSicFb4Bl6nlOHUkrFPfdEkNZKaB6ZWfqD2Q/640?wx_fmt=png)

```
下载地址：https://www.lanzoub.com/iCG6E1ebwkmb

```

**流量走向和抓包方案：**

```
电脑（PC）端微信小程序-->通过ProxyPin -->到Burpsuite

```

流量从电脑（PC）端微信小程序通过 ProxyPin 再走到 Burpsuite 工具，最后使用 Burpsuite 来进行修改和重放，其实就是走了一个代理链。

**配置抓包环境**  
**第一步 设置 ProxyPin 监听环境**  
安装 SSL 证书到本机

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2Vl9uibUvFNnTHZmicdZJicqAicKcKmB41CKUm38TkWn7dI5S5KrEX2HicSl3g/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlkOg8FHlywdf7kW1aZUTj3ATDicnWeuzAmyAAEicIAD29syzIf9E6th2A/640?wx_fmt=png)开启 HTTPS 代理  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlG67pvib0nQ5qMQR9bjrYWDMDSMgjQic7iafNa91dliakzhicxDYbrK2GPBg/640?wx_fmt=png)

打开需要抓包的微信小程序  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlSAmE1JgGLxKoNBsKrpM1zPdlBF0InJPtq8WbR3k0oOianXWfb2EPc6Q/640?wx_fmt=png)

可以看到 ProxyPin 成功获取到数据包，下一步将流量转发到 BurpSuite  
在 ProxyPin 中设置外部代理

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlDc4BZ8E5RgCx4B6uMQEaJuRWuPL74nt7523bdoibQOibqxYxgibL3vr3Q/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlhuzHSstEA3iaAFJ6o1WZc43KXGqbb1ibO1saaiaY7BDaY7eOYcLFLJQ8Q/640?wx_fmt=png)

**第二步 设置 Burpsuite**  
打开 Burpsuite  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlpSSmh2dgBmZyCcQvAK4GaLfm7lxTa3oSwUMHEGPNTkNDM0wVpWoJvQ/640?wx_fmt=png)

查看监听的端口，注意不要和 ProxyPin 与其他软件端口相同  
在浏览器中安装 Burpsuite 的证书  

```
http://burp/

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VllTmPnOUOoPHdlojia4dhCG7xV9IyjOHetumnjxic0TXtBBZWn7ZwJ0zw/640?wx_fmt=png)

下载证书到本地，浏览器设置证书，搜索证书  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlqtvSw0f5SU70S4buuqPoKMFUx3I47fEhFaH9AoUyeicxwRaQu9fD7Dw/640?wx_fmt=png)

查看证书  
然后导入，下载的证书  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlTI5xqcLFibxDZTBC3iclaIcMRtoVkGLOxUTw9amLB4tdwpqFgpgndnNw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2Vlicl9AIvvBbXFcHsdpjpAFCmStic72Sicjqic7exY0TjB2oXSRnYr6uMcrw/640?wx_fmt=png)

到这里 Burp suite 的设置也完成了， 可以去抓微信小程序的包了

**0X03 漏洞挖掘**  
微信电脑端：打开小程序  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlYqptn9Wqdyn4RUt6A42CYsGbAKNw4zrpBFCRMBA10hyxz9jrPX0jkA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/z3TOtprWtZic0AJNUmV30Rxo1uTLAE2VlC2wuvjQM2vYSAiafbkibvMxbR20mFc1qGia1PFIicERlxhG3iamD95aasKg/640?wx_fmt=png)

**仅用于技术交流，请勿用于非法用途**。**  
**

技术交流
----

    扫描下方二维码，并在验证信息中说明来意，文章仅供交流学习, 本公众号不承担任何有关责任!

![](https://mmbiz.qpic.cn/mmbiz_jpg/z3TOtprWtZibxicaHzm6icoKWFPFB9gcBcv3aWA5wEMcgOXfZpDoqgYicfibMPBzx2Jle7p28TWsEGCdgwsDRwhUy2w/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

**免责声明**  

该文章仅供网络安全研究使用，禁止使用该项目进行违法操作，否则自行承担后果。

【往期推荐】  

[送新书《ATT&CK 视角下的红蓝对抗实战指南》](http://mp.weixin.qq.com/s?__biz=Mzg2ODY3NDYxNA==&mid=2247485001&idx=1&sn=84519843e326e00e6450df1720a976b1&chksm=cea9fb10f9de72065a6e465217a52876af22109794fe818132b08e6436ff0348341dfbc7be29&scene=21#wechat_redirect)  

[某地级市 HVV | 未授权访问漏洞合集](http://mp.weixin.qq.com/s?__biz=Mzg2ODY3NDYxNA==&mid=2247484711&idx=1&sn=1a4b9c21828124b17062bf65dd379a5e&chksm=cea9f87ef9de71685eb931136cfc32748265a0d82c8570f01d6f9199db41bbe26d74dd1b4135&scene=21#wechat_redirect)  

[起底盗号背后的黑色产业链](http://mp.weixin.qq.com/s?__biz=Mzg2ODY3NDYxNA==&mid=2247484690&idx=1&sn=bbbe368f363ce2fb7d78869a06f4bb27&chksm=cea9f84bf9de715d463782f664178725884a583db9195584f64ed045ca3926940e345d921dc9&scene=21#wechat_redirect)

[CobaltStrike 4.9 附下载链接！！后门自测！！！](http://mp.weixin.qq.com/s?__biz=Mzg2ODY3NDYxNA==&mid=2247484958&idx=1&sn=95f9e96789bc56741ddcedc6288b048c&chksm=cea9fb47f9de725186b79164a05356a8bef5d934b138f24476991365ab3e8acdd67ea65d7d3b&scene=21#wechat_redirect)

[【应急实战】记一次关于 Ramnit 病毒的应急响应](http://mp.weixin.qq.com/s?__biz=Mzg2ODY3NDYxNA==&mid=2247484613&idx=1&sn=8aa12be6f305f4c6396a6c9d33cefd8f&chksm=cea9f99cf9de708a0e3b3b9195792eed65b943b5f0d32ab130397c4c287dcdaa4b394a06d993&scene=21#wechat_redirect)

[【渗透实战】记一次某医院 LIS 系统 SQL Server 数据库提权（有手就行）](http://mp.weixin.qq.com/s?__biz=Mzg2ODY3NDYxNA==&mid=2247484557&idx=1&sn=c7a38342cfe2b8840ec5634e93ff9ea7&chksm=cea9f9d4f9de70c23d3c915af96b9fc24f46a04a6373287421914d042f7e2a1903a72d1b31c1&scene=21#wechat_redirect)

[干货分享 | 红队内网环境中快速开启 HTTP 服务的小工具 - 可执行 Webshell](http://mp.weixin.qq.com/s?__biz=Mzg2ODY3NDYxNA==&mid=2247484184&idx=1&sn=6a49b32152e400bbba19bac60a4ae413&chksm=cea9fe41f9de7757d8f5e470d80b28ba9dda184f380061c551c66ad6dbfaf14488c1c4a917bf&scene=21#wechat_redirect)