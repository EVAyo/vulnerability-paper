<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/8Wl-uhuk_b-9ImMzrOzTWQ)<table><tbody><tr><td width="557" valign="top" height="62"><p><strong>声明：</strong>该公众号分享的安全工具和项目均来源于网络，仅供安全研究与学习之用，如用于其他用途，由使用者承担全部法律及连带责任，与工具作者和本公众号无关。</p></td></tr></tbody></table>

现在只对常读和星标的公众号才展示大图推送，建议大家把 Hack 分享吧 “设为星标”，否则可能看不到了！  

**项目简介**

Choccy 是一个用于监控 GitHub 仓库更新并自动对其进行 CodeQL 分析扫描的项目。  

**使用示例**

使用前配置好 CodeQL 环境，最好也在设置中配好 GitHub Token，否则可能会被 GitHub api 限制访问。设置 - 其他 -CodeQL 附加命令行选项 中的 --ram 2048 是允许 CodeQL 使用的最大内存，单位为 MB，请根据自己系统的配置酌情调高，否则可能影响扫描速度或造成扫描失败。  

目前支持 GitHub 仓库的 Release 扫描和原有 CodeQL 数据库扫描，GitHub 会对很多仓库自动编译 CodeQL 数据库（可以通过接口查看），这会省去配置本地编译环境的步骤和本地编译数据库的时间，所以扫描模式优先选择原有数据库，以 java-sec-code 这个项目为例：

```
接口：https://api.github.com/repos/<owner>/<repo>/code-scanning/codeql/databases
项目：https://github.com/JoyChou93/java-sec-code

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHH6yGzvJ4V48PXNueUX2fhflEj6BDMANSQNlVSujYzwgicZicYXSqCHIg/640?wx_fmt=png&from=appmsg)

查询套件是一系列查询语句的集合，可以点击菜单栏中的查询套件进行查看和编辑，这里可以先选预置的 java_security.qls。

然后点击项目右侧的加入扫描队列，这会立即创建一个任务，对项目进行版本检测和扫描。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHQwuHRQxuStREmTEibbpLx0ugkSGkjYCNkiaCkbZwTMgtGVoiba3dwcCOA/640?wx_fmt=png&from=appmsg)

在任务选项卡中，可以看到当前的任务执行情况及执行日志：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHSSnC5YInTOGnJVXosia78MlicRlYN8kwJ1XnpcUwNQIRRQdr7V1sSqyA/640?wx_fmt=png&from=appmsg)

执行完成后，可以在分析结果选项卡中看到具体的扫描结果，结果的展示完整复刻了 vscode 中 CodeQL 插件的展示效果，还做了一些优化，其中包含漏洞信息，漏洞位置，对应规则 ID，漏洞的完整调用链路，漏洞上下文代码，点击超链接可以跳转到 GitHub 仓库对应的代码位置。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHYr8Xvc3hvQLoFv33KxY9kYym5UEaEUQKI6oHBRbBY091SU2zTGhxhA/640?wx_fmt=png&from=appmsg)

项目被添加之后，默认会每周拉取最新版进行一次扫描，这可以在设置 - 其他 - 定时扫描 Cron 表达式 进行配置：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHbial10dOZxXKTjmgjLO1nnYws3Q5tecpniasS4GWq0JIMPcdTicxRnJOg/640?wx_fmt=png&from=appmsg)

另外，设置 - 环境 - 环境变量 可以配置系统访问 GitHub 时的代理等。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHMg2btvjHwvVcr5fibp8Rmre22x5usaJkzTuSiaDibpPlp9aHDzMfVU6Pg/640?wx_fmt=png&from=appmsg)

可以向 Packs 目录中放入自己写的查询库或查询语句，放置完成后可以到查询包选项卡查看：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHMUVjU0uaBR8tDoYyjX5vw6RDzya2KuwTKO7ibeOuSppTpibbjSNx6Dag/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHblTicdIy1y4WVJHW8icgJ9OJn3xzj4y2Y5rCMy7aBj7tmsZianDNVDuRA/640?wx_fmt=png&from=appmsg)

查询套件是一系列 CodeQL 规则的集合，可以在查询套件选项卡中进行编辑和查看：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHsBCgqWggFKLs9O0YOuVwptYxicQfwb3958bdzbesxEI9CGUPDa9TUkg/640?wx_fmt=png&from=appmsg)

语法参考官方文档：https://docs.github.com/zh/code-security/codeql-cli/using-the-advanced-functionality-of-the-codeql-cli/creating-codeql-query-suites

### **上传 CodeQL 数据库进行扫描**

在数据库页面，点击右上角的加号图标，将本地数据库打包为 zip 压缩包，然后上传，等待上传并导入完成（上传期间不可关闭该页面）

（上传功能并未采用分块传输，所以要求服务器可用内存需大于文件大小）

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHmibjT0ohLDR2UyfYtfsXwObicVtwuxc17qGXcl21icDl2RGxV6tXdDxrg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsH3iah1ZseD2DbWu9HMK3QUt4sGHicXR2nEk2AyTOT6qygJSPV7uphkTYQ/640?wx_fmt=png&from=appmsg)

在任务页面，点击右上角的加号图标，选择数据库和查询套件即可，项目名称默认和数据库名一致

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHicATI1QI7m3QIDJ0FBoUsQULurkHNn0mRMfKmD4NP07ygVaIGjmKMibQ/640?wx_fmt=png&from=appmsg)

### **批量选择 GitHub 项目进行扫描**

在任务页面，选中右上角的加号图标，点击从 GitHub 批量创建

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsHzJYG6d69QEia9jgDIUAz91KZiacYmKh8Nk2gZVBzplWNRyWBdgkcFVHQ/640?wx_fmt=png&from=appmsg)

搜索语句为对仓库的检索，语法参考：

https://docs.github.com/en/rest/search/search?apiVersion=2022-11-28#search-repositories  

扫描范围指的是按某种顺序排序后，取出哪一部分进行扫描。如下截图中，将按 star 数量逆序排序，并扫描第 11 和第 12 个仓库

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud9Brw2KzO85FxykXOibiaRsH50UNtaZT53icVBHnjBlk5euHNDQ2uoWf02QwXiavxluibdHUn13lj9qnA/640?wx_fmt=png&from=appmsg)

**下载地址**

**点击下方名片进入公众号**

**回复关键字【****240403****】获取******下载链接****

**知 识 星 球**

  

  

不做过多吹嘘和夸大宣传，至于分享的内容值不值，大家最好自己去看下，3 天不满意可随时申请退款...。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/79gZQNibQ6ufDmpcoyC5XibXzJB5W7U9Le20DCcRicTkgicmjHKDdvoXhvaQPuMpibvrt7OCWbRQokMTmHxMZ44WVWw/640?wx_fmt=jpeg&from=appmsg)

往期推荐工具

[Commando VM 3.0 红队渗透工具集](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247488119&idx=1&sn=46b3e67c8df3371ed89345483a28fd81&chksm=9036f4cfa7417dd99eb192885f0027d772137ad5aa5492b11e497e07c99094dd1224202510a0&scene=21#wechat_redirect)

[Hikvision 海康威视数据库账号解密工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247487695&idx=1&sn=abc501bf88daa8fc338d1d9e8ddafa2d&chksm=9036f677a7417f61ee0ddae07cf2e3158223c862ac7510dd5f35c70f84b4d700d64d0e19f273&scene=21#wechat_redirect)

[很强！Windows11 渗透测试工具包](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486427&idx=1&sn=4a229ee22d428a2c926f9250e6de6a56&chksm=9036ed63a741647536b01e6397483c6cee5eb4dd0ee551728c34e8d0b1a73cfdc64c6c69922b&scene=21#wechat_redirect)

[N！9 个 OA 高危漏洞利用工具 v1.1.6](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486468&idx=1&sn=67e6dc1a332769490a2b3062b6c7a909&chksm=9036eabca74163aa9572b4baee14ad2bc1b16c990c64c9e865b8319a31bc23b0b021a03d4b51&scene=21#wechat_redirect)

[v1.1！最新版 Weblogic 漏洞利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486498&idx=1&sn=2c0458c4a1a51518d888dd553d86beed&chksm=9036ea9aa741638c0bbd6cb8d66f197df3d929960f3aa712960c3a016fd9c36c953051b723d8&scene=21#wechat_redirect)

[防溯源！无 VPS 也可用的 C2 小工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486150&idx=1&sn=f5b71fa5e38dd67b558350987198a4fd&chksm=9036ec7ea7416568728ffe8ba9cdf76c51480bd1c5da2e921cdca2e3f4d5222b504173781599&scene=21#wechat_redirect)

[Q！两个免费的数据泄露查询平台](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486138&idx=1&sn=9ba3b3d72c6f8199be9732ea0fe24995&chksm=9036ec02a7416514c46b532af361cbf9073351710013504835751a583a1b54e350f040d1d0a0&scene=21#wechat_redirect)

[](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483907&idx=1&sn=4e7cf5de0472f6685edb64a598e6aff8&chksm=9036e4bba7416dad5aa253462a84d0c47fdb4e89914c70bd5a3fbbd8b4ef05572a4e7e702faa&scene=21#wechat_redirect)[GodPotato！新版土豆提权利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486017&idx=1&sn=63dec820664e5abc687ebbeb389ee3ba&chksm=9036ecf9a74165ef8a9bea29dff6ab7194d53f584cc69f6713ef10e11c0067d6d45ba36bda6d&scene=21#wechat_redirect)

[牛 B！一个国产的安卓渗透工具箱](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247485816&idx=1&sn=55d4450fa7dc6d8ec0ec8ed6a7d8c50d&chksm=9036efc0a74166d638ac84732d5e09caf86956561c6b2f9973f5e91429af0f8c68efcbc3b0e1&scene=21#wechat_redirect)