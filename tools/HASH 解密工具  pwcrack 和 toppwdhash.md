<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Puy_sQA1BxlP4KLs2H_V0g)

  

![](https://mmbiz.qpic.cn/mmbiz_png/toroKEibicmZDxicuqPkFfjdG2kcyzCXrXf0zrlDGZOnCofnEffxJaK5EDWfvZprrvHVAGSxiaSeXibS6GerhEAsLjw/640?wx_fmt=png)  

**_△△△点击上方 “蓝字” 关注我_****_们了解更多精彩_**

  

  

  

  

**0x00 前言**  

  

上次分享过一款 Hash 格式识别工具【**haiti**】，能够简单的识别 hash 串可能的 hash 类型。

  

![](https://mmbiz.qpic.cn/mmbiz_png/toroKEibicmZBcPuoOeKOFQkla39qZY4Dyv7TntljTApKtIDEAF9CJKVrdvcib3apANwO5gk17dBCPbcaAbmpwH1Q/640?wx_fmt=png&from=appmsg)

  

在实战中，实际用处可能不大。一般都是通过查看长度猜测出常见的算法，然后在 cmd5 等 hash 解密网站进行解密。

  

**cmd5 确实好用，就是有点费钱。**

  

1、类似 cmd5 的在线免费 hash 解密网站也有很多，每一个都去尝试就过于麻烦了，**那有****没有一个综合框架来聚合各 hash 解密网站来进行查询的呢？**

  

哈希解密的原理，其实就是通过建立计算好的哈希值到可能明文的映射表，然后快速查找已知哈希值对应的可能明文。

  

这种方法依赖于存储大量预先计算的数据，对于密码破解很有效，尤其是当密码强度不高且未加盐时。

  

穷化一下思路，我们不需要像彩虹表一样制作所有字符串的可能加密。可以只制作常见口令的常见加密算法的对应字典，这样能够节省性能和存储需求。

```
常见的口令：弱口令Top100000字典
常见的算法： md5,sha1,md5(pass),还有特定的CMS的加密方式等等

```

  

**既然已经知道原理了，大家已经可以开始制作一个哈希解密工具了。**

  

  

  

**0x01 pwcrack-framework**

  

**pwcrack** 是目前仍在积极维护的一款聚合 hash 密码自动破解框架，使用 Ruby 编写，目前**提供 23 个在线破解和 40 个离线破解接口**，支持 63 种算法破解。  

  

```
1、【重点】支持多个在线接口查询解密
2、【重点】支持多种算法的解密
3、【重点】支持生成常见hash的本地密码数据库

```

  

**pwcrack 功能强大，唯一不便的就是使用 ruby 编程, 需要安装 ruby 环境才能运行 (该问题在下文解决)。**

**项目地址：**

```
L-codes/pwcrack-framework: 
https://github.com/L-codes/pwcrack-framework

```

  

**简单上手:**

```
pwcrack e10adc3949ba59abbe56e057f20f883e
pwcrack e10adc3949ba59abbe56e057f20f883e -s localdb

```

  

**提示：**localdb 功能很有用，适合在批量解密大量 hash 数据时使用。********懂得都懂，不懂的以后应该会懂。****

  

  

  

  

**0x02 **pwcrack 安装的** rjb 依赖库的问题**

  

2024 年 5 月份之前，由于 rjb 依赖库在 windows 上无法正常安装和运行的问题，导致 pwcrack 在 windows 上使用是不完美的（无法调用 java 插件，如 finalshell 解密和 nc 解密插件）。

  

因为类似的活跃项目基本没有，所以想着要让项目适用性更广，就在一直在尝试解决这个问题。

  

经过不断努力，最终选择了逃避。放弃解决 windwos 下 rjb 安装问题，将已有的测试记录摆烂提 issue 给 rjb 开发者，但是许久过去一直没有任何消息。

  

经过了长达几个月的等待，突然有天开发者回复我了，然后又失联了 (心态炸了)。

  

又过了一段时间开发者终于是发布了测试分支，经过编译测试后成功在 windows 中运行。

  

截至目前发布的 rjb1.7.2+ 版本, 已经能够完整的在 windows 环境中安装并运行。

  

经过测试 pwcrack 在 windos 环境下可以运行于 ruby27 版本和 ruby31 版本，可以直接进行 bundle install 安装使用。

  

安装方式也很简单，安装好 ruby 以后直接在 pwcrack 源码目录下运行 bundle install 即可。

  

windows 下 ruby 环境的安装很久以前在推荐 whatweb 指纹识别工具的时候有写过 [Ruby and Whatweb Install on Windows](http://mp.weixin.qq.com/s?__biz=MzUzODU3ODA0MA==&mid=2247483803&idx=1&sn=576fb62a1bb15157f847c9419220e6e3&chksm=fad4dc8ccda3559a65f851c4f23459d9450687dee138aee0ef252f38b676a0f8bf21e238e550&scene=21#wechat_redirect)  

  

  

  

  

**0x03 pwcrack.****exe 的打包问题**

  

本来按照一般逻辑，此时我应该发挥自己的作用，提供一个打包好的独立 exe 分享给各位大佬使用。

  

但打包完成后，我发现 rjb 模块和 msgpack 模块在 windows 中是以 so 格式的依赖库的方式进行导入的。

  

本身 rubyc 打包程序时是不支持将 so,dll 等依赖库打包进 exe 文件中，经过不断的失败和尝试，最终通过修改 rubyc 的源码实现了打包 so 文件进入 exe。

  

当我觉得大功告成的时候，发现打包的 pwcrack 的独立 exe 程序，还是无法加载 rjbcore.so 文件，不管 so 文件在 exe 内部还是 exe 外部。

  

这时候我大概理解了开发者为什么在打包时将依赖库文件排除，原来是无法加载，也没有找到任何的原因。

  

生成的 pwcrack 文件有些过于不完美，rjb 模块影响的是 java 插件的调用，这个还是小事情。

  

更过分的是 msgpack.so 模块影响 initdb 和 localdb。打包好的 pwcarck.exe 不能使用本地库解密 hash**。**

  

那我要他有何用，遂删除打包好的 pwcarck.exe 程序。

  

最后，通过使用纯 ruby 实现的 msgpack-pure 库来补充了这个库程序，修复了 PE 文件下的 localdb 功能。

  

缺陷是**原生 ruby 实现的 msgpack 比 c 语言实现的 msgpack 速度更慢，导致 initdb 很慢。**  

  

  

  

  

  

**0x04 pwcrack.exe**

  

对代码做了一些优化，让其更适合与于作为 PE 的运行，windows 下不需要再安装 ruby 环境，可以直接运行。

  

![](https://mmbiz.qpic.cn/mmbiz_png/toroKEibicmZBcPuoOeKOFQkla39qZY4DyYiadnuEskicITKcTo0gKAQibFliaianBQBiaw1p8gkkZMXldmJPLcf1VxSBg/640?wx_fmt=png&from=appmsg)

  

使用时，需要将插件目录和 data 目录存放于程序的 ROOT 目录。

  

PE 模式下 ROOT 目录其实就是：

**环境变量 **PWCRACK_PE** 指定的值 或 当前工作目录.**

```
PE_MODE = ENV['PWCRACK_PE'] || __dir__.include?("/__enclose_io_memfs__/")
ROOT = ENV['PWCRACK_ROOT'] || PE_MODE ? Dir.pwd : __dir__
puts "[*] Current Root Path: #{ROOT} <-> PE Mode: #{PE_MODE}"`

```

**plugins 目录 rb 插件功能测试正常**

![](https://mmbiz.qpic.cn/mmbiz_png/toroKEibicmZBcPuoOeKOFQkla39qZY4DyhGSFju5IBDib5ticqicY4LrMw3yAiaIeEnaqKe0kdmyns4ibKY0V4WNFR5A/640?wx_fmt=png&from=appmsg)

```
plugins目录localdb插件功能正常

```

![](https://mmbiz.qpic.cn/mmbiz_png/toroKEibicmZBcPuoOeKOFQkla39qZY4DyYphibIjVeN3nffQXicb8KUwcYbs4z1cmLVxM3yTswzXibqtvdD8bC34EQ/640?wx_fmt=png&from=appmsg)

目前和以后大致都存在的问题：

```
1、rjb等使用非原生ruby实现的插件,无法在PE模式加载。
2、initdb localdb 功能使用时 会比原版本慢一些。

```

  

其他注意事项：

  

1、使用 rb 运行和 pe 运行时用的制作 db 库有可能有细微差距，更换工具最好重建 db 文件。

  

2、plugins 插件目录在复杂中文路径可能会找不到，建议使用英文路路径。

  

  

  

  

**0x05 toppwdhash**

其实不用 pwcrack 的的本地 hash 解密库，也还有别的 loacldb 项目可以补充，比如 toppwdhash

toppwdhash 是常见密码哈希离线查询工具

包含算法类型如下：

```
'md5', 'md5x2', 'md5x3','sha1', 'ntlm', 'mysql', 
'mysql5','md5_sha1', 'sha1_sha1', 'sha1_md5', 
'md5_base64','md5_middle','base64_md5', 
'md5_sha256', 'sha256','sm3'

```

toppwdhash 是 Python 编写的，很容易编写出新的加密算法，很适合本地使用。

**项目地址:**

```
moyuwa/toppwdhash: 
https://github.com/moyuwa/toppwdhash

```

本次也提供了 toppwdhash.exe 和原版文件命令可能有一些区别.

  

  

  

**0x06 其他**

  

pwcrack 本身是不支持批量查询的，因为开发者觉得这样不太好，查询频率过高会导致 hash 解密网站压力过大，导致接口封禁，所以没有提供批量查询的功能。

  

但是如果结合 localdb 来进行批量查询还是很有意义的。

  

如果你能从 pwcrack.exe 中发现彩蛋的话, 大概是能够用上这个批量查询功能的，但仅建议用于 - s localdb 使用。

依旧是公众号后台回复【共享】获取打包好的程序。

![](https://mmbiz.qpic.cn/mmbiz_gif/icZfUh6Tsbv0xAFjs5qQlsFCCmymOS3Vq8v6OSKDP0pw3aoCD4OTqojr5NMysBOcoMehddw6JUqYXVuurThNLsQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

  

  

  

  

**0x99 免责声明**  

在学习本文技术或工具使用前，请您务必审慎阅读、充分理解各条款内容。

1、本团队分享的任何类型技术、工具文章等文章仅面向合法授权的企业安全建设行为与个人学习行为，严禁任何组织或个人使用本团队技术或工具进行非法活动。

2、在使用本文相关工具及技术进行测试时，您应确保该行为符合当地的法律法规，并且已经取得了足够的授权。如您仅需要测试技术或工具的可行性，建议请自行搭建靶机环境，请勿对非授权目标进行扫描。

3、如您在使用本工具的过程中存在任何非法行为，您需自行承担相应后果，我们将不承担任何法律及连带责任。  

4、本团队目前未发起任何对外公开培训项目和其他对外收费项目，严禁任何组织或个人使用本团队名义进行非法盈利。

5、本团队所有分享工具及技术文章，严禁不经过授权的公开分享。

如果发现上述禁止行为，我们将保留追究您法律责任的权利，并由您自身承担由禁止行为造成的任何后果。

  

END