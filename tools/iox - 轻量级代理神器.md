<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/q8PaHh1ELzkee4WI8gnPdQ)

前言
--

iox 是一款 Go 语言编写的开源端口转发 & 内网代理工具，它可以说是`ew`、`lcx`的升级版，可以实现流量转发，端口转发、`socks`隧道、`udp`流量转发、**流量加密**等功能。

特征
--

• 流量加密（可选）• 人性化 CLI 选项 • 逻辑优化 •UDP 流量转发 • 反向代理模式下的 TCP 多路复用

用法
--

`-l/--local`表示在本地端口上监听；`-r/--remote`表示连接到远程主机 • **注意：v0.4 之后 ***`**-l/--local**`**可以指定监听哪个 IP，如果只指定端口，默认为**`**0.0.0.0:PORT**`

```
-l 127.0.0.1:9999      -l *127.0.0.1:9999      # 127.0.0.1:9999
-l 9999                -l *9999                # 0.0.0.0:9999
`-l :9999` is also OK, but it's not recommended. Because `-l *:9999`(listen on 0.0.0.0:9999 with encryption) is ambiguous

```

工作模式
----

### 转发

监听`0.0.0.0:8888`和`0.0.0.0:9999`转发两个连接之间的流量

```
./iox fwd -l 8888 -l 9999

```

监听`0.0.0.0:8888`，将流量转发至`1.1.1.1:9999`

```
./iox fwd -l 8888 -r 1.1.1.1:9999

```

连接`1.1.1.1:8888`并`1.1.1.1:9999`转发 2 个连接之间的

```
./iox fwd -r 1.1.1.1:8888 -r 1.1.1.1:9999

```

### 代理

启动 Socks5 服务器`0.0.0.0:1080`

```
./iox proxy -l 1080

```

在被控主机上启动 Socks5 服务器，然后转发到互联网 VPS VPS 转发`0.0.0.0:9999`至`0.0.0.0:1080`必须成对使用，因为它包含一个简单的协议来控制连接回

```
./iox proxy -r 1.1.1.1:9999
./iox proxy -l 9999 -l 1080       // notice, the two port are in order
for ew:
./ew -s rcsocks -l 1080 -e 9999
./ew -s rssocks -d 1.1.1.1 -e 9999

```

然后连接内网主机

```
# proxychains.conf
# socks5://1.1.1.1:1080
$ proxychains rdesktop 192.168.0.100:3389

```

启用加密
----

例如我们将内网的 3389 端口转发到我们的 VPS 上

```
// be-controller host
./iox fwd -r 192.168.0.100:3389 -r *1.1.1.1:8888 -k 656565
// our VPS
./iox fwd -l *8888 -l 33890 -k 656565

```

被控主机和我们的 VPS:8888 之间的通信将被加密，预共享密钥为'AAA'，`iox`将使用它来生成种子密钥和随机数**（通常，随机数不应该被重复使用。但考虑到 iox 的加密只是为了绕过 IDS，为了不分配额外的空间，TCP 流加密将重用随机数）**，然后使用 Xchacha20 加密（在 v0.3 版本中用 Xchacha20 替换 AES-CTR） 因此，`*`应该成对使用

```
./iox fwd -l 1000 -r *127.0.0.1:1001 -k 000102
./iox fwd -l *1001 -r *127.0.0.1:1002 -k 000102
./iox fwd -l *1002 -r *127.0.0.1:1003 -k 000102
./iox proxy -l *1003 -k 000102
$ curl google.com -x socks5://127.0.0.1:1000

```

用作`iox`简单的 ShadowSocks

```
// ssserver
./iox proxy -l *9999 -k 000102
// sslocal
./iox fwd -l 1080 -r *VPS:9999 -k 000102

```

UDP 转发
------

只需添加 CLI 选项`-u`

```
./iox fwd -l 53 -r *127.0.0.1:8888 -k 000102 -u
./iox fwd -l *8888 -l *9999 -k 000102 -u
./iox fwd -r *127.0.0.1:9999 -r 8.8.8.8:53 -k 000102 -u

```

**注意：当你建立多级连接时，必须**`**Remote2Remote-UDP-mode**`**最后启动，也就是上面例子中的 3 号命令。**

工具下载地址
------

https://github.com/EddieIvan01/iox/releases/tag/v0.4[1]

### References

`[1]`: _https://github.com/EddieIvan01/iox/releases/tag/v0.4_  

> 免责声明：本项目提及的工具与技术仅可用于私人学习测试等合法场景中，任何不当利用该技术所造成的刑事、民事责任均与本项目作者及发布者无关。