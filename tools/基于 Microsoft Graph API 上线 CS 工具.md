<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/g7F-bN2anOqy0ICE4-xbIA)<table><tbody><tr><td width="557" valign="top" height="62"><p><strong>声明：</strong>该公众号分享的安全工具和项目均来源于网络，仅供安全研究与学习之用，如用于其他用途，由使用者承担全部法律及连带责任，与工具作者和本公众号无关。</p></td></tr></tbody></table>

现在只对常读和星标的公众号才展示大图推送，建议大家把 Hack 分享吧 “设为星标”，否则可能看不到了！  

SiegeCast 发了两篇关于 GraphStrike 工具的文章，建议可以先去看一下。

```
GraphStrike：使用Microsoft Graph API让信标流量消失
https://redsiege.com/blog/2024/01/graphstrike-release
GraphStrike：攻击性工具开发剖析
https://redsiege.com/blog/2024/01/graphstrike-developer

```

**工具介绍**

GraphStrike 是一套工具，使 Cobalt Strike 的 HTTPS Beacon 能够使用 Microsoft Graph API 进行 C2 通信。所有 Beacon 流量将通过攻击者的 SharePoint 站点中创建的两个文件进行传输，并且来自 Beacon 的所有通信都将路由到 https://graph.microsoft.com：  

```
https://learn.microsoft.com/en-us/graph/use-the-api

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ucmdZe62SRrCJ6fT0iacrAThqj4H8DqnHibtvurNxibBUp0AKIwBsR7sIX5IQJQ2nYMibSVAwVEYlDKhQ/640?wx_fmt=png&from=appmsg)

GraphStrike 包含一个配置程序，用于通过 Graph API 创建 Cobalt Strike HTTPS 所需的 Azure 资产：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ucmdZe62SRrCJ6fT0iacrAThdhK4QRBuzkiahOf6iaGnFSk5XaVwtkhA3rpC3ouKsSw560vnCAsSkOCQ/640?wx_fmt=png&from=appmsg)

**GraphStrike 不会在 Azure 中创建任何付费资产，因此使用 GraphStrike 或其配置程序不会产生额外费用。**

**为什么用 Microsoft Graph API？**

已发布关于利用 Microsoft Graph API 和其他 Microsoft 服务进行攻击活动的几种不同 APT 的威胁情报：  

```
https://www.volexity.com/blog/2021/08/17/north-korean-apt-inkysquid-infects-victims-using-browser-exploits/
https://malpedia.caad.fkie.fraunhofer.de/details/win.graphite
https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/flea-backdoor-microsoft-graph-apt15
https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry

```

威胁行为者继续利用合法服务来实现非法目的，利用像 graph.microsoft.com 这样的高声誉域进行 C2 通信是非常有效和理想的，但从时间和精力的角度来看，通常很复杂且令人望而却步。  

大多数 C2 框架不支持获取或轮换访问令牌的方法，这使得它们无法使用 Graph API。这可能会使红队难以复制这些技术，并剥夺防守者观察和开发此类活动签名的机会。

GraphStrike 致力于减轻这一负担，并提供可靠且可重复的流程来利用 Microsoft Graph API，同时保持 Cobalt Strike 用户体验的熟悉度和可靠性。

**GraphStrike 局限性**

这个工具存在以下限制：  

```
仅支持x64信标。
不支持分阶段信标。
GraphStrike仅与WinINet库兼容；不支持信标的新WinHTTP库选项。
不支持通过Beacon的右键菜单发出睡眠命令，睡眠信标改用命令行选项。
GraphStrike仅在Cobalt Strike的Linux实例上受支持，Windows支持当然是可以实现的，实际上只需更改Python文件和Aggressor脚本中的某些路径即可。

```

**下载地址**

**点击下方名片进入公众号**

**回复关键字【****240215****】获取**下载链接****

**知 识 星 球**

  

  

不做过多吹嘘和夸大宣传，至于分享的内容值不值，大家最好自己去看下，3 天不满意可随时申请退款...。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/79gZQNibQ6ufDmpcoyC5XibXzJB5W7U9Le20DCcRicTkgicmjHKDdvoXhvaQPuMpibvrt7OCWbRQokMTmHxMZ44WVWw/640?wx_fmt=jpeg&from=appmsg)

往期推荐工具

[Commando VM 3.0 红队渗透工具集](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247488119&idx=1&sn=46b3e67c8df3371ed89345483a28fd81&chksm=9036f4cfa7417dd99eb192885f0027d772137ad5aa5492b11e497e07c99094dd1224202510a0&scene=21#wechat_redirect)

[Hikvision 海康威视数据库账号解密工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247487695&idx=1&sn=abc501bf88daa8fc338d1d9e8ddafa2d&chksm=9036f677a7417f61ee0ddae07cf2e3158223c862ac7510dd5f35c70f84b4d700d64d0e19f273&scene=21#wechat_redirect)

[很强！Windows11 渗透测试工具包](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486427&idx=1&sn=4a229ee22d428a2c926f9250e6de6a56&chksm=9036ed63a741647536b01e6397483c6cee5eb4dd0ee551728c34e8d0b1a73cfdc64c6c69922b&scene=21#wechat_redirect)

[N！9 个 OA 高危漏洞利用工具 v1.1.6](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486468&idx=1&sn=67e6dc1a332769490a2b3062b6c7a909&chksm=9036eabca74163aa9572b4baee14ad2bc1b16c990c64c9e865b8319a31bc23b0b021a03d4b51&scene=21#wechat_redirect)

[v1.1！最新版 Weblogic 漏洞利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486498&idx=1&sn=2c0458c4a1a51518d888dd553d86beed&chksm=9036ea9aa741638c0bbd6cb8d66f197df3d929960f3aa712960c3a016fd9c36c953051b723d8&scene=21#wechat_redirect)

[防溯源！无 VPS 也可用的 C2 小工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486150&idx=1&sn=f5b71fa5e38dd67b558350987198a4fd&chksm=9036ec7ea7416568728ffe8ba9cdf76c51480bd1c5da2e921cdca2e3f4d5222b504173781599&scene=21#wechat_redirect)

[Q！两个免费的数据泄露查询平台](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486138&idx=1&sn=9ba3b3d72c6f8199be9732ea0fe24995&chksm=9036ec02a7416514c46b532af361cbf9073351710013504835751a583a1b54e350f040d1d0a0&scene=21#wechat_redirect)

[](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483907&idx=1&sn=4e7cf5de0472f6685edb64a598e6aff8&chksm=9036e4bba7416dad5aa253462a84d0c47fdb4e89914c70bd5a3fbbd8b4ef05572a4e7e702faa&scene=21#wechat_redirect)[GodPotato！新版土豆提权利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486017&idx=1&sn=63dec820664e5abc687ebbeb389ee3ba&chksm=9036ecf9a74165ef8a9bea29dff6ab7194d53f584cc69f6713ef10e11c0067d6d45ba36bda6d&scene=21#wechat_redirect)

[牛 B！一个国产的安卓渗透工具箱](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247485816&idx=1&sn=55d4450fa7dc6d8ec0ec8ed6a7d8c50d&chksm=9036efc0a74166d638ac84732d5e09caf86956561c6b2f9973f5e91429af0f8c68efcbc3b0e1&scene=21#wechat_redirect)