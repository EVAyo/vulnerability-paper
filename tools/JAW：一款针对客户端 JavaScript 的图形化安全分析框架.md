<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/CThq5Rmk-4Qn0XQcUOMQRA)

![](https://mmbiz.qpic.cn/mmbiz_gif/qq5rfBadR38jUokdlWSNlAjmEsO1rzv3srXShFRuTKBGDwkj4gvYy34iajd6zQiaKl77Wsy9mjC0xBCRg0YgDIWg/640?wx_fmt=gif)

**关于 JAW**

  

JAW 是一款针对客户端 JavaScript 的图形化安全分析框架，该工具基于 esprima 解析器和 EsTree SpiderMonkey Spec 实现其功能，广大研究人员可以使用该工具分析 Web 应用程序和基于 JavaScript 的客户端程序的安全性。

![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR38eHG22l0bLIJPVr6cszB4rrlKOjQPLiah4Wo6a06T3ZfRnibmx3cZh3zVs82yqCMhYdrJraZp45mBg/640?wx_fmt=png&from=appmsg)

**工具特性**

  

> 1、动态可扩展的框架，支持分析 JavaScript 程序以检测客户端漏洞；
> 
> 2、使用基于 Chromium 的爬虫程序，利用 DevTools 协议和浏览器扩展 API 增强其功能；
> 
> 3、支持收集网页、脚本、事件、DOM 快照、网络消息、Web 存储和 Cookie 数据；
> 
> 4、实现了 JavaScript 混合代码属性图 (HPG) ；
> 
> 5、支持交互式检测或自动检测不安全的程序行为；
> 
> 6、独立的内置查询用于检测客户端 CSRF、请求劫持和 DOM Clobbering 漏洞；
> 
> 7、设计并执行定制的安全相关程序分析，包括预定义 JavaScript 源和接收器之间的数据流分析、控制流和可达性分析、利用 DOM 快照解析 DOM 查询选择器、通过抽象语法树 (AST) 进行模式匹配等；

**工具架构**

  

![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR38eHG22l0bLIJPVr6cszB4rtAH6tibiagtia3wRorPHfIxKc6j7jLXLWQSp6zc5yEsW4LHO5ib4CAytRg/640?wx_fmt=png&from=appmsg)

**工具要求**

  

> 1、最新版本的 NPM 包管理器（Node.JS）;
> 
> 2、最新稳定版 Python 3.x；
> 
> 3、pip 包管理器；

**工具安装**

  

广大研究人员可以直接使用下列命令将该项目源码克隆至本地：

```
git clone https://github.com/SoheilKhodayari/JAW.git
```

然后切换到项目目录中，执行工具安装脚本完成依赖组件的安装：

**运行管道**

  

我们可以通过以下方式在命令行终端中运行管道实例：

```
$ python3 -m run_pipeline --conf=config.yaml
```

### **命令行参数**

**工具使用**

  

**下列命令可以构建一个 JavaScript 客户端属性图并执行 Cypher 查询：**

```
$ python3 -m analyses.example.example_analysis --input=$(pwd)/data/test_program/test.js

```

**下列命令可以执行 Web 爬虫：**

```
$ cd crawler
$ node crawler.js --seedurl=https://google.com --maxurls=100 --browser=chrome --headless=true

```

**下列命令可以启动 Web 爬虫并执行动态污点分析：**

```
$ cd crawler
$ node crawler-taint.js --seedurl=https://google.com --maxurls=100 --headless=true --foxhoundpath=<optional-foxhound-executable-path>

```

**下列命令可以将一个 HPG 导入到一个 Neo4j 图形化数据库中：**

```
$ python3 -m hpg_neo4j.hpg_import --rpath=<path-to-the-folder-of-the-csv-files> --id=<xyz> --nodes=<nodes.csv> --edges=<rels.csv>

```

**下列命令可以针对输出数据（hpg_crawler）创建一个混合属性图，并导入至本地 Neo4j 实例：**

```
$ python3 -m engine.api <path> --js=<program.js> --import=<bool> --hybrid=<bool> --reqs=<requests.out> --evts=<events.out> --cookies=<cookies.pkl> --html=<html_snapshot.html>

```

**使用 Cypher 查询执行安全分析：**

```
$ python3 -m analyses.example.example_query_cypher
```

**漏洞检测**

  

首先，我们需要在 config.yaml 文件中针对漏洞类型启用分析组件：

然后使用配置文件运行管道：

```
$ python3 -m run_pipeline --conf=config.yaml
```

我们还可以在管道中运行多个实例：

分析输出结果如下：

**许可证协议**

  

本项目的开发与发布遵循 AGPL-3.0 开源许可协议。

**项目地址**

  

**JAW：**

https://github.com/SoheilKhodayari/JAW

【FreeBuf 粉丝交流群招新啦！

在这里，拓宽网安边界  

甲方安全建设干货；

乙方最新技术理念；

全球最新的网络安全资讯；

群内不定期开启各种抽奖活动；

FreeBuf 盲盒、大象公仔......

扫码添加小蜜蜂微信回复「加群」，申请加入群聊】

![](https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ich6ibqlfxbwaJlDyErKpzvETedBHPS9tGHfSKMCEZcuGq1U1mylY7pCEvJD9w60pWp7NzDjmM2BlQ/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

![](https://mmbiz.qpic.cn/mmbiz_png/oQ6bDiaGhdyodyXHMOVT6w8DobNKYuiaE7OzFMbpar0icHmzxjMvI2ACxFql4Wbu2CfOZeadq1WicJbib6FqTyxEx6Q/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR3icEEJemUSFlfufMicpZeRJZJ61icYlLmBLDpdYEZ7nIzpGovpHjtxITB6ibiaC3R5hoibVkQsVLQfdK57w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

> https://chromedevtools.github.io/devtools-protocol/
> 
> https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions
> 
> https://neo4j.com/developer/cypher/
> 
> https://www.facebook.com/notes/facebook-bug-bounty/client-side-csrf/2056804174333798/
> 
> https://domclob.xyz/

![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR3icEEJemUSFlfufMicpZeRJZJ7JfyOicficFrgrD4BHnIMtgCpBbsSUBsQ0N7pHC7YpU8BrZWWwMMghoQ/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)  

[![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR38qX1GiaOXWQymWcSC7VwuSAr2LZNBCHs1V4kPwpSoruHH6wAwRQSXqMAoZNib3qJfKDQTbZEp7Z6qg/640?wx_fmt=png&from=appmsg)](http://mp.weixin.qq.com/s?__biz=Mzg2MTAwNzg1Ng==&mid=2247494632&idx=1&sn=39d15121b9d4a665a970768a9b377194&chksm=ce1f1177f9689861d973b98e71492ef76d1894ad7e593b40c27fbdbee4417d4d1a1c24b36621&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR39ckx0sicrgribVw5qeZgSUvGAbrkJwVibKeINtxWQDic2HoJpvY5WBKTtgMujQrnpAXibSzIILBN2rp7Q/640?wx_fmt=png&from=appmsg)](http://mp.weixin.qq.com/s?__biz=Mzg2MTAwNzg1Ng==&mid=2247494601&idx=1&sn=d02355354ca064cfe25a770b4a650dc8&chksm=ce1f1156f9689840013d9eee16215311ff387b3a0f68cec30ee999a7a00875056790b11052d9&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ibPaXXzibTQWIAW7icz3iaAesgCSwDfV7j9RK9AfAzdwfcyWLeTung68NXFvrib5NHPcgjN55aU0Blahw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)](https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&mid=2651253272&idx=1&sn=82468d927062b7427e3ca8a912cb2dc7&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_gif/qq5rfBadR3icF8RMnJbsqatMibR6OicVrUDaz0fyxNtBDpPlLfibJZILzHQcwaKkb4ia57xAShIJfQ54HjOG1oPXBew/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp)