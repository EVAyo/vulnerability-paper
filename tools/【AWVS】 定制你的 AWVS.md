> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/JraNZwcTICl3TsomsA2vrA)<table><tbody><tr><td width="558" valign="top">免责声明：请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责。</td></tr></tbody></table>

**0x01 前言**  

AWVS 作为一款优秀的扫描软件，一直是安全从业人员必不可少的工具之一。依稀记得在 log4j2 爆出来时，waf 对其封堵规则很简单，而 AWVS 第一时间在更新版本使用了绕过 POC，可能过了好一段时间，才有人提到这个绕过的 POC。

```
原版POC  ${jndi:ldap://}
AWVS的绕过  ${j${::-n}di:dns${::-:}${::-/}${::-/}

```

这篇文章就是解析 AWVS 的扫描规则和逻辑，这里感谢脚本作者 hack2012 和 trick 提供者 Natto97

```
https://github.com/Natto97
https://github.com/hack2012/awvs-decode

```

**0x02 脚本引擎解密**

通过 https://github.com/testanull/awvs-decode 我们成功解密了 AWVS 的脚本文件。

```
python3 awvs-decode.py

```

我们以弱口令作为修改的示例，找到弱口令的 js 逻辑代码。

```
awvs_script_15.7.230603143\httpdata\html_auth_weak_creds.js

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/uFvaFAPEZoRAjibESM1rLBxkqJRLjZ3MSC5ibHKqiaoffh4TfE3g9Elsaw3CdG9F0SkJ1DP6VcObYPTJWPMicJictKA/640?wx_fmt=png&from=appmsg)

可以看到竟然没有 123456，可以将定义的密码字典修改成国内常用的字典。这里随便设置一些  

```
const usernames = ["admin","test","root","system"];
const passwords =
["zzzzzz","zxzxzx","zxczxc","zxcvbnm123","zxcvbnm","zxcvbn","zxc123
456","zxc123","zing","zinch","zhangwei","zhang123","zabbix","z123456789","z123456","
yugioh","yellow","yankees","yankee","yangyang","yamaha","xxxxxxxx","xxxxxx","xiaoxia
o","xavier","x4ivygA51F","www123456","WWW@HUAWEI","ww6082516","woshishui","wojiushiw
o","wodima123","wodemima","wocaonima","woaiwojia","woainima","woaini521","woaini520"
,"woaini1314520","woaini1314","woaini123"];

```

然后重新打包

```
Python3 awvs-repack.py [dir]

```

**0x03 扫描验证**

生成的 bin 文件拖到 awvs 的安装路径中，我们重新创建一个扫描任务。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/uFvaFAPEZoRAjibESM1rLBxkqJRLjZ3MSUWDHOU9T7ndMzXlCqrdNaMfVy6WHOicm6QOtHdGrBJnSSXm33Euxwag/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/uFvaFAPEZoRAjibESM1rLBxkqJRLjZ3MSOMFmf4LcGm7VPSrTGQKJyQ9VFCG5em48LgBoOIIgsylu3OnRFFCVWQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/uFvaFAPEZoRAjibESM1rLBxkqJRLjZ3MSPUVSDl9nHJzwr3raFQ8KxUH6okcNpPlP0yGQibtxsNocwqlHWvaibAHQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/uFvaFAPEZoRAjibESM1rLBxkqJRLjZ3MSicxpEyvA3IJSmFeuKVpqZBt9SMDXRurwKht9IMvSW7HCGjntiaCJxEQg/640?wx_fmt=png&from=appmsg)

可以看到我们扫描到了自己设置的强口令，至此 AWVS 的扫描规则修改成功。