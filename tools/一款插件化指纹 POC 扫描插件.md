<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/E0zZRmJ3LZgUaAjZaGLYzA)<table><tbody><tr><td width="557" valign="top" height="62"><p><strong>声明：</strong>该公众号分享的安全工具和项目均来源于网络，仅供安全研究与学习之用，如用于其他用途，由使用者承担全部法律及连带责任，与工具作者和本公众号无关。</p></td></tr></tbody></table>

现在只对常读和星标的公众号才展示大图推送，建议大家把 Hack 分享吧 “设为星标”，否则可能看不到了！  

**工具简介**

FrameScan 插件是一款插件化的指纹 POC 扫描插件。  

**工具使用**

1.  使用 Burpsuit 或者双击 jar 包。  
    
2.  启动后，请确保本地 127.0.0.1:23333 端口开放。如未开放，请手动启动 rpc_server 服务。Yaml Poc 、Python Poc 依赖此组件。编译好的 server 已放到根目录。如不适用，请下载 GRPC 文件夹，使用 python rpc_server.py 启动 rpc 服务。
    

**漏洞探测**

burp 发现的指纹及 poc 扫描结果会显示在此处。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud2hxk7p6OU9ULW3PskehEgNtOQQxibKZTcMjGYzxm3ibjsicO7QiaBjO4D6wEZQQbibOibxWD3cYXkgahg/640?wx_fmt=png&from=appmsg)

**漏洞 POC**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud2hxk7p6OU9ULW3PskehEgw83K7UVAQbfE8lenbWHy9RFUx2lFEXS0PENTGcGeapkibYnpicKLPCaQ/640?wx_fmt=png&from=appmsg)

**此模块支持 4 种 POC 类型如下：**

### **简单 HTTP 请求**

该 POC 会替换请求包中的字段，然后根据 expression 匹配规则进行漏洞探测。

```
expression:
  match_method: Contain
  status_code: 200
  scope: response body
  match_value: openapi
requests:
  method: GET
  url: /v3/api-docs
  body: ''

```

### **高级 HTTP 请求**

该模块为源 HTTP 请求包，支持以下变量进行替换。

```
完整URL：http://127.0.0.1:8080/aa/bb.txt

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud2hxk7p6OU9ULW3PskehEgzzygpgKfdTdHmmfc32EQg8gJJqrYKKibY6IZu65Gt8Bfd3PnogAA3KQ/640?wx_fmt=png&from=appmsg)

```
requests_raw: |
  GET / HTTP/1.1
  Host: \{\{Host\}\}
  Pragma: no-cache
  Cache-Control: no-cache
  User-Agent: \{\{Random_UserAgent\}\}
  Accept-Encoding: gzip, deflate
  Accept-Language: zh-CN,zh;q=0.9
  Connection: close
  Cookie: \{\{Cookie\}\}
  a=1\{\{Body\}\}
expression:
  match_method: Contain
  status_code: 22
  scope: response
  match_value: '22'

```

### **Yaml Poc**

该 POC 格式为 FrameScan_Yaml 的格式，插件可相互调用。请参考 FrameScan_Yaml 插件编写，基础插件如下：

```
#插件名称
name: poc-yaml-example-com
# 脚本部分
transport: http
rules:
  r1:
    request:
      method: GET
      path: /
      body: addd $num
      headers:
        Content-Type: application/json
    expression: |
      response.status_code==200 && operator.contains(response.text,'html')
    output:
      serial: re.search('\w+',response.text).group()
      html: re.search('refresh',response.text).group()
expression: r1() && r2()
#信息部分
detail:
  author: qianxiao996
  vuln_id: cve-2019-2222
  description: '111'
  group: 敏感信息泄露
  category: ALL
  links:
    - http://example.com
#全局变量
set:
  a: 1
  num: randint(1000, 2000)

```

### **Python Poc**

该 POC 格式为 FrameScan 的格式，插件可相互调用。请参考 FrameScan 插件编写，插件模板如下：

```
# -*- coding: UTF-8 -*-
#!/usr/bin/python
import requests
def vuln_info():
    info={
        'vuln_name': 'POC测试漏洞',  #漏洞名称
        'vuln_referer':'http://baidu.com',  #漏洞来源
        'vuln_author':'qianxiao996',  #插件作者
        'cms_name':'test',#cms_name需要和上级目录保持一致。扫描器自动添加会调用。GUI版本不会调用
        'vuln_description':'''漏洞描述''',
        'vuln_identifier':'''漏洞编号。''',
        'vuln_class':'漏洞分类',#如：信息泄漏、远程命令执行、任意文件上传、SQL注入、XML注入、任意文件读取、本地文件包含、认证绕过/未认证、弱口令、目录遍历、其他、反序列化漏洞、OGNL表达式注入、SSRF、后门、任意文件下载、鉴权绕过、暴力破解、命令注入、路径泄露、XSS、远程文件包含、CSRF、任意文件包含、代码注入、任意文件写入、密码硬编码、文件包含、任意用户注册、缓冲区溢出、用户枚举漏洞、任意文件删除、任意页面上传、管理权限等
        'vuln_solution':'''修复建议。''',
        'FofaQuery_type':'socket', #socket、http
        'FofaQuery_link':'/', #此处的路径会加在url拼接访问，进行FofaQuery的条件匹配 此处为all为全部页面都检测
        'FofaQuery_rule':'title="百度"',#header="JSESSIONID" || body="Struts Problem Report" || body="There is no Action mapped for namespace" || body="No result defined for action and result input" || header="Servlet" || header="JBoss",port="60001"
        #header', 'body', 'title', 'banner','port','banner','service','protocol','server'
        'ispoc':1, #是否有poc  1为有 0为无
        'isexp':1  #是否有exp   1为有 0为无
    }
    return info
# url：url  hostname：主机地址  port：端口  scheme：服务  heads：http自定义头信息
def do_poc(url,hostname,port,scheme,heads={}):
    try:
    # 返回参数
    #Result返回是否存在，
    #Result_Info为返回的信息，可以为Paylaod 
    #Debug debug信息 默认不会显示，勾选显示调试信息会输出此结果
    #Error_Info无论何时都会输出
        result = {"Result":True,"Result_Info":"payload","Debug_Info":"","Error_Info":""}
        result['Result_Info']= 'payload'
        result['Debug_Info']  = 'ddd'
        result['Error_Info'] = "dsaaaaaaaa"
    except Exception as e:
        result['Error_Info'] = str(e)+str(e.__traceback__.tb_lineno)+'行'
    return result
    # {
    #     "type":"cmd",  #cmd,shell,uploadfile
    #     "command":"whoami",  #cmd命令
    #     "reverse_ip":"127.0.0.1", #反弹shell的ip
    #     "reverse_port":"8888", #反弹shell的端口
    #     "filename":"conf.php", #写入文件的名字
    #     "filename_contents":"shell内容", #shell文件内容
    # }
# url:url   hostname：主机地址  port：端口  scheme：服务  heads:自定义请求头

```

**插件 POC**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud2hxk7p6OU9ULW3PskehEgiccnf1OXiaYTWqTtVweichADgJbjpH8apGCOqw8P6dEyVgYxKL0GTPAcw/640?wx_fmt=png&from=appmsg)

指纹 POC 编辑

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud2hxk7p6OU9ULW3PskehEg2XzCjTeKgJYZ8pGQG3rxRTRibp1ktGPu0bUebPDQ15WtH2HXHUx23Rw/640?wx_fmt=png&from=appmsg)

**插件设置**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ud2hxk7p6OU9ULW3PskehEgbMiagMAiaNzumJICRDHrCFFhvmiaeRFCY2gYM93hZYJxDHhIpibasfIicIA/640?wx_fmt=png&from=appmsg)

*   **启用漏洞 POC：**指纹匹配后，只有在此组的漏洞 POC 才会进行扫。
    
*   **跳过指纹 POC：**不进行指纹扫描。直接进行扫描的 POC。
    

**下载地址**

**点击下方名片进入公众号**

**回复关键字【****240830****】获取******下载链接****

**知 识 星 球**

  

  

仅前 1-400 名: 99¥，400-600 名: 128¥，600-800 名: 148¥，800-1000 + 名: 168¥，所剩不多了...！

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ucYBZicS8b1LEFIxIXPEXBZ6WC4bxVcxhIxewI1MZtcLzicTsLQ7yMibeSwR1JgoqH7rv7aw9ll0sUWg/640?wx_fmt=png&from=appmsg)

往期推荐工具

[Commando VM 3.0 红队渗透工具集](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247488119&idx=1&sn=46b3e67c8df3371ed89345483a28fd81&chksm=9036f4cfa7417dd99eb192885f0027d772137ad5aa5492b11e497e07c99094dd1224202510a0&scene=21#wechat_redirect)

[Hikvision 海康威视数据库账号解密工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247487695&idx=1&sn=abc501bf88daa8fc338d1d9e8ddafa2d&chksm=9036f677a7417f61ee0ddae07cf2e3158223c862ac7510dd5f35c70f84b4d700d64d0e19f273&scene=21#wechat_redirect)

[很强！Windows11 渗透测试工具包](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486427&idx=1&sn=4a229ee22d428a2c926f9250e6de6a56&chksm=9036ed63a741647536b01e6397483c6cee5eb4dd0ee551728c34e8d0b1a73cfdc64c6c69922b&scene=21#wechat_redirect)

[N！9 个 OA 高危漏洞利用工具 v1.1.6](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486468&idx=1&sn=67e6dc1a332769490a2b3062b6c7a909&chksm=9036eabca74163aa9572b4baee14ad2bc1b16c990c64c9e865b8319a31bc23b0b021a03d4b51&scene=21#wechat_redirect)

[v1.1！最新版 Weblogic 漏洞利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486498&idx=1&sn=2c0458c4a1a51518d888dd553d86beed&chksm=9036ea9aa741638c0bbd6cb8d66f197df3d929960f3aa712960c3a016fd9c36c953051b723d8&scene=21#wechat_redirect)

[防溯源！无 VPS 也可用的 C2 小工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486150&idx=1&sn=f5b71fa5e38dd67b558350987198a4fd&chksm=9036ec7ea7416568728ffe8ba9cdf76c51480bd1c5da2e921cdca2e3f4d5222b504173781599&scene=21#wechat_redirect)

[Q！两个免费的数据泄露查询平台](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486138&idx=1&sn=9ba3b3d72c6f8199be9732ea0fe24995&chksm=9036ec02a7416514c46b532af361cbf9073351710013504835751a583a1b54e350f040d1d0a0&scene=21#wechat_redirect)

[](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483907&idx=1&sn=4e7cf5de0472f6685edb64a598e6aff8&chksm=9036e4bba7416dad5aa253462a84d0c47fdb4e89914c70bd5a3fbbd8b4ef05572a4e7e702faa&scene=21#wechat_redirect)[GodPotato！新版土豆提权利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486017&idx=1&sn=63dec820664e5abc687ebbeb389ee3ba&chksm=9036ecf9a74165ef8a9bea29dff6ab7194d53f584cc69f6713ef10e11c0067d6d45ba36bda6d&scene=21#wechat_redirect)

[牛 B！一个国产的安卓渗透工具箱](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247485816&idx=1&sn=55d4450fa7dc6d8ec0ec8ed6a7d8c50d&chksm=9036efc0a74166d638ac84732d5e09caf86956561c6b2f9973f5e91429af0f8c68efcbc3b0e1&scene=21#wechat_redirect)