<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/LSE5102DwATl7NHowGk3dw)

**插件介绍**

Galaxy 是一款在渗透测试中针对一些网站对报文加密的 Burp 解密插件，目标是让你测试加密报文像明文一样简单，先看一张效果展示图：  

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/79gZQNibQ6ueUyLic60XIVzPlJ1iaY9VttZEkHicDqhF6tiaaRQjCQhSHVk2AGYZRiaaiatib93Y8HW2RMr5YzMInf1QYw/640?wx_fmt=gif&from=appmsg)

**当前安全测试人员面临的问题**

*   越来越多的网站对 HTTP 请求 & 响应做了加密 / 加签，这导致想要修改明文请求 / 响应非常不方便
    
*   已有插件在面对加密 & 加签同时存在、加密算法组合等情况时不够用，自行编写 hook 脚本调通算法难度大、效率低
    

**解决方案**

目前其它插件的做法是在用户选择繁琐的页面配置后，用被加密的数据调用对应的解密函数完成解密，这样只能满足既定请求。而这次我们介绍的插件，它的思路是将请求 / 响应对象交给你，通过少量代码修改请求 / 响应对象，这样无论算法组合有多复杂都可以自动解密。  

### **Galaxy 启用后的效果**

*   启用成功后，后续代理的所有请求和响应自动解密
    
*   已解密请求转到 Repeater 后 Send，得到的响应也会被解密
    
*   Intruder、Scanner 等模块同样支持
    

### **特点 & 优势**

*   简单高效：不需要启动多余的本地服务。
    
*   上手容易：通用算法及常见加密逻辑已内置，基本能做到开箱即用。
    
*   支持面广：如加密算法组合、自定义算法、动态密钥等均可以支持。
    
*   强灵活性：可以使用 python、js、Java、grpc 多种方式实现 hook 脚本以满足需求。
    

### **支持的算法**

基本市面上常见的都支持。

```
aes-ecb
aes-cbc
aes-gcm
des-ecb...
3des-ecb...
rsa
sm2
sm3
sm4
md5...
sha1...
tea...
...

```

**插件使用**

我们以该项目提供的靶场的 aes-cbc 来测试下  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueUyLic60XIVzPlJ1iaY9VttZyZyKLLYu0ueHZ8ZNt52EiandmfBRDeaMKSbYDSExfxPicLGsS9fAcoXw/640?wx_fmt=png&from=appmsg)

根据前端代码，这里的流量加解密逻辑是：

1.  使用 **aes-cbc** 对原始的请求 json 加密
    
2.  将加密后的数据 base64，并生成一个新的 json 放入 data 中
    
3.  发送请求，得到响应
    
4.  获取响应 json 中的 data 字段，用 **aes-cbc** 解密后进行后续业务逻辑
    

使用 Burp 抓包，可以看到请求和响应都被加密

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueUyLic60XIVzPlJ1iaY9VttZKfkIsPjNicn8Q9cjXaBjxnaJNIZDDbia9KpJAgPmLuGuDpmdj4lwOk7g/640?wx_fmt=png&from=appmsg)

下载并加载插件后，会看到这样的界面，即表示加载成功

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueUyLic60XIVzPlJ1iaY9VttZtwk6SxGsfax3lGJtcvibIT6jrz3yygYjtuhrL7peBKiaawn4DnXPq8Cg/640?wx_fmt=png&from=appmsg)

点击 **Start** 启动与靶场对应的 hook 脚本，再次请求，可以发现流量被自动解密

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueUyLic60XIVzPlJ1iaY9VttZribFZbmJf8libITciaXMhibA4eicPwfYoJdLOFz3bbicIx9gg65GS1Jia5P7w/640?wx_fmt=png&from=appmsg)

并且右键将已解密的请求发送到 **Repeater**，点击 Send 获取的响应也是解密后的，这意味着在 **Intruder** 模块可以直接进行暴力破解

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueUyLic60XIVzPlJ1iaY9VttZviaS3pQghJzYJ0yezmcdrR0cpwCekdvKqibuvHjqOPEeT7icjCXfW03ibA/640?wx_fmt=png&from=appmsg)

整个解密过程串起来如下

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/79gZQNibQ6ueUyLic60XIVzPlJ1iaY9VttZEkHicDqhF6tiaaRQjCQhSHVk2AGYZRiaaiatib93Y8HW2RMr5YzMInf1QYw/640?wx_fmt=gif&from=appmsg)

作者已搭建好对应的靶场供测试，其中包括更加复杂的场景，读者可以自行测试。

**下载地址**

**点击下方名片进入公众号**

**回复关键字【****240816****】获取****下载链接**

**知 识 星 球**

  

  

仅前 1-400 名: 99¥，400-600 名: 128¥，600-800 名: 148¥，800-1000 + 名: 168¥，所剩不多了...！

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ucYBZicS8b1LEFIxIXPEXBZ6WC4bxVcxhIxewI1MZtcLzicTsLQ7yMibeSwR1JgoqH7rv7aw9ll0sUWg/640?wx_fmt=png&from=appmsg)

往期推荐工具

[Commando VM 3.0 红队渗透工具集](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247488119&idx=1&sn=46b3e67c8df3371ed89345483a28fd81&chksm=9036f4cfa7417dd99eb192885f0027d772137ad5aa5492b11e497e07c99094dd1224202510a0&scene=21#wechat_redirect)

[Hikvision 海康威视数据库账号解密工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247487695&idx=1&sn=abc501bf88daa8fc338d1d9e8ddafa2d&chksm=9036f677a7417f61ee0ddae07cf2e3158223c862ac7510dd5f35c70f84b4d700d64d0e19f273&scene=21#wechat_redirect)

[很强！Windows11 渗透测试工具包](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486427&idx=1&sn=4a229ee22d428a2c926f9250e6de6a56&chksm=9036ed63a741647536b01e6397483c6cee5eb4dd0ee551728c34e8d0b1a73cfdc64c6c69922b&scene=21#wechat_redirect)

[N！9 个 OA 高危漏洞利用工具 v1.1.6](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486468&idx=1&sn=67e6dc1a332769490a2b3062b6c7a909&chksm=9036eabca74163aa9572b4baee14ad2bc1b16c990c64c9e865b8319a31bc23b0b021a03d4b51&scene=21#wechat_redirect)

[v1.1！最新版 Weblogic 漏洞利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486498&idx=1&sn=2c0458c4a1a51518d888dd553d86beed&chksm=9036ea9aa741638c0bbd6cb8d66f197df3d929960f3aa712960c3a016fd9c36c953051b723d8&scene=21#wechat_redirect)

[防溯源！无 VPS 也可用的 C2 小工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486150&idx=1&sn=f5b71fa5e38dd67b558350987198a4fd&chksm=9036ec7ea7416568728ffe8ba9cdf76c51480bd1c5da2e921cdca2e3f4d5222b504173781599&scene=21#wechat_redirect)

[Q！两个免费的数据泄露查询平台](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486138&idx=1&sn=9ba3b3d72c6f8199be9732ea0fe24995&chksm=9036ec02a7416514c46b532af361cbf9073351710013504835751a583a1b54e350f040d1d0a0&scene=21#wechat_redirect)

[](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483907&idx=1&sn=4e7cf5de0472f6685edb64a598e6aff8&chksm=9036e4bba7416dad5aa253462a84d0c47fdb4e89914c70bd5a3fbbd8b4ef05572a4e7e702faa&scene=21#wechat_redirect)[GodPotato！新版土豆提权利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247486017&idx=1&sn=63dec820664e5abc687ebbeb389ee3ba&chksm=9036ecf9a74165ef8a9bea29dff6ab7194d53f584cc69f6713ef10e11c0067d6d45ba36bda6d&scene=21#wechat_redirect)

[牛 B！一个国产的安卓渗透工具箱](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247485816&idx=1&sn=55d4450fa7dc6d8ec0ec8ed6a7d8c50d&chksm=9036efc0a74166d638ac84732d5e09caf86956561c6b2f9973f5e91429af0f8c68efcbc3b0e1&scene=21#wechat_redirect)