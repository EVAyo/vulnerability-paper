<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/QQHiZTHa-6J4MoPE-YFbrg)

**前言**

在众多的地区性攻防演练中，SQL Server 数据库堆叠注入仍有较高的爆洞频率，但因为一些常见的演练场景限制，如不出网、低权限、站库分离、终端防护、上线困难、权限维持繁琐等，仅一个 --os-shell 已经难满足我们的需求。  

**工具介绍**

SqlmapXPlus 是 "赛博大作战" 号主 @coolcat 师傅基于 sqlmap 二开的一个数据库漏洞利用工具，参考各种解决方法，增加 MSSQL 数据库注入的利用方式。  

**目前已完成部分二开：**包括 ole、xpcmdshell 两种文件上传、内存马上传、clr 安装功能，能够实现 mssql 注入场景下的自动化注入内存马、自动化提权、自动化添加后门用户、自动化远程文件下载、自动化 shellcode 加载功能。

该工具的详细介绍、使用方法以及应用场景可以看 @coolcat 师傅公众号的这篇文章：[数据库注入工具 SqlmapXPlus ！增强 MSSQL 后渗透利用方式！](http://mp.weixin.qq.com/s?__biz=Mzk0NjYyNDI0Ng==&mid=2247483828&idx=1&sn=5735814837f8e58376187668714e4605&chksm=c302022df4758b3ba5e4368c3f8be2ac5183ebbebc247e318380b9e14ae341d717e59102e448&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/LYy9xnADcdiaJ3Y2dq4CXkqFpQZ3mlURgqxicqVJibZibyBx3QYTWnJpo06D2YhJpegPsZYeKy1JYbicrVicCCicPzxjA/640?wx_fmt=jpeg)

**新增功能：**

```
#  开启 clr 功能
--enable-clr
#  关闭 clr 功能
--disable-clr
# 通过 xp_cmdshell 实现的文件上传功能 ，作用为将本地文件上传到远程服务器
--xp-upload localfile remotefile
# 通过 ole 实现的文件上传功能 ，作用为将本地文件上传到远程服务器
--ole-upload
#  通过 xp_cmdshell 实现的clr安装方式
--install-clr1
#  通过 ole 实现的clr安装方式
--install-clr2
#  进入clr-shell命令交互模式
--clr-shell
#  通过 xp_cmdshell 实现的HttpListener内存马上传方式
--sharpshell-upload1
#  通过 ole 实现的HttpListener内存马上传方式
--sharpshell-upload2

```

**clr 相关功能：**

```
clr_rdp # 开启RDP
clr_adduser # 添加系统用户
clr_exec # 命令执行
clr_efspotato # 提权模块
clr_memshell # 内存马
clr_download # 远程文件下载
clr_rm # 指定文件删除
clr_cd # 切换目录
clr_ping # ping
clr_scloader # 直接shellcode加载
clr_scloader1 # 落地的shellcode加载
clr_scloader2 # 落地的shellcode加载

```

  

后台回复：**240314**，获取工具

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/LYy9xnADcdhic61NkXCWKufScrUrmmsG8tztWD8fDRiatPUaljxxpKc1PpnYNFjPibU5FwJmcuO4mZoQg5aXsAcog/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&wx_co=1)  

声明：该公众号大部分文章来自作者日常学习笔记，也有部分文章是经过作者授权和其他公众号白名单转载，未经授权，严禁转载，如需转载，联系开白名单。

请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与本公众号无关。

✦

✦