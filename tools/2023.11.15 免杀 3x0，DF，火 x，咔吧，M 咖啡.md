<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Q4P8lrHlvv20V9xjVzFkrw)

        这是一个基于纯汇编语言绕过动 / 静态检测的 Shellcode Loader，也可以直接当做免杀使用，使用了 2048 位秘钥的 RSA 进行防止逆向，可以有效避免被溯源，当然，需要携带秘钥作为启动参数

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB3xkjOwibw0svpCLOmTZuTWUZJ0pR2aictib0OZYrtc2xfTr5eJ3GfhNeTYTKgcuG10c55CnJPlQiaWgg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB3xkjOwibw0svpCLOmTZuTWUXVs19vVb9Pl8Ht4u2hLc44Bu2BO7gPL2vJ65ia1b3mP5luQGMEYwJoA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB3xkjOwibw0svpCLOmTZuTWURwl3lIDUmqLRg6qeUJLvRm96X7Hf1PyKxtLzQJr0fibxhicexEqXN83Q/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB3xkjOwibw0svpCLOmTZuTWUOyostgWtZcFe6icibyL5uibVazeokOibc3RmlBUbiatsm1js6OIdicNYUQVg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB3xkjOwibw0svpCLOmTZuTWUUQGmyq68h0CK107Fo1nSoQXYJEysQh8dO3Y5T82H0c6hF0KuPwV4Cg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB3xkjOwibw0svpCLOmTZuTWUBrfHOpvqyT9icKDzEFlicC87UprslWMHuhoicFejYFFQlQCUBw2svCojA/640?wx_fmt=png)

#### 首先准备好一段 shellcode（RAW 编码）保存在 aaa.bin（命名随意）中，然后使用 UBypass 进行加密，如下

```
PS D:\Data\fixable\code\WindowsShellcodeInjector\Release> .\WindowsShellcodeInjector.exe .\calc.bin
[*] Generated Private Key => gPT6SIbOa;od,u`vbg/;:kcS;k+=S%@ob]Cz&~\<=
[*] Your Padding Original Shellcode Size is 280
[*] Your Padding Encrypted Shellcode Size is 560
[*] Your Encrypted Shellcode is f30d0f241eafbe062451e23a3ede47419f06cbc36802ea49e23beb1caaa3dc008f4fa95bf85cc18235383bc8593411345e4485af8cd58a52e9500e0d5664760a99d5ef9d0727d70d582563959b016b1c2069a149cdddcd5fc

```

随后会在当前文件夹生成一个 Kawaii.exe 即为携带了你的 shellcode 的马子，使用的时候加上私钥即可，如下

```
PS D:\Data\fixable\code\WindowsShellcodeInjector\Release> .\Kawaii.exe 'gPT6SIbOa;od,u`vbg/;:kcS;k+=S%@ob]Cz&~\<='

```

#### 使用 golang 加载 DLL

使用方法如下

如果你不喜欢默认的 C++ 加载器，你也可以使用 golang 加载器，毕竟 C++ 的特征过于明显，很容易被杀软检测到，使用方法如下

1.  首先你需要将本项目编译为 DLL
    
2.  使用 go 编译 go_bundle.go 生成木马文件
    

```
go run go_bundle.go muma

```

其中 muma 为生成的木马文件名，可以自定义，具体建议看代码

3.  将生成的木马文件和 DLL 文件放在同一目录下，然后运行木马文件即可
    

### 免责声明

本项目仅供学习交流使用，请勿用于非法用途，否则后果自负，与本公众号无关

项目地址：  

https://github.com/Yeuoly/0xUBypass