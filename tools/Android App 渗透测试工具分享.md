<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/jkr17KSt2Bwqk9YpA5w7Bw)

drozer 简介
---------

drozer（以前称为 Mercury）是一款 Android 安全测试框架。

drozer 允许您通过承担应用程序的角色并与 Dalvik VM，其他应用程序的 IPC 端点和底层操作系统进行交互来搜索应用程序和设备中的安全漏洞。

drozer 提供工具来帮助您使用，共享和理解公共 Android 漏洞。它可以帮助您通过开发或社会工程将 drozer Agent 部署到设备。使用 weasel（MWR 的高级开发负载）drozer 能够通过安装完整代理，将有限代理注入正在运行的进程或连接反向 shell 以充当远程访问工具（RAT）来最大化其可用权限。

项目地址：https://github.com/mwrlabs/drozer

Mac 安装 drozer
-------------

1. 安装 Python3.8
---------------

https://blog.csdn.net/WANGJUNAIJIAO/article/details/134661910

作者的是 Python 3.8.17

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUhbgouT65rcus5NibTDkhnPbYrs4WVR2NGrEID1TNyZ5UZiafzZtWMibNA/640?wx_fmt=png&from=appmsg)

2. 安装 Protobuf 2.6 or greater

```
sudo pip install protobuf

```

3. 安装 Pyopenssl 16.2 or greater

```
pip install pyopenssl==24.0.0 

```

4. 安装 Twisted 10.2 or greater

```
sudo pip install twisted

```

5. 安装 JDK 1.7

这里我安装的是 JDK 1.8，最后也安装成功了。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUK0tFkjsSHIserpjwH4N9rOrBQfcdgJV9fQicibVZX6PB52yCJEaGoNBg/640?wx_fmt=png&from=appmsg)

6. 安装 Python 的 service_identity 模块（不安装的话后面运行 drozer 时总会显示警告）

```
sudo pip install service_identity

```

7. 安装 adb（Android Debug Bridge）

可以去 https://developer.android.com/studio/releases/platform-tools 下载相应平台上的安装包，解压后配置下环境变量即可，这里仅演示 Mac 下的安装方式：

安装 homebrew（已安装的话可跳过）

```
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

```

安装 adb

```
brew install android-platform-tools

```

测试是否安装成功

```
adb devices

```

如果不报错就说明安装成功啦。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUshCmWiaEZQk7z4NwCqibicicrUib1p1HnmuQLcUxMc5Wz9J9aaiaia9iaiaCBnQ/640?wx_fmt=png&from=appmsg)

8. 安装 drozer

到 https://github.com/WithSecureLabs/drozer/releases/ 下载相应平台的安装包：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MU81OCZ0QCQguibcV6Mg0mOXbCTBWwff9FIdVQyOudk899Jm6wvicXUabA/640?wx_fmt=png&from=appmsg)

```
sudo python -m pip install /Users/xiaobai/Downloads/drozer-3.0.2-py3-none-any.whl

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUJtUqgbLKEIELmIVr2dz1GO0eYxeMIKNNtZdpuz19mM184TfuEqNibeg/640?wx_fmt=png&from=appmsg)

安装成功后，执行 drozer 命令后输出如下：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MU5icT2MVUBvbIoocr763NYtibr3WUCnquPDgomia0AO6wSexwSJ83JNftA/640?wx_fmt=png&from=appmsg)

Windows 和 Linux 平台上的安装大体上类似，就不一一测试了。

客户端安装

同样到：https://github.com/WithSecureLabs/drozer-agent/releases/ 下载客户端，也就是 drozer（Agent .apk only）, 然后安装到手机或者模拟器上就好。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUbhZhFeciaDicccBaGbFHnrFKKHmNIC44AqHnC34ibXdnuYv3uyNSlqicrA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUMJfJVQsBsbDwxzocwQ9RVEJiab9MpVPlsr2OsCAm6hRtGomZCicLiapibw/640?wx_fmt=png&from=appmsg)

使用

### 使用 Android 模拟器：

如果使用 Android 模拟器，则需要设置合适的端口，以便 PC 可以连接到模拟器内部或设备上的代理打开的 TCP 套接字。默认情况下，drozer 使用端口 31415:

列出所有设备：

```
adb devices

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUkHoej7aAMCVse2pPx4ltklWV7VC2xRfMiakibN17eSZgiauUO94Swo6iaw/640?wx_fmt=png&from=appmsg)

接着执行：

```
adb forward tcp:31415 tcp:31415      #进行端口转发

```

启动移动设备中的 drozer agent，将右下角的关闭置为打开状态：

然后，使用 drozer 控制台进行连接，在 PC 终端中执行以下命令：

```
drozer console connect

```

如果连接成功，PC 终端效果如下：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUrC4LNApfE4qowwbFOEZsh7P31lfUcamIBibfUc06W1rse4tlR3CFxKQ/640?wx_fmt=png&from=appmsg)

此时，Android 客户端状态如下：  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUpzbGwzAf4qibibnvMKjibkInoMzlbibf73YP6OUnx8yblzOD598TjPPaYQ/640?wx_fmt=png&from=appmsg)

### 常用命令：

```
run app.package.list               #列出设备中安装的包
run app.package.list -f app名称     #不一定非得是完整的包名
run app.package.info               #获取安装的包的信息
run app.package.info -a com.android.browser   #列举指定包的信息
run app.package.info -p android.permission.INTERNET  #列出具有相应权限的包

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUibwKgY7PchiaFIPicRLa5Pn0HcJtMk9a9oTnJNwCKhvhydud1Wiat74FvQ/640?wx_fmt=png&from=appmsg)

查看 apk 信息

利用关键词 “sieve” 进行搜索得出包名：

```
run app.package.list -f sieve

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUjc2tk8O72VeBpibUYCbgTMNB5yqyVOFjhYQSwF8KVdTOPXSUYcg6K9A/640?wx_fmt=png&from=appmsg)

查看包信息

```
run app.package.info -a com.withsecure.example.sieve

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNm6H6Uy7DPc19WLdMZR4MUiblLKlhrial4R1kWIhPNunpR7OSQswMSRGEvKTzIVySPZvnhiaAfxjHNQ/640?wx_fmt=png&from=appmsg)

更多用法请前往官网查看

```
https://labs.withsecure.com/tools/drozer

```

MobSF

环境搭建

```
安装 Python 3.8+  (安装了3.8或3.8以上版本)         （必要的）
下载链接：https://www.python.org/downloads/
安装 JDK 8+                                      (必要的）
下载链接：https://www.oracle.com/java/technologies/downloads/#java8-windows
安装  感谢您下载 Visual Studio - Visual Studio    （必要的）
下载链接：https://visualstudio.microsoft.com/zh-hans/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16
安装OpenSSL (non-light)    Win32/Win64 OpenSSL Installer for Windows - Shining Light Productions （默认安装路径不要修改）（必要的）
下载链接：https://slproweb.com/products/Win32OpenSSL.html
下载和安装wkhtmltopdf （并添加到环境变量PATH，该工具是将结果生成PDF的）
下载链接：https://wkhtmltopdf.org/downloads.html
安装 雷电模拟器（动态分析需要用到，不然该功能用不了，模拟器也可以用其他的）

```

本文章使用的环境是：python 11, java jdk 17

MobSF 运行

```
github地址：https://github.com/MobSF/Mobile-Security-Framework-MobSF/archive/refs/heads/master.zip

```

命令：

```
setup.bat 安装环境依赖
run.bat 运行

```

下载 => 解压 => 打开  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNhxX14ohE6kyibpOdluqSzD6LVzCxxXlajjfSo1sr9SywVl3RMbwRH2Eyp8921hiadqaB7YgNL337g/640?wx_fmt=png&from=appmsg)

在地址栏上输入 cmd 并回车打开命令行终端：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNhxX14ohE6kyibpOdluqSzDpot5d5nMd2kYsalibl7pff0M0xHwiazSmwJnVvvDqP6R4E4tS6w3lb3A/640?wx_fmt=png&from=appmsg)

运行 ./setup.bat 安装依赖

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNhxX14ohE6kyibpOdluqSzDKIMZLxnCOx95neYzUEbiabB1NDLM7DtYicUhXTg9DTIgW6ywEZ02W3Rg/640?wx_fmt=png&from=appmsg)

然后运行 run.bat 启动服务：http://127.0.0.1:8000

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyNhxX14ohE6kyibpOdluqSzDStS4xVhFYJ6DIBjYvN6NUzd4dZvNP8ZRBA6uccnZic3xNsiaeCdW92iag/640?wx_fmt=png&from=appmsg)

**★  
**

**付费圈子  
**

  

  

**欢 迎 加 入 社区 ！**

**代码审计 + 免杀 + 渗透学习资源 + 各种资料文档 + 各种工具 + 付费会员**

![](https://mmbiz.qpic.cn/mmbiz_gif/pLGTianTzSu7XRhTMZOBAqXehvREhD5ThABGJdRialUx3dQWwO7fclsicyiajicKfvXV4kHs38nkwFxUSckVF2nYlibA/640?wx_fmt=gif&random=0.4447566002908574&wxfrom=5&wx_lazy=1&tp=webp)

  

**进成员内部群**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0YvAy5BgkyPnXn6CAvD7hsuGdKUkm7umsk3hcdicxCz3rBSv2d3SVib4ZhUhRYBNSso9vUecO4aNJGKCECsr6mkw/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**👇点击下方链接查看详细介绍👇**

**[鹏组安全社区 VIP 福利介绍 V1.2 版本 - 社区介绍](http://mp.weixin.qq.com/s?__biz=Mzg5NDU3NDA3OQ==&mid=2247490425&idx=1&sn=25a8d41abbf66fd731cd18d6d1c359f0&chksm=c01cd7e9f76b5eff49eaae3e20809e744b3ec40227169c54a203e1af6b867d42f7a2bdf988f1&scene=21#wechat_redirect)**

扫描二维码可直达社区

https://comm.pgpsec.cn/user

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/0YvAy5BgkyPnXn6CAvD7hsuGdKUkm7um7a4D12keOJOjiaGXhbvVQ3kB7yCibI67IKkKdthVtRFRhlpCTKFw6YCg/640?wx_fmt=other&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**免责声明**

由于传播、利用本公众号渗透安全团队所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号渗透安全团队及作者不为**此**承担任何责任，一旦造成后果请自行承担！如有侵权烦请告知，我们会立即删除并致歉。谢谢！

好文分享收藏赞一下最美点在看哦