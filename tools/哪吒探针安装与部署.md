<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/1wDjlrSMquiJ-2N6h7pMJw)

> 哪吒探针可以方便的监控服务器的实时网络、磁盘等状态。并且界面美观搭建简单，是我们日常运维中一款不错的工具。本文让我们一起学习它的安装过程吧。

准备
==

*   服务器一台（kali 也行）
    
*   Gitee 账号（github 国内不稳定）
    
*   域名（非必须）
    

注册 oauth
========

为了安全，哪吒探针并没有采用本地登录的方式。而是利用了 Gitee、Github 等第三方的登录接口。由于 Github 在国内老是抽风，故而选择了国内的`Gitee`平台。

**01 注册两个 Gitee 账号**

应该是第三方登录接口的问题，作者在部署时，无法用同一个账号进行登录。无论是 Gitee 还是 Github 都需要两个账号，即用`A`账号创建 oauth 应用，用`B`账号授权登录。

**02 创建 oauth 应用**

登录账号，访问`https://gitee.com/oauth/applications`, 并创建应用。创建完成后效果如下：回调地址格式：`http://{服务器IP}:8008/oauth2/callback`![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57TKD6lChjkViaYVkzibPrYmib6Xq7ian6dUK4BquVGWjh5vJiciaYicydNpPiasg/640?wx_fmt=png&from=appmsg)

记录 ID 和 Secret 的值。

安装探针
====

执行命令

```
curl -L https://gitee.com/naibahq/nezha/raw/master/script/install.sh -o nezha.sh && chmod +x nezha.sh && sudo CN=true ./nezha.sh


```

按照提示分别输入相应的信息。需要注意的是 Gitee 的登录账号为 `账号B`![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57TvWXtS8iac5SSN0MQsJsGsJSM8h1oiarQPWSZBC0HSVmatpIf1Xeb6Dng/640?wx_fmt=png&from=appmsg)接下来，分别在服务器防火墙和服务器安全组中开启`8008` `5555`端口。不然访问不了。接下来，访问 ip:8008 便可以看到页面了。

登录后台
====

进入主页后，点击登录。输入账号 B 的信息，进行登录 Gitee。出现授权页面时，点击授权。![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57Tgviar1eAuiaXbRJrjLd3vXrwGWDIIRj7awfhxvgicL1tfOjCXSHicaicawA/640?wx_fmt=png&from=appmsg)点击新增服务器，配置如下：![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57TPFG726aCBVa4K305Ez7jG8Dpd7jeq9Ioia3TnNqQotYErq0jmxgXSFA/640?wx_fmt=png&from=appmsg)点击设置页面配置面板服务器域名 / IP![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57ThP8J5nQ223ibgUOtG5E3icIRicQ1A53E7kmk8fUaiaOBoQTdDxcK4X7Y9Q/640?wx_fmt=png&from=appmsg)

添加客户端（Agent）
============

进入面板后台，根据系统类型选择图标后复制，一键按照。![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57ToMQNDSy64ysG7Nut6KeNlnC7TUHJFawLa9YSsfnkHicZLtDlbTYSWsg/640?wx_fmt=png&from=appmsg)或者访问下面命令先下载安装脚本到本地。然后手动安装。

```
curl -L https://gitee.com/naibahq/nezha/raw/master/script/install.sh -o nezha.sh && chmod +x nezha.sh && sudo CN=true ./nezha.sh


```

![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57TPm5prya5z73hTyKuJHaZLxWjSv4OGAgXwFuan9Fba2CmLljblqdD5Q/640?wx_fmt=png&from=appmsg)同样要注意，开启相关端口。![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57TcQdNBfuWJfZKtAdbJGiaCZiaqk4uibs9RibKXyuArgB7KLjicjAmwUjdicdQ/640?wx_fmt=png&from=appmsg)配置完成后，效果如下：![](https://mmbiz.qpic.cn/mmbiz_png/Xb3L3wnAiatge9BbWKIbnbx26GspKE57T1IThb7yb5FfCGM0pgOZGfocXcm2Ommm4rricl0SGXmcY0JJSKjrQwJg/640?wx_fmt=png&from=appmsg)

配置域名及代理
=======

如果你有可用的域名，可以对当前域名进行解析。解析完成后配置反向代理如下：

```
location /
{
proxy_pass http://127.0.0.1:8008;
proxy_set_header Host $host;
}
location /ws
{
proxy_pass http://127.0.0.1:8008;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection "Upgrade";
proxy_set_header Host $host;
}


```

**更多精彩文章 欢迎关注我们**