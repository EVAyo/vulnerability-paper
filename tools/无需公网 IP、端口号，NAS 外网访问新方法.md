<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/uTtYVshRFA5mn8IIJlYh6g)

哈喽，大家好我是生活爱好者。

本期文章利用 Cloudflare Tunnel，也能够实现异地访问功能，该教程比较简单，且适用于威联通、群晖等设备。

本文使用设备：威联通 NAS

**目录**

一、**域名托管至** **_Cloudflare_**

**二、开通 CloudFlare Tunnel**

**三、配置 Cloudflared**

**四、测试**

操作前准备：一个域名 + 一个 Cloudflare 账号。

攻略看着很难的样子，真正操作起来很简单，跟着步骤操作就行。

**一、域名托管至 Cloudflare**










==================================

准备好一个域名和一个 Cloudflare 账号，Cloudflare 账号注册比较简单，进入官网注册即可；域名注册，在下面会有具体的介绍也很简单，接着需要 Cloudflare 托管 DNS 服务，先登入 Cloudflare 后，添加域名，然后进行配置。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxkQ9Zz1DLWaPK0UlXHdFiaibVd3UFAsOnoFQcIPNT04gBMknztK3oFG9A/640?wx_fmt=png&from=appmsg)

然后需要将下图的两个服务器名称分别复制到腾讯云中的服务器。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxoIKCCkj19w8RdoLLpHYpxtSxoN1E1UztroIibtOK3G0U7FRJGXVia7uw/640?wx_fmt=png&from=appmsg)

还需要登入到腾讯云，点击修改 DNS 服务器。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxO7ILuFyvgDqmuZhCAukM0mSgCg9ibKraFpwfSpTSoP3wHBELQCibjLxg/640?wx_fmt=png&from=appmsg)

将上面分配的两个 Cloudflare 名称服务器复制到这里即可。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxVD2Fq9oPaABY2eQSX7JbKjY4JzCLpq9rCsAdmHhL47icmrEcgrReIRQ/640?wx_fmt=png&from=appmsg)

关于**域名托管至** **_Cloudflare  详细内容可参考该文章，该文章还介绍域名注册，以及 docker 无法拉取映像的解决方法。[【保姆级免费攻略】Docker 镜像提取失败解决方案](http://mp.weixin.qq.com/s?__biz=MzU3MTAyNjUwMA==&mid=2247484068&idx=1&sn=25182e05b6dc924a0db5cbc9e31f56a2&chksm=fce73f8fcb90b699e1e8adc765f204e6b0b8998228e190a588fc02ed545f41ef1ac8803012c1&scene=21#wechat_redirect)_**

**二、开通 CloudFlare Tunnel**










======================================

首先点击该页面菜单栏左侧的【Zero Trust】。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxOsmhDFqXUjuKkWbd2Iz6ERiapd0AnzflP3AClwHtjoOnHTThyUcRrVA/640?wx_fmt=png&from=appmsg)

填写项目名称，方便后期管理，接着进行下一步。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOx8boa3QNaFOXvZpnHXyBibswnsyUIJAauBI85bml4AVFpjItWVpwkzfg/640?wx_fmt=png&from=appmsg)

接着根据自己的需求，选择适合自己的计划，没啥特殊需求，选择第一个，免费。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxd81psYWG738BgN22EHdA2pf2FaPyxmPa0K2RkEmYnUYQV2jH3IUoCA/640?wx_fmt=png&from=appmsg)

虽然免费，提醒我们绑定支付方式，可以不绑定，需要我们点击右上角取消，然后确定退出。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxFTiaLOmBVHpgJzib1jY8hALcF4YcQLaLJSdX7Hics0ibTh0XHmjpnm2ia5g/640?wx_fmt=png&from=appmsg)

接着回到菜单栏，选择【Zero Trust】，选择【Networks】。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxTzW2DiczNUiayVKGz5rc2sAw55TKMYNoRg0e6uWicd09AKT4tseC733MQ/640?wx_fmt=png&from=appmsg)

接着再选择其中的【Tunnels】，这里有些朋友可能找起来会比较麻烦，跟着指引就可以。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxAZF5n52k21LDmtFib3XDPnzybSMjxdEWYALd2QcF0Ep8esjPgqO4ibdA/640?wx_fmt=png&from=appmsg)

然后再选择 Cloudflared，这里给大家科普下，可以把 Cloudflared 看作通道，本地服务服务与 Cloudflared 连通，从而把流量交给 Cloudflare，在文章开通，通过域名托管，所以，通过域名就可以实现异地访问本地服务。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOx42ZryPdPHTKcV2vb9DSvTXbSZibBPRcXlrwgr0E1aibT5IqyGOHShnaA/640?wx_fmt=png&from=appmsg)

接着，再给通道命名，然后点击保存。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxtDEzN77Th3kicBxql94kBkYrVyEia8Wic5XKRZaUXu3n2LcdxflnhF7RQ/640?wx_fmt=png&from=appmsg)

这里先选择 Docker，接着底部会出现代码，标红部分，可以打开电脑上的记事本，将红框中内容复制到笔记本，方便下面部署时会使用。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxO8Bk6YoQneSv3vAianIYCmc3VdtVFR1lFjY4u8lm0XZYqBzAwrC8lAA/640?wx_fmt=png&from=appmsg)

所获得的部署命令，加了一个开机自启动

```
docker run -d --restart=always cloudflare/cloudflared:latest tunnel --no-autoupdate run --token 你的token

```

这里的 token 就是复制上图红框里的，可以将上图红框中内容，复制到文本中，然后再将 token 复制到下面的代码中。

以威联通 NAS 为例，我选择直接转成 Docker Compose，通过 **Container Station** 部署，注意：代码中你的 token 这里要换成在 Cloudflare 的 Docker 中复制的 token。

```
version: '3'


services:
  cloudflared:
    image: cloudflare/cloudflared:latest
    command: tunnel --no-autoupdate run --token 你的token
    restart: always # 加上一条开机自启动



```

在这里把复制过去代码，token 更改为自己的，就是在 Cloudcare 里复制的那段代码。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxjeP7qjaDBw4pV5VNfL3VSTl0HiaiaiaUuJLocneZLYgYN0icMGpaSHkibwQ/640?wx_fmt=png&from=appmsg)

**三、配置 Cloudflared**










================================

然后在【Tunnels】中点击【Public Hostname Page】进行设置，第一个空白处填二级域名的前缀，这里填写【nas】，第二个空白处，填写托管的域名，path 部分，不用填，Type 部分，选择 Http，最后一个空白区域填写的 NAS 的 IP 地址：192.168.XX.XX：5000。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxa2kTricUEzfsOV5k1LZ2mUMnXRuFmxKd0QUmUubqPA5p8IKjWKBUWcA/640?wx_fmt=png&from=appmsg)

**四、测试**










====================

在浏览器中输入：nas + 域名，即可成功访问 NAS 了。

![](https://mmbiz.qpic.cn/mmbiz_png/KOurXFyxfQrSpsW56TdLFibATZICDbrOxAhURMXxibvxXYbnXotGAjoeEwmiaWyzbZ545lDmXOJooILvrQOdCuwIw/640?wx_fmt=png&from=appmsg)

希望本期文章对你有所帮助，感兴趣的朋友可以点个在看和关注，咱们下期见！