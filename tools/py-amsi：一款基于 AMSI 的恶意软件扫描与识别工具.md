<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/3BV-CuwgkVUH2-aZWfsEUg)

![](https://mmbiz.qpic.cn/mmbiz_gif/qq5rfBadR38jUokdlWSNlAjmEsO1rzv3srXShFRuTKBGDwkj4gvYy34iajd6zQiaKl77Wsy9mjC0xBCRg0YgDIWg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)
---------------------------------------------------------------------------------------------------------------------------------------------------------------

 **关于 py-amsi** 
----------------

py-amsi 是一款基于 Windows 反恶意软件接口（AMSI）实现的强大安全工具，该工具可以利用 AMSI 扫描恶意软件相关的字符串与文件信息，以检测目标系统是否感染了恶意软件。

AMSI 是 Windows 的原生接口，允许应用程序要求系统上安装的防病毒软件分析文件 / 字符串。需要注意的是，AMSI 与 Windows Defender 无关。

![](https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ibE7qkicW106hCFyjuYQykvc5wrNVg1VqwG9Ts2KiabHuJIXLSIPQ9OOibBlr5I7yicGbKeCrhibWt9pug/640?wx_fmt=jpeg&from=appmsg)

 **什么是 AMSI** 
--------------

Windows 反恶意软件扫描接口（AMSI）是一种通用的接口标准，允许我们的应用程序和服务与计算机上的任何反恶意软件产品集成。AMSI 可以为最终用户及其数据、应用程序和工作负载提供增强的恶意软件保护。

AMSI 可以为反恶意软件产品提供最常见的恶意软件扫描和保护技术，这些技术可以集成到应用程序中，并可以执行文件和内存或流扫描、内容源 URL/IP 信誉检查以及其他技术。

 **工具安装** 
----------

由于该工具部分功能使用 Python 开发，因此我们首先需要在本地设备上安装并配置好 Python 环境。

源码安装接下来，广大研究人员可以直接使用下列命令将该项目源码克隆至本地：

```
git clone https://github.com/Tomiwa-Ot/py-amsi.git
```

（向右滑动，查看更多）

然后切换到项目目录下，执行安装脚本即可：

### **pip 安装**

除此之外，我们还可以直接使用 pip 工具安装 py-amsi：

```
pip install pyamsi
```

 **工具使用** 
----------

### **风险等级**

<table><tbody><tr><td><p><strong>风险等级</strong></p></td><td><p><strong>描述介绍</strong></p></td></tr><tr><td><p>0</p></td><td><p>AMSI_RESULT_CLEAN (文件是良性的)</p></td></tr><tr><td><p>1</p></td><td><p>AMSI_RESULT_NOT_DETECTED (未检测到威胁)</p></td></tr><tr><td><p>16384</p></td><td><p>AMSI_RESULT_BLOCKED_BY_ADMIN_START (管理员已屏蔽此威胁)</p></td></tr><tr><td><p>20479</p></td><td><p>AMSI_RESULT_BLOCKED_BY_ADMIN_END (管理员已屏蔽此威胁)</p></td></tr><tr><td><p>32768</p></td><td><p>AMSI_RESULT_DETECTED (文件与恶意软件有关)</p></td></tr></tbody></table>

 **函数子模块** 
-----------

### **pyamsi.Amsi.scan_file**

### **pyamsi.Amsi.scan_string**

 **许可证协议** 
-----------

本项目的开发与发布遵循 MIT 开源许可证协议。

 **项目地址** 
----------

**py-amsi**：https://github.com/Tomiwa-Ot/py-amsi

【FreeBuf 粉丝交流群招新啦！

在这里，拓宽网安边界  

甲方安全建设干货；

乙方最新技术理念；

全球最新的网络安全资讯；

群内不定期开启各种抽奖活动；

FreeBuf 盲盒、大象公仔......

扫码添加小蜜蜂微信回复 “加群”，申请加入群聊】

![](https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ich6ibqlfxbwaJlDyErKpzvETedBHPS9tGHfSKMCEZcuGq1U1mylY7pCEvJD9w60pWp7NzDjmM2BlQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/oQ6bDiaGhdyodyXHMOVT6w8DobNKYuiaE7OzFMbpar0icHmzxjMvI2ACxFql4Wbu2CfOZeadq1WicJbib6FqTyxEx6Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR3icEEJemUSFlfufMicpZeRJZJ61icYlLmBLDpdYEZ7nIzpGovpHjtxITB6ibiaC3R5hoibVkQsVLQfdK57w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

>   
> 
> https://learn.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal
> 
> https://tomiwa-ot.github.io/py-amsi/genindex.html
> 
> https://pypi.org/project/pyamsi/
> 
>   

![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR3icEEJemUSFlfufMicpZeRJZJ7JfyOicficFrgrD4BHnIMtgCpBbsSUBsQ0N7pHC7YpU8BrZWWwMMghoQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

[![](https://mmbiz.qpic.cn/mmbiz_png/qq5rfBadR3ibU04PkxarEakxlsLQpvEGqegzLtXpHsragO8KuibWZl5RpWh09qI9DBFlfKKkCohHSIgR1tT6QYKA/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1)](http://mp.weixin.qq.com/s?__biz=Mzg2MTAwNzg1Ng==&mid=2247492331&idx=1&sn=406428ff5a9e185e658948e896b0b4a8&chksm=ce1f1874f9689162105cf92ee082dcafbd164bbe3fb15d3bde4d4c8328c2ac2d3526fd006d84&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR386zuBxiagytVH25LWIpgxMpMOEHrlOI31x3WXKrIZaZrDpUmvjAqw60772yY62xKEWx0GXjuxcsHA/640?wx_fmt=jpeg&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1)](http://mp.weixin.qq.com/s?__biz=Mzg2MTAwNzg1Ng==&mid=2247492331&idx=1&sn=406428ff5a9e185e658948e896b0b4a8&chksm=ce1f1874f9689162105cf92ee082dcafbd164bbe3fb15d3bde4d4c8328c2ac2d3526fd006d84&scene=21#wechat_redirect)

[![](https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ibU04PkxarEakxlsLQpvEGqvyytk5u9GoFYWjyTnGaFLq1c0svL4PcXQAlK6soxDmEoNYibs4aDIwQ/640?wx_fmt=jpeg&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1)](https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&mid=2651253272&idx=1&sn=82468d927062b7427e3ca8a912cb2dc7&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_gif/qq5rfBadR3icF8RMnJbsqatMibR6OicVrUDaz0fyxNtBDpPlLfibJZILzHQcwaKkb4ia57xAShIJfQ54HjOG1oPXBew/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)