<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/94s3AYqQUKkBtkNSBRyh0g)

![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

**免责声明  
**

![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

![](https://mmbiz.qpic.cn/mmbiz_gif/HVNK6rZ71oofHnCicjcYq2y5pSeBUgibJg8K4djZgn6iaWb6NGmqxIhX2oPlRmGe6Yk0xBODwnibFF8XCjxhEV3K7w/640?wx_fmt=gif&wxfrom=13&wx_lazy=1&tp=wxpic)

本公众号所提供的文字和信息仅供学习和研究使用，请读者自觉遵守法律法规，不得利用本公众号所提供的信息从事任何违法活动。本公众号不对读者的任何违法行为承担任何责任。工具来自网络，安全性自测，如有侵权请联系删除。

  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

**工具介绍**

![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

在攻防演练中，做完免杀马后为了效果更佳，我们一般需要把木马伪装成正常的文件，因此替换木马签名是很重要的步骤，且可以一定程度规避 360 的 qvm 检测。

该工具，将会从已签名的 PE 文件中撕下签名并将其附加到另一个文件中，从而修复证书表以对该文件进行签名。

![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

**工具使用**

![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

### 从二进制文件中获取签名并将其添加到另一个二进制文件中

```
$ ./sigthief.py -i tcpview.exe -t x86_meterpreter_stager.exe -o /tmp/msftesting_tcpview.exe 
Output file: /tmp/msftesting_tcpview.exe
Signature appended. 
FIN.

```

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLo6sXJ3nQDMW6BT65yzvuufDfOiaYkdMhrj7jasWYHAWcKTqULhA0ia5pg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLo5c9gLxqDOUBialyMFTwIkGzvCZ07ATp5AScVbnVJtX2YotzVCgD98aA/640?wx_fmt=png&from=appmsg)

### 将签名保存到磁盘以供以后使用

```
$ ./sigthief.py -i tcpview.exe -r                                                        
Ripping signature to file!
Output file: tcpview.exe_sig
Signature ripped. 
FIN.

```

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLoqvUb4AoCOQ1bpPZ7jMo9EeDHra1iaIBeZia5NujfcpZe0trsBkP5z0aA/640?wx_fmt=png&from=appmsg)

### 使用撕破的签名

```
$ ./sigthief.py -s tcpview.exe_sig -t x86_meterpreter_stager.exe                               
Output file: x86_meterpreter_stager.exe_signed
Signature appended. 
FIN.

```

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLosxiaLCqI2aPKVue8vcc01ia8icggMbqmpVanD0QpXxuSoh7g9GpHzJdOg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLozibQB6IncduMa8UpSkoNptIhGdL7vias8MHIWrD5rWia4Yoib8ttUreiaGg/640?wx_fmt=png&from=appmsg)

### 截断（删除）签名

实际上，这有非常有趣的结果，可以帮助您找到重视签名而不是代码功能的 AV。取消签署 putty.exe ;)

```
$ ./sigthief.py -i tcpview.exe -T    
Inputfile is signed!
Output file: tcpview.exe_nosig
Overwriting certificate table pointer and truncating binary
Signature removed. 
FIN.

```

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLoWicq4MDg6Bpc9TibBtuA53TpTXyvfpbh0kDs0qlCKkSscNhBHNgBxH7A/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLo6dea6cUpNPWByHUbBCN2QWpwSwsDYiawpqM1rHe6gRZs3ibu029JOXyg/640?wx_fmt=png&from=appmsg)

### 检查是否有签名（不检查有效性）

```
$ ./sigthief.py -i tcpview.exe -c
Inputfile is signed!

```

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLoNibzQsDWZez84xYkwoBkZfZqqB4sJzfibtTjMQpicxK4txOxSkSgnQkGQ/640?wx_fmt=png&from=appmsg)

使用实例
----

免杀木马生成前文件

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLoLSTh9112FaolQWOmjicxbnN2JqQ7voVriawYrQK1PmiaPgR4h09WMnFag/640?wx_fmt=png&from=appmsg)

需要窃取的签名文件，我们这里使用 sublime 用来演示。

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLoH2ibOJw0FCWyVYY2eVkvkibgxdq2aoWvJ88SKNWY9BEozwgDKyYJPFRQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLo6HEWfylhm8fZY5bLDpJJHwuvuVY4aIR7icPLfBgeVADjT484ibaHDibDQ/640?wx_fmt=png&from=appmsg)

接下来使用工具进行签名

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLoPodg1J1oydBDqcZE3mZIaaEpPkxicCle358MOgOLU35eoasBxgrsfXA/640?wx_fmt=png&from=appmsg)

```
-i 为签名文件
-t 为需要伪造的文件
-o 为输出文件

```

可以看到增加了数字签名

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCA8w1ziccsOXkB8mrRcqnxLoHDWrR8yVQrKR95fKiaOoOqbOkHGbkHcyBI17C2XBnYFeND17siaYHoMQ/640?wx_fmt=png&from=appmsg)

**下载链接  
**

![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

回复关键字【20231121】获取下载链接  

![](https://mmbiz.qpic.cn/mmbiz_png/lcbWX2ticDCCia0DYmSh12FCGibVw08zxXnkBmicTDv6O6TUtbEk3xkrBU0rDKlnI964hGVvAkBU34ricdcTnknrv9Q/640?wx_fmt=png)

End

“点赞、在看与分享都是莫大的支持”

**工具精选  
**

![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

  
[【红队】一款红队在大量的资产中存活探测与重点攻击系统指纹探测工具](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247487190&idx=2&sn=394a1eaff8e190086c433deee867de3f&chksm=c2e0f706f5977e10c8413873c1ad2f6b460b2e8d66cab0287a9a9725fa6dfadf1dcba1de55bb&scene=21#wechat_redirect)  
[【红队】集成一站式企业信息资产收集、网络资产测绘的工具。](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247487228&idx=1&sn=2aae55099c7e184272248aef2b0cd569&chksm=c2e0f72cf5977e3abafc9d478a1b75473a6c53103960d09dc3ebf253e69de3a8997471ad9fe3&scene=21#wechat_redirect)  
[【红队】内网渗透工具 - Viper 最新版本](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247487150&idx=2&sn=9e4c30dfd565bf6b90caf2778a804427&chksm=c2e0f77ef5977e68368992b591629a395254e648ff0c47cc8e434c54582dcae8ad52d77bbabb&scene=21#wechat_redirect)  
[【红队】一个辅助平常渗透测试项目或者攻防项目快速打点的综合工具](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247487082&idx=2&sn=fda8ccd6ade17083e732bdd043f1d90f&chksm=c2e0f7baf5977eac8d165e5fce982f8b2bed6c33190f1ba13f8eee13c07d9c121541e64cc24f&scene=21#wechat_redirect)  
[【红队】afrog v2.7.2 新版本发布](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247487067&idx=2&sn=03b69a7dae831cd49c9baabb6874371a&chksm=c2e0f78bf5977e9dac2c6eeb36a3386de26d365709318ab5bf7be467440f4778b6ba09e4d954&scene=21#wechat_redirect)  
[【红队】横向移动命令执行工具—WMIHACKER](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247487150&idx=1&sn=9c5af3616d3d30886c00a8935b6ed126&chksm=c2e0f77ef5977e68f24b7490526e497b8ea3d5e42d2b30b8f36514e657e2bbe28db7259f3c8b&scene=21#wechat_redirect)  
[【红队】Aboutveinmind-tools 容器安全工具集](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486990&idx=1&sn=f7670c736d17b1060090266452c09af5&chksm=c2e0f7def5977ec8e46cd0dfcf95d350f3bd5c4493432b417ad7a33b96660fe7b8c40d8cd9ac&scene=21#wechat_redirect)  
[【红队】一个集成了非常多渗透测试工具](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486692&idx=1&sn=7ce59325b89bc015160bdfe366b01362&chksm=c2e0f534f5977c22f0127142264815233e25c6b4138e1a70d0c65e20885477918b0c71fab41b&scene=21#wechat_redirect)  
[【红队】一款内网综合扫描工具，一键自动化、全方位漏扫。](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486673&idx=1&sn=de6d24a0b4a285fc787199b74e0c2117&chksm=c2e0f501f5977c17470c3943d880e0cf6f799b64149666edd68c70bebcc7b6c03bbc2ccc64ac&scene=21#wechat_redirect)  
[【红队】红队快速打点工具 - POC-bomber v3.0.0 版本](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486565&idx=1&sn=303dd41104f3be3a46480f6db6999853&chksm=c2e0f5b5f5977ca3eab45e9cd8dd3b3c3c8458dbc1124c3f6ecea1bb55713a70ba210df31d1c&scene=21#wechat_redirect)  
[【红队】Medusa—红队武器库平台](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486488&idx=1&sn=b4cad24e938c55b6f24719ca1c2a55ac&chksm=c2e0f5c8f5977cde0ac5131ddf78e1ef28cb499b23b60a089794fe4223e3344d2a9fe0a7ba3f&scene=21#wechat_redirect)  
[【红队】一款 C2 设施前置流量控制工具](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486387&idx=1&sn=56630a215dd45bd66136d5742a6e2c5f&chksm=c2e0f263f5977b7574cfee18a9954d2b2e3f0db091e839d03afd52288d932ce5d8c21b9329cc&scene=21#wechat_redirect)  
[【红队】集成 vscan、nuclei、ksubdomain、subfinder 等工具的打点神器 --scan4all](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486235&idx=1&sn=157927b9e599e9044a709ac74ccece68&chksm=c2e0f2cbf5977bdd4e3d04847014aeac9dc3f306d69edbc8d9d4a7eee21ef9d4b78d369093ad&scene=21#wechat_redirect)  
[【红队】网络安全单兵作战工具 - YAKIT](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247486121&idx=1&sn=228b8af22ece479fc30b87e6453023d8&chksm=c2e0f379f5977a6f7d5f90d8d91100d9d9e959151d865fd66649debe099eff86cc1b581f946f&scene=21#wechat_redirect)  
[【红队】最新 Burpsuite Professional 2023.6.1](http://mp.weixin.qq.com/s?__biz=Mzk0MDQzNzY5NQ==&mid=2247485996&idx=1&sn=8c60f7fca3713655963caeb4a8d0cfbb&chksm=c2e0f3fcf5977aea02b60c5e42df56b8d7c22b13ff6f31eaea6a1622f1b1ce95b9fbc51fa64c&scene=21#wechat_redirect)  

![](https://mmbiz.qpic.cn/mmbiz_png/pM2klgicgT5dylTzXyrXBmex6dlAsZ0QJOQdzqcw2HpC49rnL0dTHNsWsOze4QmRYN7fPRoLdVK5MXs0DXtOvZw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)