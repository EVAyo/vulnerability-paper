<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/R-akTitU4DrsUsbYp0wL_Q)

**CDN 简介：**

CDN 主要用于加速访问，在各个地区访问时，以最接近的地区的服务器提供访问服务，而不是从原始服务器获取，从而大大减少延迟。拥有 CDN 可以减少源站压力和隐藏服务器真实 IP。

**国内常见 CDN：**

*   `阿里云`
    
*   `腾讯云`
    
*   `百度云`
    
*   `网宿科技(ChinanNet Center)`
    
*   `蓝汛`
    
*   `金山云`
    
*   `UCloud`
    
*   `网易云`
    
*   `世纪互联`
    
*   `七牛云`
    
*   `京东云等`
    

**国外常见 CDN：**

*   `Akamai(阿卡迈)`
    
*   `Limelight`
    
*   `Networks(简称LLNW)`
    
*   `AWS Cloud(亚马逊)`
    
*   `Google(谷歌)`
    
*   `Comcast(康卡斯特)`
    
*   `Cloudflare`
    

**判断目标站点是否存在 CDN：**

最简单也是最有效的方法就是通过 ping 来查看，通过在线 ping 在网站，进行分析。  

例如站长工具的全国 ping

![](https://mmbiz.qpic.cn/mmbiz_png/PGbmE4CTriaticCL7TGRHDJ6gCXtG00ibma4OibKDq1kkECG7CzuBBmLMuWWzKup8PfBBjFRLJHlhSQ3od4ibIAVYLg/640?wx_fmt=png&from=appmsg)

可以看到有在全国不同的地区分别对应着不同的 ip，并且提供了 cdn 服务商。  

或者通过 cmd 的 nelookup 解析命令查看

不同 DNS 域名解析情况对比

判断其是否使用了 CDN 不同 DNS 解析结果若不一样，很有可能存在 CDN 服务

![](https://mmbiz.qpic.cn/mmbiz_png/PGbmE4CTriav47o7ap73zMfdxMHbibWWUMC9bCmIGJOTRfrWpj3c3CzdIJJhuqf4TNntbibsGVFO55uFmiaOhSibDJg/640?wx_fmt=png&from=appmsg)

若解析结果有多个，很有可能存在 CDN，相反，若解析结果有一个，可能不存在 CDN(不能百分之百肯定)

最有效检测是否存在还是通过在线 ping 工具

通过全国或者全世界不同的 ip 进行 ping

会显示出不同的 ip，即存在 CDN

**在线 ping 工具****：**

ping.chinaz.com  

17ce.com  

tools.ipip.net/newping.php

另外一种是使用工具查询  

工具只能用于辅助查询，有一定的误报的概率，只能用于参考

##### Cdnplanet（速度可能比较慢）：

![](https://mmbiz.qpic.cn/mmbiz_png/PGbmE4CTriav47o7ap73zMfdxMHbibWWUM6hZWEJ4Hy7khylY6UZMlWaOiaKd9uibQpE5ceBSyudWRQSq0RtsYpqyA/640?wx_fmt=png&from=appmsg)

寻找真实 IP
-------

可以通过子域名、DNS 历史解析纪录、网站邮件头 IP、网络空间安全引擎搜索、利用 SSL 证书寻找真实 IP、国外主机解析 IP 等等进行查找到 cdn 背后真实 IP 地址

**1、通过子域名**  

很多时候，一些重要的站点会做 CDN，而一些子域名站点并没有加入 CDN，而且跟主站在同一个 C 段内，这时候，就可以通过查找子域名来查找网站的真实 IP。

**常用的子域名查找方法和工具**：

1、**搜索引擎查询**：如 Google、百度、Bing 等传统搜索引擎，site:baidu.com inurl:baidu.com，搜 target.com 公司名字。

2、**一些在线查询工具**，如：

http://tool.chinaz.com/subdomain/

http://i.links.cn/subdomain/    

http://subdomain.chaxun.la/

http://searchdns.netcraft.com/

https://www.virustotal.com/

3、 **子域名爆破工具**

Layer 子域名挖掘机

wydomain：https://github.com/ring04h/wydomain    

subDomainsBrute:https://github.com/lijiejie/

Sublist3r:https://github.com/aboul3la/Sublist3r

##### 2、DNS 历史解析纪录

查询域名的历史解析记录，可能会找到网站使用 CDN 前的解析记录，从而获取真实 ip，相关查询的网站有：

iphistory：https://viewdns.info/iphistory/

DNS 查询：（https://dnsdb.io/zh-cn/）

微步在线：（https://x.threatbook.cn/）

域名查询：（https://site.ip138.com/）

DNS 历史查询：（https://securitytrails.com/）

Netcraft：https://sitereport.netcraft.com/?url=github.com

IP History 查询记录：

![](https://mmbiz.qpic.cn/mmbiz_png/PGbmE4CTriav47o7ap73zMfdxMHbibWWUMBOCwoibXX7Hz7ROp2I3IUKE5OtLIiato6dLga5c4cC78G01kzBT6xtrQ/640?wx_fmt=png&from=appmsg)

3**、网站邮件头信息**

一些网站有发送邮件功能，是利用真实服务器进行发送，有些网站会忽略这一点，没有加上 CDN 防护, 例如网站的用户注册, 找回密码之类的。直接查看邮件原文就可以了。如果是⼤站，会有⾃⼰的邮服给你发送，那么这个邮服的有可能跟⽬标 Web 在⼀个段上，我们直接⼀个⼀个扫，看返回的 HTML 源代码是否跟 web 的对的上，比如我在注册一网站的时候，它给我发了地址验证邮件，查看该邮件的原文，即可看到其服务器真实 IP，如图

![](https://mmbiz.qpic.cn/mmbiz_png/PGbmE4CTriav47o7ap73zMfdxMHbibWWUMzQKwWZia6vpIHKXELgR5Aicnr5G6SAvUP5ywVeOR4ZeOlcRKp5EljoqQ/640?wx_fmt=png&from=appmsg)

4**、网络空间安全引擎搜索**

空间搜索引擎就不用多说了，很强大，通过关键字或网站域名，就可以找出被收录的 IP，很多时候获取到的就是网站的真实 IP。

```
Fofa：https://fofa.so
钟馗之眼：https://www.zoomeye.org
Shodan：https://www.shodan.io

```

![](https://mmbiz.qpic.cn/mmbiz_png/PGbmE4CTriav47o7ap73zMfdxMHbibWWUMFt8kF6whkJFsyQPBxOo8iaSbxBGA97mPnHshW6ia5FqxaBN9OiadtPYRw/640?wx_fmt=png&from=appmsg)

5**、SSL 证书寻找真实 IP**

通过浏览器查看网站的 SSL/TLS 证书信息，有些 CDN 提供商会在证书中标明自己的信息。

可以通过浏览器或命令行工具获取 SSL 证书的详细信息。

**使用浏览器**打开目标网站（例如，https://example.com）。

点击地址栏中的锁图标。

查看证书详细信息，记下证书中的 “颁发给（Issued To）” 和“颁发者（Issuer）”信息。

**使用命令行工具（openssl）**

你可以使用 openssl 命令行工具来获取证书信息。以下是获取证书详细信息的命令：

```
openssl s_client -connect example.com:443 -showcerts

```

**使用证书搜索引擎**

Censys ：

![](https://mmbiz.qpic.cn/mmbiz_png/PGbmE4CTriav47o7ap73zMfdxMHbibWWUMLdhwLNOMyO6HBxTiaMWbZK9qFbubUAuv84RiaGwPicYhwicsYEYrUVJNXg/640?wx_fmt=png&from=appmsg)

6**、国外主机解析域名**

大部分 CDN 厂商因为各种原因只做了国内的线路，而针对国外的线路可能几乎没有，此时我们使用国外的 DNS 查询，通过一些冷门地区进行 ping，很可能获取到真实 IP。

```
国外多PING测试工具：
https://asm.ca.com/zh_cn/ping.php
http://host-tracker.com/
http://www.webpagetest.org/
https://dnscheck.pingdom.com/

```

**7、扫描全网**

通过 Zmap、masscan 等工具对整个互联网发起扫描，针对扫描结果进行关键字查找，获取网站真实 IP。

1、ZMap 号称是最快的互联网扫描工具，能够在 45 分钟扫遍全网。

https://github.com/zmap/zmap

2、Masscan 号称是最快的互联网端口扫描器，最快可以在六分钟内扫遍互联网。

https://github.com/robertdavidgraham/masscan

**8、通过域名备案信息广域探测（成功率高）**

针对目标域名，目标二级域名，如果都做了 CDN 的情况下，是不是就思路中断了呢？

肯定不是。这里分享一个很少有人去关注的独门秘技。

网站需要服务器，但是再有钱的公司，也不可能一个域名一台服务器，大多数情况下，都是多个域名业务，共享一台服务器。

那么如果目标网站存在备案，可以查询其备案信息，收集该单位或者个人备案的其他网站域名以及其他子域，然后再进行一轮广域的探测，很有可能其中的某个边缘子域，没有做 CDN，就直接暴露了真实服务器的 IP 地址，然后再进一步验证该 IP 是否也是目标网站的真实 IP 。