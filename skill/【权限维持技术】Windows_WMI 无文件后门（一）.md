<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/0bjXi3_1LiIhiRG0DOo3cQ)

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

免责声明

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

本文仅用于技术讨论与学习，利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者及本公众号不为此承担任何责任。

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

WMI 简介

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

WMI，全名 Windows Management Instrumentation，即 Windows 管理工具，是 Microsoft 的一种基于网络的管理服务。其可以帮助用户管理本地和远程计算机，包括硬件、操作系统、应用程序等方面的内容。WMI 建立在 Web-Based Enterprise Management (WBEM) 及 Common Information Model (CIM) 标准之上，允许系统管理员使用面向对象的方式管理计算机。此外，WMI 还支持通知能力，在系统状态发生改变时，可以自动执行程序或者脚本。通过 WMI，我们可以获取硬盘空间、内存使用、电脑开启时间等大量信息，此外还可以执行特定任务如关机、重启等。

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

WMI 体系结构

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

Windows Management Instrumentation (WMI) 的体系结构主要包括以下四个主要部分：

*   WMI 客户端：这些是 WS-Management SOAP 协议的用户，它们向 WMI 服务发送请求以获取信息，改变系统状态，或执行某些任务；
    
*   WMI 服务：它接收和处理来自 WMI 客户端的请求，然后与 WMI 提供器交互以完成这些请求；
    
*   WMI 提供器：WMI 提供器是一种插件，它为 WMI 暴露出一部分或全部的的管理信息。它们也可以接收请求来改变这些信息或执行任务；
    
*   CIM 对象库：它是一个存储元数据的数据库，这些元数据描述了系统的管理信息。这包括类定义，实例数据，以及元数据本身的元数据。
    

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BKY26zAGWG0X0puBSbPv4qSn3TFllfejqR7I2zt6ThKMZElsa3EVXSII7cd1zrWYoyJeFjcEVo4g/640?wx_fmt=png)

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

CIM 对象库

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

CIM 对象库，也称为 CIM Repository，是 Windows Management Instrumentation (WMI) 的一个重要部分，用于储存系统管理数据的模型和实例信息。这些信息被组织成面向对象的结构。

在 CIM 中，所有的对象都可以视为类（Class）或类的实例（Instance）。类能够定义数据对象的行为和属性，比如 "Windows 服务" 就是一个类，它可能有 "服务名称"，"状态" 等属性。对于具体的某个 Windows 服务，则是这个类的一个实例。

CIM 对象库按层次结构组织，最顶层是名称空间（Namespace），每个名称空间可以理解为一个独立的数据库，包含一系列的类和实例。比如，“root\CIMV2” 是最常用的一个名称空间，包含了管理 Windows 系统的大部分常见的类和实例。在实际使用中，系统管理员可以凭借查询语言 WQL（类似 SQL) 进行查询，获取或修改 CIM 对象库中的数据。

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/FVvAFkxoh9BKY26zAGWG0X0puBSbPv4qpLcu6ibjRTL1PzNKpSTXZ4Ul2dg5uhjmomhIYr563vL6YsgNbQGU2JA/640?wx_fmt=png)

CIM 对象库在系统中是预装了管理数据。这些数据主要是描述计算机硬件和软件配置的静态数据，例如操作系统信息、硬盘分区、服务、设备驱动等。

在开机或特定服务启动时，对应的 WMI 提供者会更新 CIM 对象库中的这些数据。例如，当硬盘被重新分区后，对应的 WMI 提供者就会更新 CIM 对象库中的硬盘分区数据。

CIM 对象库在物理存储上位于 Windows 系统的 System32 文件夹下的 wbem 文件夹中。具体路径一般为："C:\Windows\System32\wbem\Repository"。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FVvAFkxoh9BKY26zAGWG0X0puBSbPv4qoA3vygJDabEslgqibGibDo9zp9rhibvdz2yNtMmDM7sNThvqiardh8hUOg/640?wx_fmt=png)

这个库是以一种特殊的格式来存储数据的，普通文本编辑器无法直接阅读或修改。如果你需要访问其中的数据，应该使用 WMI 提供的查询语言 WQL，或者专门的接口和工具，如 Windows 内置的 “WMI 管理器” 或“WMI CIM Studio”。

  

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Op7Y2S0HyKx4Sibx9mxsrz68yfgLOMCxU05FFBGZtaHqGlp9uPhdwKhs0vLnxgibBpLrwfGhQVWpIHdjxlfhDyLg/640?wx_fmt=png)

总结

![](https://mmbiz.qpic.cn/mmbiz_png/yRDp2K3ZBpKOicaBvhSTPZYqTVq8ku50NMtfAqkWhJw2cyMfYEhzIZHlVGLH0Wl2tQ8usSOv6xbZxBiabe1XiaLhA/640?wx_fmt=png)

  

本文我们介绍了 WMI 和 CIM。WMI (Windows Management Instrumentation) 是 Microsoft 提供的一种用于在网络环境中管理 Windows 操作系统的技术。它提供了一种统一和标准化的方式，使得开发人员和系统管理员可以查询和设置操作系统的配置信息，以及其他数据。WMI 的架构主要包括了 WMI 客户端、WMI 服务、WMI 提供者，以及 CIM 对象库。

CIM 对象库（CIM Repository）是 WMI 体系中的一个重要部分，它是一个数据库，存储了描述 Windows 操作系统和计算机硬件的管理数据。这些数据采用了面向对象的数据模型，被组织成类（Class）和实例（Instance）。CIM 对象库的物理存储位置通常是 "C:\Windows\System32\wbem\Repository"。

CIM 对象库预装了许多描述计算机硬件和软件配置的静态数据，需要的时候可以通过 WMI 提供的查询语言 WQL，或者专门的接口和工具进行访问和修改。对于一些实时的或者需要即时获取的数据，如 CPU 使用率，WMI 会在接收到查询请求后，由相应的 WMI 提供者现场获取并返回。