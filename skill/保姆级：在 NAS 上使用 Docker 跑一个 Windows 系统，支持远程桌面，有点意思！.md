<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/gsOqn4V441g_RVtrRtbUqg)

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv37icdS639c6whlzQ0YhLhPAtfBoSQdkSqGFSHxAcxmpxZIzNWGw7wNWw/640?wx_fmt=jpeg&from=appmsg)  
笔者曾介绍过如何在威联通 NAS 中使用 Docker 安装 DSM 系统，使用起来完全没有问题，甚至还能在 DSM 中套娃安装 Docker，相当哇塞！本篇要介绍的这个好玩意来自`天地极限`大佬的推荐，就是在 NAS 中使用 Docker 安装一个 Windows 系统（不需要虚拟机，但使用起来类似），与安装 DSM 有异曲同工之妙，下面笔者详细介绍如何操作。

### 1️⃣ 项目简介

这个项目 Github 上的一款开源项目，支持 Web 访问（QEMU）和远程桌面，支持安装以下系列 Windows 系统：

*   win11 (Windows 11)
    
*   win10 (Windows 10)
    
*   win81 (Windows 8.1)
    
*   win22 (Windows Server 2022)
    
*   win19 (Windows Server 2019)
    
*   win16 (Windows Server 2016)
    

正式开始前温馨提示，请提前做好准备：

*   确保你的机器支持 KVM，可以用下面命令检查是否支持
    

```
sudo apt install cpu-checker
sudo kvm-ok


```

如果`kvm ok`命令报错了，则表示不能使用 kvm，请检查 BIOS 中的虚拟化设置。

*   充足的时间，安装过程不（很）快（慢），你可能需要准备好喝点咖啡或洗个热水澡
    

### 2️⃣ 启动 Docker

下面正式开始！笔者准备了 docker 和 docker-compose 两种安装方式，任选一种即可。

**1、Docker 安装**

```
docker run -it \
-e VERSION="win11" \
-e RAM_SIZE="8G" \
-e CPU_CORES="4" \
-e DISK_SIZE="256G" \
-e MANUAL="N" \
-p 8006:8006 \
-p 3389:3389/tcp \
-p 3389:3389/udp \
-v path/to/windows/storage:/storage \
--device=/dev/kvm \
--cap-add NET_ADMIN \ 
dockurr/windows:latest


```

**2、docker-compose 安装**

```
version: "3.9"
services:
  windows:
    image: dockurr/windows:latest
    container_name: windows
    stop_grace_period: 2m
    restart: unless-stopped
    environment:
      VERSION: "win11"
      RAM_SIZE: "8G"
      CPU_CORES: "4"
      DISK_SIZE: "256G"
      MANUAL: "N"
    devices:
      - /dev/kvm
    cap_add:
      - NET_ADMIN
    ports:
      - 8006:8006
      - 3389:3389/tcp
      - 3389:3389/udp
    volumes:
      - /share/documents/windows/storage:/storage


```

#### 下面简单介绍下如何设置参数：

1.  如何选择 Windows 的版本？  
    默认情况下，将安装 Windows 11。但是，你可以设置`VERSION`环境变量指定要下载的 Windows 版本：
    

```
environment:
  VERSION: "win11"


```

支持设置为以下 Windows 版本：

*   win11
    
*   win10
    
*   win81
    
*   win22
    
*   win19
    
*   win16
    

2.  如何设置 CPU 或 RAM 的数量？  
    默认情况下，会分配 2 个 CPU 核心和 4 GB RAM 给容器，这是 Windows 11 的最低要求。使用下面环境变量可以进行修改：
    

```
environment:
  RAM_SIZE: "8G"
  CPU_CORES: "4"


```

3.  如何更改磁盘的大小？  
    默认会分配 64 GB 的磁盘大小，使用下面环境变量可以进行修改：
    

```
environment:
  DISK_SIZE: "256G"


```

4.  如何更改存储位置？  
    使用下面环境变量可以设置挂载的存储位置，将示例路径`/var/win`替换为你自己机器上的存储文件夹。
    

```
volumes:
  - /var/win:/storage


```

5.  如何执行手动安装？  
    默认是自动安装的，如果你想手动执行安装以自定义某些选项，例如选择另一个版本，请添加以下环境变量：
    

```
environment:
  MANUAL: "Y"


```

`MANUAL: "Y"`表示手工安装，默认是`N`，笔者建议改成`Y`，可以自定义进行个性化设置。

6.  如何自定义 Windows 镜像下载地址？  
    你可以在`VERSION`环境变量中指定 URL，以便下载自定义的 ISO 文件：
    

```
environment:
  VERSION: "https://example.com/win.iso"


```

在安装过程中，需要添加一些驱动程序，下面会详细介绍。

### 3️⃣ 安装 Windows

高能预警，以下都是使用手工安装的过程，如果你选择自动安装则就不需要看了！安装的步骤比较多，特别是关于选择驱动的步骤，跟虚拟机安装过程相似，请务必仔细操作，不要遗漏。

**1、打开 Web 页面**

使用以上介绍的方法启动 Docker 容器，稍等片刻后在浏览器中输入`IP:8006`，打开 QEMU。

如果显示下面这个界面，那就继续等一会，系统正在下载 Windows 镜像和安装 QEME，等待安装完并启动即可。这个过程可能会比较漫长（跟你的网络下载速度有关），建议先喝杯咖啡或去洗个热水澡～～  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv38sGTl9icVxnibUl8Ugx1ficJkxtViaiaMHn1UqOQ6mSvQ91tkjYL6KdphMA/640?wx_fmt=jpeg&from=appmsg)

出现这个界面就可以正式开始了！选择完语言、时间和货币格式、输入法，然后点`下一页`。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv33cKJf5zaCOgjb6ZBKbCic2p4mYibib1yvl2S639dPdzloPpUPF2l0EdZg/640?wx_fmt=jpeg&from=appmsg)

**2、开始安装**

就是点按钮。。然后等待！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3cLcvb1KUqVGkYtkcOqZYVM6dm5icXXU68iblWXHJ1cicXsyf9Zs5RfK1A/640?wx_fmt=jpeg&from=appmsg)![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3oPIAPJOTd0soqk8wCcD1FtEKO1u3VxS1kKYYNRJmVolSgMZMJ0gbvA/640?wx_fmt=jpeg&from=appmsg)

**3、安装 IO 驱动程序**

这一步是需要安装磁盘驱动程序，点击`浏览`。**这一步很重要，可别直接跳过了！**  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3GhB3TASvW1EJYibbWZen1PbEx1zJQhkf8oicxfPsPvtlZIKhicUmbLUUg/640?wx_fmt=jpeg&from=appmsg)  
选择第一个 **CD 驱动器（D 盘）**，并找到`amd64/win11`，选中！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3xm1wpIvkJ5We6LQwh1r5vBuArlHsXDro9cA9ibicjyDEcRpCOUpH4Xgw/640?wx_fmt=jpeg&from=appmsg)

选完就是下面所示的情况，继续点击`下一页`，等待！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3HfriaIrYJliaznXiaqGRHcUZclW6azfykfdSibY3r1zWOn54c4NQMMicoGA/640?wx_fmt=jpeg&from=appmsg)  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3KJuC6KhsBAx6Aib7ibtXLUdqNhl9yESEI2icZ8KMHRtqQ3dia7P62yIQXw/640?wx_fmt=jpeg&from=appmsg)

**4、选择系统版本**

这个界面直接点击`我没有产品密钥`，你如果有密钥你就输入。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3DuLxznibnOYaArichkwNZKVh7YDcjPb3VjEHn6av63UIjdaRhqib1u7OA/640?wx_fmt=jpeg&from=appmsg)  
接下来选择一个系统版本，建议选`Windwos11 专业版`就够用了，当然你想选其他的咱也拦不住你～～，继续点击`下一页`，等待！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3CcwmtGOhU1ngsGhwLDicDVD35R3BHUaBpWribot9LVticL684bbz2Z20g/640?wx_fmt=jpeg&from=appmsg)  
嗯，勾选接收许可条款（不接受也不行啊），继续点击`下一页`，等待！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3RewmBCh57HyQiaicNicfYyJ6Yh0TGDThGob5TsmlX06gaBvaibDILPmVRw/640?wx_fmt=jpeg&from=appmsg)

**5、选择安装类型和网卡驱动**

接下来选择哪种安装类型，选自定义！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3kCdkAkxEribga53YXglJqDdicQBwrelh7eg1DjMPgXKjE3XoWnA6Gnzg/640?wx_fmt=jpeg&from=appmsg)

这个界面要注意了，要加载一下网卡驱动，笔者第一次安装就忽略了，只好重新装了一遍！**这一步很重要，可别直接跳过了！**

点击`加载驱动程序`，在弹出框中选择驱动。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3v7aU97GUkYr1zTNhhcn2QfOnefQp9uxZVfib0p0569WxQTVUW3fep2g/640?wx_fmt=jpeg&from=appmsg)  
依然是选择第一个 **CD 驱动器（D 盘）**，并找到`NetKVM\w11\amd64`，选中！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv31Xvan6q4CMWGuicU3Frpiavut7OAg4DZ5ngjTwU7xibjNkGTOicWKJ4X6g/640?wx_fmt=jpeg&from=appmsg)

选完就是下面所示的情况，继续点击`下一页`，等待！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3ZW2k9fR6hKMtSD9Rxy4TI5VbdN58OdxTUT9WXnWuUCbm7ZyAJDgpMA/640?wx_fmt=jpeg&from=appmsg)  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3vc2GicEDjgU9d2qEbKmJ2L8WhFr9LVNzG6fJwhFkKGSIicZxlpLicgpgQ/640?wx_fmt=jpeg&from=appmsg)  
**6、漫长的等待**

下图所示啥都不用操作，等着就行了。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3euexPw3jSuoGq41uwBJZJMuEVQtIoQrfbA8qiamzTZQibibQ0YnWjTmNg/640?wx_fmt=jpeg&from=appmsg)  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3YciaD6bP0ncq9YvNbrL1a2eArw9VzzDTY7m5SCX7DiaxLaiaiaVwcoDZJw/640?wx_fmt=jpeg&from=appmsg)  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3sBIZzLWRLfjicSAumCg73zVibDonCV36DstxEo6YXtFqoVPQyYyrx1bQ/640?wx_fmt=jpeg&from=appmsg)

**7、个性化设置**

下面到了简简单单的过程了，没啥好特殊说的。

选择系统语言，随你便，自己能认识就行。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3oZDXO2L4bMnTVANtkYTyfxY9xMkrfLkkRZC4kXGBsJXJH84cCWYkIg/640?wx_fmt=jpeg&from=appmsg)  
设置默认键盘布局，随你便，自己会用就行。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv38bdw6tLIamZaHK4CFXTHnmPEibdNRzvl4zx5MEglBH0icLM5H4UstRcw/640?wx_fmt=jpeg&from=appmsg)  
设置第二个键盘布局，随你便，自己不怕麻烦就行。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3dlx5trgNDn7zs2iaANyXj5mW59Z8bjibfuB44mdGE1rG942fsvqlwqVg/640?wx_fmt=jpeg&from=appmsg)  
设置主机名，随你便，自己喜欢就行。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3EMqhWf7eD8F76yibelPicymZLmGSPnicBCCbQ5Q426icCn88zo3FpibSyNQ/640?wx_fmt=jpeg&from=appmsg)

接下来又是一段时间的等待吧，系统会开始自动重启一次。然后会到网络连接界面，直接点击`下一步`。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3FNX7LdegttRWKCwzXSibDlq8Maia9KR3urkURlIhgYD7hDeiaiaibdSzRlw/640?wx_fmt=jpeg&from=appmsg)  
这个就不用多说了，选第一个就行，继续`下一步`。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3oibC57yyKTKtmNpVtrQ22NZoV2tsKyZySEHhNHOeKEs4vvOiabzLWbYw/640?wx_fmt=jpeg&from=appmsg)  
这个界面可以登录你的 Microsoft 网络账号，如果点击登录后提示无法连接网络就多试几次，几次之后依然不行，会跳到创建本地账号界面。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3icGiaianyRlM4crZsHhuu2YqHicsYQ1X5BOOjCLdxdeYT5gBROazq1XvVA/640?wx_fmt=jpeg&from=appmsg)

**8、创建本地账号和隐私设置**

如果一直无法联网，系统会自动转换到使用本地账号登录。这时候会要求你输入用户名，继续点击`下一页`。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3EtdRQz4EaLIAIzSthLg3vDDxKoUh4XxZqiaahUtWrRfGLF1AtibibPZGg/640?wx_fmt=jpeg&from=appmsg)  
输入一个密码，并确认密码，连续点击`下一页`。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3VBHu2iaesGu84L1oG2rRQ6xiaKN9av6Zbic36cfcr4DpG8m9UepbScrUw/640?wx_fmt=jpeg&from=appmsg)![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3DVLS62ibYcykDvYlAzfjFcQv2ypRiaDEJ5miafTSWqflomMC1ziawkrjVg/640?wx_fmt=jpeg&from=appmsg)

创建本地账户需要设置三个安全问题（烦啊！），自己看着办设置就行。连续点击`下一页`。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv35d3LgPBibqswbgOicRDUz2G7jcPGkiazvJpwU7X19qJdBia7P8ocflceNQ/640?wx_fmt=jpeg&from=appmsg)![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3iaib4iaEaXlGUmh3mURdxQR8fKkOian5jQAdPWhsqPKRicicGiatFCUhroDAg/640?wx_fmt=jpeg&from=appmsg)

这个自己看着选，点击`下一页`进行选择，最后点`接受`。然后又是等待系统重启，准备迎接成功的喜悦吧！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3RNGuWErcSp1aGviayibibd3ck6KiaS3OdcZ5W9InRC8FDQzIwDWACVEjwg/640?wx_fmt=jpeg&from=appmsg)  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3sdBkNHhNgMOuJJle07ALHlncARAibF92Pj99u2tWYcJPvY4IhuZic2qQ/640?wx_fmt=jpeg&from=appmsg)

**9、别急，就快好了**

说要等几分钟，那就等呗～～  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3ibia9zicE298JpPrXH75D1Al4icShFV4FnlIibfibn1oMOC2vwmPGwxLezEg/640?wx_fmt=jpeg&from=appmsg)

继续点击`下一步`。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3MB4poCoX3SufibUGjZOWeQvKrnbhjyahqpQKq2RHrESY6fHw6rLaK4Q/640?wx_fmt=jpeg&from=appmsg)

终于进入系统了！  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3euzS0Q1hBXB4AaJhCyial6icicE6Y83sucyHO9Nib6GeMyaACgUdjvO9ng/640?wx_fmt=jpeg&from=appmsg)

**10、别急，还差一步**

凑个十全十美，进入系统后，打开文件管理器中的 E 盘，找到`virtio-win-gt-x64.msi`，双击安装它，一路默认下一步就行。  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv30dobia71YYacUHUnchPHSYka3pugaUvIUxWIs3NMl1HpJyQp80RHLnA/640?wx_fmt=jpeg&from=appmsg)

> 现在，一个跑在 Docker 中的 Windows 已经安装完成啦，剩下的如何使用 Windows 笔者就不啰嗦啦，尽情享受吧！

### 4️⃣ 远程连接 Windows

与正常 Windows 远程桌面没什么区别，如果你是在外网访问家中 NAS 中的 Windows，别忘了到路由器中添加以下`3389`端口的映射哦，否则是连不上的。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3LEGlFIyenmuU7fVQsL1dhqerAmzKm75ZrUZXrjla6iaibNOWib2TrRZgA/640?wx_fmt=jpeg&from=appmsg)

> 原创不易，如果觉得此文对你有帮助，不妨点赞 + 收藏 + 关注，你的鼓励是我持续创作的动力！

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/kTRxeiaUqNEibqbVF5pOyjx1v6d9WLNxv3siaUEvm19RWmpIofk0lGIic0JicPct5Vedr0qr76aaT8kBbaR2Sz5FVYA/640?wx_fmt=gif&from=appmsg)

====== 近期热门 ======

1️⃣[FileBrowser：打造低成本、高性能的个人网盘和网页版文件管理器](http://mp.weixin.qq.com/s?__biz=MzA4MjkzMTcxMg==&mid=2449044734&idx=1&sn=2e7ef935b731eb210365f059c7bb9ced&chksm=8bf3ed91bc84648795bcebe1ef118eaa4307502c721e4268da368d529c6817316ed6eca161fe&scene=21#wechat_redirect)

2️⃣[FileCodeBox: 一款轻量级的 NAS 文件快递柜，文件分享不再难！](http://mp.weixin.qq.com/s?__biz=MzA4MjkzMTcxMg==&mid=2449044733&idx=1&sn=4d618d747b585549b4822862cfd3e865&chksm=8bf3ed92bc84648413c6a8066ac7d39532e57bac84c861e46d2a07d34af8341c47b9fcd311e8&scene=21#wechat_redirect)

3️⃣[普听音乐：一款专为阿里云盘准备的音乐播放器，免费无广告！](http://mp.weixin.qq.com/s?__biz=MzA4MjkzMTcxMg==&mid=2449044688&idx=1&sn=09da5caa8b2eec3508e601c0183fe5fd&chksm=8bf3edbfbc8464a9a50cd47af199355aa9cd2c5d1ce84924f23f545e2e0db73a062fcd783443&scene=21#wechat_redirect)